---
hide:
- toc
---

# 9. Treinamento do Modelo


O treinamento do K-means consiste em agrupar os dados em um nÃºmero prÃ©-definido de clusters, buscando minimizar a distÃ¢ncia entre os pontos e o centro de cada grupo. Como Ã© um mÃ©todo nÃ£o supervisionado, todo o conjunto de dados Ã© utilizado para identificar padrÃµes e formar os agrupamentos.

A escolha do nÃºmero de clusters Ã© uma etapa crÃ­tica e pode ser feita utilizando o mÃ©todo do cotovelo (elbow method), que analisa a variaÃ§Ã£o da soma dos erros quadrÃ¡ticos (inertia) para diferentes valores de k. O ponto onde a reduÃ§Ã£o do erro comeÃ§a a diminuir significativamente indica um bom valor para o nÃºmero de clusters.

=== "CÃ³digo"
    ```python
    # Encontrando o nÃºmero ideal de clusters (Elbow Method)
    wcss = []
    X = df_encoded[features]
    for k in range(1, 11):
        kmeans = KMeans(n_clusters=k, random_state=42, n_init=10)
        kmeans.fit(X)
        wcss.append(kmeans.inertia_)
    plt.figure(figsize=(8, 5))
    plt.plot(range(1, 11), wcss, marker='o')
    plt.xlabel('NÃºmero de clusters (K)')
    plt.ylabel('WCSS')
    plt.title('MÃ©todo do Cotovelo')
    plt.savefig('imagens/elbow_kmeans.png')
    plt.show()

    # Treinando o modelo K-means com o nÃºmero de clusters escolhido (exemplo: 2)
    k = 2
    kmeans = KMeans(n_clusters=k, random_state=42, n_init=10)
    clusters = kmeans.fit_predict(X)
    df_encoded['cluster'] = clusters
    print('Centroides:', kmeans.cluster_centers_)
    ```
=== "Resultado"

    Modelo K-means treinado com sucesso e clusters atribuÃ­dos aos dados.

    > ğŸ¤– O modelo estÃ¡ pronto para anÃ¡lise dos agrupamentos e avaliaÃ§Ã£o por mÃ©tricas de clusterizaÃ§Ã£o.