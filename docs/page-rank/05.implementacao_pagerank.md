---
hide:
- toc
---

# Implementação do Algoritmo PageRank

## Função Manual

O algoritmo PageRank é iterativo e distribui a importância dos nós ao longo das conexões do grafo. A função abaixo inicializa todos os nós com o mesmo valor e atualiza os ranks até a convergência:

=== "Código"
    ```python
    def pagerank_manual(G, d=0.85, max_iter=100, tol=1e-6):
        N = G.number_of_nodes()
        pr = {node: 1/N for node in G.nodes()}
        for i in range(max_iter):
            pr_new = {}
            for node in G.nodes():
                rank = (1 - d) / N
                for nbr in G.predecessors(node):
                    rank += d * pr[nbr] / G.out_degree(nbr) if G.out_degree(nbr) > 0 else 0
                pr_new[node] = rank
            err = sum(abs(pr_new[n] - pr[n]) for n in G.nodes())
            pr = pr_new
            if err < tol:
                print(f'Convergiu em {i+1} iterações')
                break
        return pr
    ```

**Dicas:**
- O parâmetro `d` (amortecimento) controla a probabilidade de "teletransporte" entre nós, evitando que o algoritmo fique preso em ciclos.
- O critério de convergência (`tol`) garante que o algoritmo pare quando as mudanças nos ranks forem pequenas.
- Para grafos grandes, aumente `max_iter` ou ajuste `tol` para garantir precisão.

## Comparação com NetworkX

O NetworkX possui uma implementação otimizada do PageRank, útil para validar a abordagem manual:

=== "Código"
    ```python
    pr_nx = nx.pagerank(G, alpha=0.85)
    ```

Comparar os resultados das duas abordagens é fundamental para garantir a corretude do algoritmo.