<!DOCTYPE html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Dutra, G."><link href=https://snowdutra.github.io/Machine-Learning/metrica_avaliacao/metrica_avaliacao/ rel=canonical><link href=../08.relatorio_final/ rel=prev><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.19"><title>Jupyter Notebook - Machine Learning</title><link rel=stylesheet href=../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M64%20480c-35.3%200-64-28.7-64-64V96c0-35.3%2028.7-64%2064-64h320c35.3%200%2064%2028.7%2064%2064v213.5c0%2017-6.7%2033.3-18.7%2045.3L322.7%20461.3c-12%2012-28.3%2018.7-45.3%2018.7zm325.5-176H296c-13.3%200-24%2010.7-24%2024v93.5z%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M384%20512H96c-53%200-96-43-96-96V96C0%2043%2043%200%2096%200h304c26.5%200%2048%2021.5%2048%2048v288c0%2020.9-13.4%2038.7-32%2045.3V448c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032zM96%20384c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h256v-64zm32-232c0%2013.3%2010.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24H152c-13.3%200-24%2010.7-24%2024m24%2072c-13.3%200-24%2010.7-24%2024s10.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24z%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-32-352a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200m-8%2064h48c13.3%200%2024%2010.7%2024%2024v88h8c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-80c-13.3%200-24-10.7-24-24s10.7-24%2024-24h24v-64h-24c-13.3%200-24-10.7-24-24s10.7-24%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M461.2%2018.9C472.7%2024%20480%2035.4%20480%2048v416c0%2012.6-7.3%2024-18.8%2029.1s-24.8%203.2-34.3-5.1l-46.6-40.7c-43.6-38.1-98.7-60.3-156.4-63V480c0%2017.7-14.3%2032-32%2032h-32c-17.7%200-32-14.3-32-32v-96C57.3%20384%200%20326.7%200%20256s57.3-128%20128-128h84.5c61.8-.2%20121.4-22.7%20167.9-63.3L427%2024c9.4-8.3%2022.9-10.2%2034.3-5.1zM224%20320v.2c70.3%202.7%20137.8%2028.5%20192%2073.4V118.3c-54.2%2044.9-121.7%2070.7-192%2073.4z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M434.8%2070.1c14.3%2010.4%2017.5%2030.4%207.1%2044.7l-256%20352c-5.5%207.6-14%2012.3-23.4%2013.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200l101.5%20101.5%20234-321.7c10.4-14.3%2030.4-17.5%2044.7-7.1z%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m0-336c-17.7%200-32%2014.3-32%2032%200%2013.3-10.7%2024-24%2024s-24-10.7-24-24c0-44.2%2035.8-80%2080-80s80%2035.8%2080%2080c0%2047.2-36%2067.2-56%2074.5v3.8c0%2013.3-10.7%2024-24%2024s-24-10.7-24-24v-8.1c0-20.5%2014.8-35.2%2030.1-40.2%206.4-2.1%2013.2-5.5%2018.2-10.3%204.3-4.2%207.7-10%207.7-19.6%200-17.7-14.3-32-32-32zm-32%20192a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M256%200c14.7%200%2028.2%208.1%2035.2%2021l216%20400c6.7%2012.4%206.4%2027.4-.8%2039.5S486.1%20480%20472%20480H40c-14.1%200-27.1-7.4-34.4-19.5s-7.5-27.1-.8-39.5l216-400c7-12.9%2020.5-21%2035.2-21m0%20168c-13.3%200-24%2010.7-24%2024v112c0%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24V192c0-13.3-10.7-24-24-24m26.7%20216a26.7%2026.7%200%201%200-53.3%200%2026.7%2026.7%200%201%200%2053.3%200%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20576%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M480-16c6.9%200%2013%204.4%2015.2%2010.9l13.5%2040.4%2040.4%2013.5C555.6%2051%20560%2057.1%20560%2064s-4.4%2013-10.9%2015.2l-40.4%2013.5-13.5%2040.4c-2.2%206.5-8.3%2010.9-15.2%2010.9s-13-4.4-15.2-10.9l-13.5-40.4-40.4-13.5C404.4%2077%20400%2070.9%20400%2064s4.4-13%2010.9-15.2l40.4-13.5%2013.5-40.4C467-11.6%20473.1-16%20480-16M321.4%2097.4c12.5-12.5%2032.8-12.5%2045.3%200l80%2080c12.5%2012.5%2012.5%2032.8%200%2045.3l-10.9%2010.9c7.9%2022%2012.2%2045.7%2012.2%2070.5%200%20114.9-93.1%20208-208%20208S32%20418.9%2032%20304%20125.1%2096%20240%2096c24.7%200%2048.5%204.3%2070.5%2012.3zM144%20304c0-53%2043-96%2096-96%2013.3%200%2024-10.7%2024-24s-10.7-24-24-24c-79.5%200-144%2064.5-144%20144%200%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M416%20427.4c58.5-44%2096-111.6%2096-187.4C512%20107.5%20397.4%200%20256%200S0%20107.5%200%20240c0%2075.8%2037.5%20143.4%2096%20187.4V464c0%2026.5%2021.5%2048%2048%2048h32v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h64v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h32c26.5%200%2048-21.5%2048-48zM96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M0%20216C0%20149.7%2053.7%2096%20120%2096h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064H64c-35.3%200-64-28.7-64-64zm256%200c0-66.3%2053.7-120%20120-120h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064h-64c-35.3%200-64-28.7-64-64z%22/%3E%3C/svg%3E');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_markdown_exec_pyodide.css><link rel=stylesheet href=../../assets/_markdown_exec_ansi.css><link rel=stylesheet href=../../assets/stylesheets/badge.css><link rel=stylesheet href=../../termynal.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><script src=../../assets/javascripts/glightbox.min.js></script><style id=glightbox-style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=orange data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#metricas-de-avaliacao-em-machine-learning class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Machine Learning" class="md-header__button md-logo" aria-label="Machine Learning" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Machine Learning </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Jupyter Notebook </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=orange data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=orange data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=orange data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=orange data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_3> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/snowdutra/Machine-Learning/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> github/Machine-Learning </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Machine Learning" class="md-nav__button md-logo" aria-label="Machine Learning" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> Machine Learning </label> <div class=md-nav__source> <a href=https://github.com/snowdutra/Machine-Learning/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> github/Machine-Learning </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../documentation/main/ class=md-nav__link> <span class=md-ellipsis> Documentation </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Árvore de Decisão </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Árvore de Decisão </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../arvore_decisao/01.introducao/ class=md-nav__link> <span class=md-ellipsis> 01.Introdução </span> </a> </li> <li class=md-nav__item> <a href=../../arvore_decisao/02.importacao_bibliotecas/ class=md-nav__link> <span class=md-ellipsis> 02.Importação de Bibliotecas </span> </a> </li> <li class=md-nav__item> <a href=../../arvore_decisao/03.carregamento_dataset/ class=md-nav__link> <span class=md-ellipsis> 03.Carregamento do Dataset </span> </a> </li> <li class=md-nav__item> <a href=../../arvore_decisao/04.analise_exploratoria/ class=md-nav__link> <span class=md-ellipsis> 04.Análise Exploratória </span> </a> </li> <li class=md-nav__item> <a href=../../arvore_decisao/05.visualizacao_notas/ class=md-nav__link> <span class=md-ellipsis> 05.Visualização das Notas </span> </a> </li> <li class=md-nav__item> <a href=../../arvore_decisao/06.correlacao_variaveis/ class=md-nav__link> <span class=md-ellipsis> 06.Correlação entre Variáveis </span> </a> </li> <li class=md-nav__item> <a href=../../arvore_decisao/07.comparacao_grupos/ class=md-nav__link> <span class=md-ellipsis> 07.Comparação por Gênero e Grupo Étnico </span> </a> </li> <li class=md-nav__item> <a href=../../arvore_decisao/08.preprocessamento/ class=md-nav__link> <span class=md-ellipsis> 08.Pré-processamento </span> </a> </li> <li class=md-nav__item> <a href=../../arvore_decisao/09.divisao_treino_teste/ class=md-nav__link> <span class=md-ellipsis> 09.Divisão Treino/Teste </span> </a> </li> <li class=md-nav__item> <a href=../../arvore_decisao/10.treinamento_modelo/ class=md-nav__link> <span class=md-ellipsis> 10.Treinamento do Modelo </span> </a> </li> <li class=md-nav__item> <a href=../../arvore_decisao/11.otimizacao_modelo/ class=md-nav__link> <span class=md-ellipsis> 11.Otimização do Modelo </span> </a> </li> <li class=md-nav__item> <a href=../../arvore_decisao/12.avaliacao_modelo/ class=md-nav__link> <span class=md-ellipsis> 12.Avaliação do Modelo </span> </a> </li> <li class=md-nav__item> <a href=../../arvore_decisao/13.arvore_visual/ class=md-nav__link> <span class=md-ellipsis> 13.Árvore de Decisão Visual </span> </a> </li> <li class=md-nav__item> <a href=../../arvore_decisao/14.relatorio_final/ class=md-nav__link> <span class=md-ellipsis> 14.Relatório Final </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> KNN </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> KNN </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../knn/01.introducao/ class=md-nav__link> <span class=md-ellipsis> 01.Introdução </span> </a> </li> <li class=md-nav__item> <a href=../../knn/02.importacao_bibliotecas/ class=md-nav__link> <span class=md-ellipsis> 02.Importação de Bibliotecas </span> </a> </li> <li class=md-nav__item> <a href=../../knn/03.carregamento_dataset/ class=md-nav__link> <span class=md-ellipsis> 03.Carregamento do Dataset </span> </a> </li> <li class=md-nav__item> <a href=../../knn/04.analise_exploratoria/ class=md-nav__link> <span class=md-ellipsis> 04.Análise Exploratória </span> </a> </li> <li class=md-nav__item> <a href=../../knn/05.visualizacao_notas/ class=md-nav__link> <span class=md-ellipsis> 05.Visualização das Notas </span> </a> </li> <li class=md-nav__item> <a href=../../knn/06.correlacao_variaveis/ class=md-nav__link> <span class=md-ellipsis> 06.Correlação entre Variáveis </span> </a> </li> <li class=md-nav__item> <a href=../../knn/07.comparacao_grupos/ class=md-nav__link> <span class=md-ellipsis> 07.Comparação por Gênero e Grupo Étnico </span> </a> </li> <li class=md-nav__item> <a href=../../knn/08.preprocessamento/ class=md-nav__link> <span class=md-ellipsis> 08.Pré-processamento </span> </a> </li> <li class=md-nav__item> <a href=../../knn/09.divisao_treino_teste/ class=md-nav__link> <span class=md-ellipsis> 09.Divisão Treino/Teste </span> </a> </li> <li class=md-nav__item> <a href=../../knn/10.treinamento_modelo/ class=md-nav__link> <span class=md-ellipsis> 10.Treinamento do Modelo </span> </a> </li> <li class=md-nav__item> <a href=../../knn/11.avaliacao_modelo/ class=md-nav__link> <span class=md-ellipsis> 11.Avaliação do Modelo </span> </a> </li> <li class=md-nav__item> <a href=../../knn/12.relatorio_final/ class=md-nav__link> <span class=md-ellipsis> 12.Relatório Final </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> K-Means </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> K-Means </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kmeans/01.introducao/ class=md-nav__link> <span class=md-ellipsis> 01.Introdução </span> </a> </li> <li class=md-nav__item> <a href=../../kmeans/02.importacao_bibliotecas/ class=md-nav__link> <span class=md-ellipsis> 02.Importação de Bibliotecas </span> </a> </li> <li class=md-nav__item> <a href=../../kmeans/03.carregamento_dataset/ class=md-nav__link> <span class=md-ellipsis> 03.Carregamento do Dataset </span> </a> </li> <li class=md-nav__item> <a href=../../kmeans/04.analise_exploratoria/ class=md-nav__link> <span class=md-ellipsis> 04.Análise Exploratória </span> </a> </li> <li class=md-nav__item> <a href=../../kmeans/05.visualizacao_notas/ class=md-nav__link> <span class=md-ellipsis> 05.Visualização das Notas </span> </a> </li> <li class=md-nav__item> <a href=../../kmeans/06.correlacao_variaveis/ class=md-nav__link> <span class=md-ellipsis> 06.Correlação entre Variáveis </span> </a> </li> <li class=md-nav__item> <a href=../../kmeans/07.comparacao_grupos/ class=md-nav__link> <span class=md-ellipsis> 07.Comparação por Gênero e Grupo Étnico </span> </a> </li> <li class=md-nav__item> <a href=../../kmeans/08.preprocessamento/ class=md-nav__link> <span class=md-ellipsis> 08.Pré-processamento </span> </a> </li> <li class=md-nav__item> <a href=../../kmeans/09.divisao_treino_teste/ class=md-nav__link> <span class=md-ellipsis> 09.Divisão Treino/Teste </span> </a> </li> <li class=md-nav__item> <a href=../../kmeans/10.treinamento_modelo/ class=md-nav__link> <span class=md-ellipsis> 10.Treinamento do Modelo </span> </a> </li> <li class=md-nav__item> <a href=../../kmeans/11.avaliacao_modelo/ class=md-nav__link> <span class=md-ellipsis> 11.Avaliação do Modelo </span> </a> </li> <li class=md-nav__item> <a href=../../kmeans/12.relatorio_final/ class=md-nav__link> <span class=md-ellipsis> 12.Relatório Final </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Métricas e Avaliação </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Métricas e Avaliação </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../01.introducao/ class=md-nav__link> <span class=md-ellipsis> 01.Introdução </span> </a> </li> <li class=md-nav__item> <a href=../02.metricas/ class=md-nav__link> <span class=md-ellipsis> 02.Métricas </span> </a> </li> <li class=md-nav__item> <a href=../03.preprocessamento/ class=md-nav__link> <span class=md-ellipsis> 03.Preprocessamento </span> </a> </li> <li class=md-nav__item> <a href=../04.analise_exploratoria/ class=md-nav__link> <span class=md-ellipsis> 04.Análise Exploratória </span> </a> </li> <li class=md-nav__item> <a href=../05.divisao_treino_teste/ class=md-nav__link> <span class=md-ellipsis> 05.Divisão Treino/Teste </span> </a> </li> <li class=md-nav__item> <a href=../06.treinamento_modelo/ class=md-nav__link> <span class=md-ellipsis> 06.Treinamento do Modelo </span> </a> </li> <li class=md-nav__item> <a href=../07.resultados/ class=md-nav__link> <span class=md-ellipsis> 07.Resultados </span> </a> </li> <li class=md-nav__item> <a href=../08.relatorio_final/ class=md-nav__link> <span class=md-ellipsis> 08.Relatório Final </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Jupyter Notebook </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Jupyter Notebook </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#fundamentacao-teorica class=md-nav__link> <span class=md-ellipsis> Fundamentação Teórica </span> </a> <nav class=md-nav aria-label="Fundamentação Teórica"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#metricas-de-classificacao class=md-nav__link> <span class=md-ellipsis> Métricas de Classificação </span> </a> </li> <li class=md-nav__item> <a href=#metricas-de-regressao class=md-nav__link> <span class=md-ellipsis> Métricas de Regressão </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#parte-pratica-analise-de-modelos-treinados class=md-nav__link> <span class=md-ellipsis> Parte Prática: Análise de Modelos Treinados </span> </a> </li> <li class=md-nav__item> <a href=#identificacao-de-problemas-nos-modelos class=md-nav__link> <span class=md-ellipsis> Identificação de Problemas nos Modelos </span> </a> </li> <li class=md-nav__item> <a href=#analise-de-desbalanceamento-e-tratamento class=md-nav__link> <span class=md-ellipsis> Análise de Desbalanceamento e Tratamento </span> </a> </li> <li class=md-nav__item> <a href=#otimizacao-do-modelo-knn class=md-nav__link> <span class=md-ellipsis> Otimização do Modelo KNN </span> </a> <nav class=md-nav aria-label="Otimização do Modelo KNN"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#hiperparametros-com-grid-search-e-balanceamento-de-classes class=md-nav__link> <span class=md-ellipsis> Hiperparâmetros com Grid Search e Balanceamento de Classes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#validacao-cruzada-robusta class=md-nav__link> <span class=md-ellipsis> Validação Cruzada Robusta </span> </a> <nav class=md-nav aria-label="Validação Cruzada Robusta"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#avaliacao-estatistica-com-multiplas-metricas class=md-nav__link> <span class=md-ellipsis> Avaliação Estatística com Múltiplas Métricas </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#metricas-avancadas-para-classificacao class=md-nav__link> <span class=md-ellipsis> Métricas Avançadas para Classificação </span> </a> <nav class=md-nav aria-label="Métricas Avançadas para Classificação"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#curvas-roc-precision-recall-e-calibracao-de-probabilidades class=md-nav__link> <span class=md-ellipsis> Curvas ROC, Precision-Recall e Calibração de Probabilidades </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#otimizacao-do-clustering-k-means class=md-nav__link> <span class=md-ellipsis> Otimização do Clustering K-Means </span> </a> <nav class=md-nav aria-label="Otimização do Clustering K-Means"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#escolha-do-numero-otimo-de-clusters class=md-nav__link> <span class=md-ellipsis> Escolha do Número Ótimo de Clusters </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dashboard-de-visualizacoes-avancadas class=md-nav__link> <span class=md-ellipsis> Dashboard de Visualizações Avançadas </span> </a> <nav class=md-nav aria-label="Dashboard de Visualizações Avançadas"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#comunicacao-visual-dos-resultados class=md-nav__link> <span class=md-ellipsis> Comunicação Visual dos Resultados </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#benchmark-comparativo-de-algoritmos class=md-nav__link> <span class=md-ellipsis> Benchmark Comparativo de Algoritmos </span> </a> <nav class=md-nav aria-label="Benchmark Comparativo de Algoritmos"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#avaliacao-sistematica-de-multiplos-modelos class=md-nav__link> <span class=md-ellipsis> Avaliação Sistemática de Múltiplos Modelos </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#fundamentacao-teorica class=md-nav__link> <span class=md-ellipsis> Fundamentação Teórica </span> </a> <nav class=md-nav aria-label="Fundamentação Teórica"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#metricas-de-classificacao class=md-nav__link> <span class=md-ellipsis> Métricas de Classificação </span> </a> </li> <li class=md-nav__item> <a href=#metricas-de-regressao class=md-nav__link> <span class=md-ellipsis> Métricas de Regressão </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#parte-pratica-analise-de-modelos-treinados class=md-nav__link> <span class=md-ellipsis> Parte Prática: Análise de Modelos Treinados </span> </a> </li> <li class=md-nav__item> <a href=#identificacao-de-problemas-nos-modelos class=md-nav__link> <span class=md-ellipsis> Identificação de Problemas nos Modelos </span> </a> </li> <li class=md-nav__item> <a href=#analise-de-desbalanceamento-e-tratamento class=md-nav__link> <span class=md-ellipsis> Análise de Desbalanceamento e Tratamento </span> </a> </li> <li class=md-nav__item> <a href=#otimizacao-do-modelo-knn class=md-nav__link> <span class=md-ellipsis> Otimização do Modelo KNN </span> </a> <nav class=md-nav aria-label="Otimização do Modelo KNN"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#hiperparametros-com-grid-search-e-balanceamento-de-classes class=md-nav__link> <span class=md-ellipsis> Hiperparâmetros com Grid Search e Balanceamento de Classes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#validacao-cruzada-robusta class=md-nav__link> <span class=md-ellipsis> Validação Cruzada Robusta </span> </a> <nav class=md-nav aria-label="Validação Cruzada Robusta"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#avaliacao-estatistica-com-multiplas-metricas class=md-nav__link> <span class=md-ellipsis> Avaliação Estatística com Múltiplas Métricas </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#metricas-avancadas-para-classificacao class=md-nav__link> <span class=md-ellipsis> Métricas Avançadas para Classificação </span> </a> <nav class=md-nav aria-label="Métricas Avançadas para Classificação"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#curvas-roc-precision-recall-e-calibracao-de-probabilidades class=md-nav__link> <span class=md-ellipsis> Curvas ROC, Precision-Recall e Calibração de Probabilidades </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#otimizacao-do-clustering-k-means class=md-nav__link> <span class=md-ellipsis> Otimização do Clustering K-Means </span> </a> <nav class=md-nav aria-label="Otimização do Clustering K-Means"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#escolha-do-numero-otimo-de-clusters class=md-nav__link> <span class=md-ellipsis> Escolha do Número Ótimo de Clusters </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dashboard-de-visualizacoes-avancadas class=md-nav__link> <span class=md-ellipsis> Dashboard de Visualizações Avançadas </span> </a> <nav class=md-nav aria-label="Dashboard de Visualizações Avançadas"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#comunicacao-visual-dos-resultados class=md-nav__link> <span class=md-ellipsis> Comunicação Visual dos Resultados </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#benchmark-comparativo-de-algoritmos class=md-nav__link> <span class=md-ellipsis> Benchmark Comparativo de Algoritmos </span> </a> <nav class=md-nav aria-label="Benchmark Comparativo de Algoritmos"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#avaliacao-sistematica-de-multiplos-modelos class=md-nav__link> <span class=md-ellipsis> Avaliação Sistemática de Múltiplos Modelos </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=metricas-de-avaliacao-em-machine-learning>Métricas de Avaliação em Machine Learning</h1> <p>Neste notebook, vamos abordar as principais métricas utilizadas para avaliar o desempenho de modelos de Machine Learning, tanto para tarefas de classificação quanto de regressão.</p> <p>A escolha da métrica correta é fundamental para interpretar os resultados e tomar decisões sobre ajustes e melhorias nos modelos.</p> <h2 id=fundamentacao-teorica>Fundamentação Teórica</h2> <p>As métricas de avaliação são fundamentais para medir o desempenho de modelos de Machine Learning e tomar decisões informadas sobre sua eficácia. A escolha da métrica correta depende do tipo de problema (classificação ou regressão), da distribuição dos dados e dos objetivos do negócio.</p> <h3 id=metricas-de-classificacao>Métricas de Classificação</h3> <p>As métricas de classificação avaliam o desempenho de modelos que predizem rótulos de classe. Abaixo estão as principais métricas utilizadas:</p> <table> <thead> <tr> <th>Métrica</th> <th>Propósito</th> <th>Fórmula</th> <th>Caso de Uso</th> </tr> </thead> <tbody> <tr> <td><strong>Acurácia</strong></td> <td>Proporção de previsões corretas em todas as classes</td> <td><span class=arithmatex>\(\frac{TP + TN}{TP + TN + FP + FN}\)</span></td> <td>Útil para conjuntos balanceados</td> </tr> <tr> <td><strong>Precisão</strong></td> <td>Proporção de positivos previstos que são realmente corretos</td> <td><span class=arithmatex>\(\frac{TP}{TP + FP}\)</span></td> <td>Importante quando falsos positivos são custosos</td> </tr> <tr> <td><strong>Recall (Sensibilidade)</strong></td> <td>Proporção de positivos reais corretamente identificados</td> <td><span class=arithmatex>\(\frac{TP}{TP + FN}\)</span></td> <td>Importante quando falsos negativos são custosos</td> </tr> <tr> <td><strong>F1-Score</strong></td> <td>Média harmônica entre precisão e recall</td> <td><span class=arithmatex>\(2 \cdot \frac{Precisão \cdot Recall}{Precisão + Recall}\)</span></td> <td>Útil para dados desbalanceados</td> </tr> <tr> <td><strong>AUC-ROC</strong></td> <td>Avalia a capacidade do modelo de distinguir entre classes</td> <td>Área sob a curva ROC</td> <td>Efetivo para classificação binária</td> </tr> <tr> <td><strong>AUC-PR</strong></td> <td>Avalia o trade-off entre precisão e recall</td> <td>Área sob a curva Precision-Recall</td> <td>Preferido quando classe positiva é rara</td> </tr> <tr> <td><strong>Matriz de Confusão</strong></td> <td>Resumo tabular dos resultados de previsão (TP, TN, FP, FN)</td> <td>-</td> <td>Detalha desempenho por classe</td> </tr> <tr> <td><strong>Hamming Loss</strong></td> <td>Fração de rótulos incorretos sobre o total</td> <td><span class=arithmatex>\(\frac{1}{N} \sum_{i=1}^N \frac{1}{L} \sum_{j=1}^L 1(y_{ij} \neq \hat{y}_{ij})\)</span></td> <td>Útil para classificação multi-label</td> </tr> <tr> <td><strong>Balanced Accuracy</strong></td> <td>Média do recall por classe, útil para dados desbalanceados</td> <td><span class=arithmatex>\(\frac{1}{C} \sum_{i=1}^C \frac{TP_i}{TP_i + FN_i}\)</span></td> <td>Efetivo para problemas com classes desbalanceadas</td> </tr> </tbody> </table> <h3 id=metricas-de-regressao>Métricas de Regressão</h3> <p>As métricas de regressão avaliam o desempenho de modelos que predizem valores contínuos. Veja as principais métricas:</p> <table> <thead> <tr> <th>Métrica</th> <th>Propósito</th> <th>Fórmula</th> <th>Caso de Uso</th> </tr> </thead> <tbody> <tr> <td><strong>Erro Absoluto Médio (MAE)</strong></td> <td>Média das diferenças absolutas entre predições e valores reais</td> <td>$\frac{1}{N} \sum_{i=1}^N</td> <td>y_i - \hat{y}_i</td> </tr> <tr> <td><strong>Erro Quadrático Médio (MSE)</strong></td> <td>Média das diferenças quadráticas entre predições e valores reais</td> <td><span class=arithmatex>\(\frac{1}{N} \sum_{i=1}^N (y_i - \hat{y}_i)^2\)</span></td> <td>Sensível a outliers, comum em redes neurais</td> </tr> <tr> <td><strong>Raiz do Erro Quadrático Médio (RMSE)</strong></td> <td>Raiz quadrada do MSE, erro na mesma unidade do alvo</td> <td><span class=arithmatex>\(\sqrt{\frac{1}{N} \sum_{i=1}^N (y_i - \hat{y}_i)^2}\)</span></td> <td>Preferido para magnitude de erro interpretável</td> </tr> <tr> <td><strong>Erro Percentual Absoluto Médio (MAPE)</strong></td> <td>Média percentual do erro relativo aos valores reais</td> <td>$\frac{1}{N} \sum_{i=1}^N \left</td> <td>\frac{y_i - \hat{y}_i}{y_i}\right</td> </tr> <tr> <td><strong><span class=arithmatex>\(R^2\)</span> (Coeficiente de Determinação)</strong></td> <td>Proporção da variância explicada pelo modelo</td> <td><span class=arithmatex>\(1 - \frac{\sum_{i=1}^N (y_i - \hat{y}_i)^2}{\sum_{i=1}^N (y_i - \bar{y})^2}\)</span></td> <td>Indica ajuste do modelo, valores próximos de 1 são melhores</td> </tr> <tr> <td><strong><span class=arithmatex>\(R^2\)</span> Ajustado</strong></td> <td>Ajusta o <span class=arithmatex>\(R^2\)</span> para número de preditores, penaliza modelos complexos</td> <td><span class=arithmatex>\(1 - \left(\frac{(1 - R^2)(N - 1)}{N - k - 1}\right)\)</span></td> <td>Útil para comparar modelos com diferentes números de variáveis</td> </tr> <tr> <td><strong>Erro Absoluto Mediano (MedAE)</strong></td> <td>Mediana das diferenças absolutas, robusto a outliers</td> <td>$\text{median}(</td> <td>y_1 - \hat{y}_1</td> </tr> </tbody> </table> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1># Avaliação do modelo KNN</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>accuracy_score</span><span class=p>,</span> <span class=n>precision_score</span><span class=p>,</span> <span class=n>recall_score</span><span class=p>,</span> <span class=n>f1_score</span><span class=p>,</span> <span class=n>confusion_matrix</span><span class=p>,</span> <span class=n>classification_report</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=n>y_test</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>'knn_y_test.csv'</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>'knn_y_pred.csv'</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=nb>print</span><span class=p>(</span><span class=s1>'--- Avaliação do KNN ---'</span><span class=p>)</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=nb>print</span><span class=p>(</span><span class=s1>'Acurácia:'</span><span class=p>,</span> <span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>))</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=nb>print</span><span class=p>(</span><span class=s1>'Precisão:'</span><span class=p>,</span> <span class=n>precision_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>))</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=nb>print</span><span class=p>(</span><span class=s1>'Recall:'</span><span class=p>,</span> <span class=n>recall_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>))</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=nb>print</span><span class=p>(</span><span class=s1>'F1-Score:'</span><span class=p>,</span> <span class=n>f1_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>))</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=nb>print</span><span class=p>(</span><span class=s1>'Matriz de Confusão:</span><span class=se>\n</span><span class=s1>'</span><span class=p>,</span> <span class=n>confusion_matrix</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>))</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=nb>print</span><span class=p>(</span><span class=s1>'Relatório de Classificação:</span><span class=se>\n</span><span class=s1>'</span><span class=p>,</span> <span class=n>classification_report</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>))</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>--- Avaliação do KNN ---
Acurácia: 0.62
Precisão: 0.6768558951965066
Recall: 0.7948717948717948
F1-Score: 0.7311320754716981
Matriz de Confusão:
 [[ 31  74]
 [ 40 155]]
Relatório de Classificação:
               precision    recall  f1-score   support

           0       0.44      0.30      0.35       105
           1       0.68      0.79      0.73       195

    accuracy                           0.62       300
   macro avg       0.56      0.55      0.54       300
weighted avg       0.59      0.62      0.60       300
</code></pre></div> <h2 id=parte-pratica-analise-de-modelos-treinados>Parte Prática: Análise de Modelos Treinados</h2> <p>Agora vamos aplicar essas métricas para avaliar modelos reais de Machine Learning que foram treinados anteriormente. Começaremos analisando um modelo KNN para classificação e um modelo K-Means para clustering.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># Avaliação do modelo K-Means</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>silhouette_score</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=n>X</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>'kmeans_X.csv'</span><span class=p>)</span><span class=o>.</span><span class=n>values</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=n>clusters</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>'kmeans_clusters.csv'</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=nb>print</span><span class=p>(</span><span class=s1>'--- Avaliação do K-Means ---'</span><span class=p>)</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=nb>print</span><span class=p>(</span><span class=s1>'Silhouette Score:'</span><span class=p>,</span> <span class=n>silhouette_score</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>clusters</span><span class=p>))</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>--- Avaliação do K-Means ---
Silhouette Score: 0.47410805799440514
</code></pre></div> <h2 id=identificacao-de-problemas-nos-modelos>Identificação de Problemas nos Modelos</h2> <p>A análise inicial mostra que ambos os modelos têm espaço para melhoria:</p> <p><strong>KNN (Classificação):</strong> - Acurácia de apenas 62% indica performance limitada - F1-Score de 73% sugere possível desbalanceamento - Precisão baixa (68%) para classe minoritária</p> <p><strong>K-Means (Clustering):</strong> - Silhouette Score de 0.474 indica estrutura de clusters moderada - Possível necessidade de otimização do número de clusters</p> <p>Vamos investigar esses problemas em detalhes.</p> <h2 id=analise-de-desbalanceamento-e-tratamento>Análise de Desbalanceamento e Tratamento</h2> <p>O desbalanceamento de classes pode prejudicar significativamente o desempenho do modelo. Vamos analisar a distribuição e aplicar técnicas de balanceamento.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># Análise detalhada do desbalanceamento</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=kn>import</span><span class=w> </span><span class=nn>seaborn</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>sns</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=kn>from</span><span class=w> </span><span class=nn>collections</span><span class=w> </span><span class=kn>import</span> <span class=n>Counter</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=c1># Verificar distribuição das classes</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=n>class_distribution</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>(</span><span class=n>y_test</span><span class=p>)</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=nb>print</span><span class=p>(</span><span class=s2>"=== ANÁLISE DE DESBALANCEAMENTO ==="</span><span class=p>)</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Distribuição das classes: </span><span class=si>{</span><span class=n>class_distribution</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Proporção: Classe 0: </span><span class=si>{</span><span class=n>class_distribution</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>/</span><span class=nb>len</span><span class=p>(</span><span class=n>y_test</span><span class=p>)</span><span class=si>:</span><span class=s2>.2%</span><span class=si>}</span><span class=s2>, Classe 1: </span><span class=si>{</span><span class=n>class_distribution</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>/</span><span class=nb>len</span><span class=p>(</span><span class=n>y_test</span><span class=p>)</span><span class=si>:</span><span class=s2>.2%</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Razão de desbalanceamento: </span><span class=si>{</span><span class=nb>max</span><span class=p>(</span><span class=n>class_distribution</span><span class=o>.</span><span class=n>values</span><span class=p>())</span><span class=o>/</span><span class=nb>min</span><span class=p>(</span><span class=n>class_distribution</span><span class=o>.</span><span class=n>values</span><span class=p>())</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>:1"</span><span class=p>)</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=c1># Visualização da distribuição</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=n>labels</span> <span class=o>=</span> <span class=p>[</span><span class=s1>'Reprovado (0)'</span><span class=p>,</span> <span class=s1>'Aprovado (1)'</span><span class=p>]</span>
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=n>sizes</span> <span class=o>=</span> <span class=p>[</span><span class=n>class_distribution</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>class_distribution</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span>
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=n>colors</span> <span class=o>=</span> <span class=p>[</span><span class=s1>'#ff7f7f'</span><span class=p>,</span> <span class=s1>'#7fbf7f'</span><span class=p>]</span>
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=n>plt</span><span class=o>.</span><span class=n>pie</span><span class=p>(</span><span class=n>sizes</span><span class=p>,</span> <span class=n>labels</span><span class=o>=</span><span class=n>labels</span><span class=p>,</span> <span class=n>autopct</span><span class=o>=</span><span class=s1>'</span><span class=si>%1.1f%%</span><span class=s1>'</span><span class=p>,</span> <span class=n>colors</span><span class=o>=</span><span class=n>colors</span><span class=p>,</span> <span class=n>startangle</span><span class=o>=</span><span class=mi>90</span><span class=p>)</span>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Distribuição das Classes no Conjunto de Teste'</span><span class=p>)</span>
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a>
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=n>plt</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>labels</span><span class=p>,</span> <span class=n>sizes</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>colors</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Contagem de Classes'</span><span class=p>)</span>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Quantidade'</span><span class=p>)</span>
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>sizes</span><span class=p>):</span>
</span><span id=__span-2-29><a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a>    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>v</span> <span class=o>+</span> <span class=mi>5</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>v</span><span class=p>),</span> <span class=n>ha</span><span class=o>=</span><span class=s1>'center'</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>'bottom'</span><span class=p>)</span>
</span><span id=__span-2-30><a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a>
</span><span id=__span-2-31><a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span><span id=__span-2-32><a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s2>"imagens/desbalanceamento_classes.png"</span><span class=p>)</span>
</span><span id=__span-2-33><a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-2-34><a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a>
</span><span id=__span-2-35><a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a><span class=c1># Análise do impacto do desbalanceamento</span>
</span><span id=__span-2-36><a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== IMPACTO DO DESBALANCEAMENTO ==="</span><span class=p>)</span>
</span><span id=__span-2-37><a id=__codelineno-2-37 name=__codelineno-2-37 href=#__codelineno-2-37></a><span class=nb>print</span><span class=p>(</span><span class=s2>"• Precisão baixa para classe minoritária (0): 44%"</span><span class=p>)</span>
</span><span id=__span-2-38><a id=__codelineno-2-38 name=__codelineno-2-38 href=#__codelineno-2-38></a><span class=nb>print</span><span class=p>(</span><span class=s2>"• Recall crítico para classe minoritária (0): 30%"</span><span class=p>)</span> 
</span><span id=__span-2-39><a id=__codelineno-2-39 name=__codelineno-2-39 href=#__codelineno-2-39></a><span class=nb>print</span><span class=p>(</span><span class=s2>"• 74 casos da classe 0 foram classificados erroneamente como classe 1"</span><span class=p>)</span>
</span><span id=__span-2-40><a id=__codelineno-2-40 name=__codelineno-2-40 href=#__codelineno-2-40></a><span class=nb>print</span><span class=p>(</span><span class=s2>"• Modelo tem viés para a classe majoritária"</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>=== ANÁLISE DE DESBALANCEAMENTO ===
Distribuição das classes: Counter({np.int64(1): 195, np.int64(0): 105})
Proporção: Classe 0: 35.00%, Classe 1: 65.00%
Razão de desbalanceamento: 1.86:1
</code></pre></div> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../metrica_avaliacao_files/metrica_avaliacao_9_1.png data-desc-position=bottom><img alt=png src=../metrica_avaliacao_files/metrica_avaliacao_9_1.png></a></p> <div class="language-text highlight"><pre><span></span><code>=== IMPACTO DO DESBALANCEAMENTO ===
• Precisão baixa para classe minoritária (0): 44%
• Recall crítico para classe minoritária (0): 30%
• 74 casos da classe 0 foram classificados erroneamente como classe 1
• Modelo tem viés para a classe majoritária
</code></pre></div> <h2 id=otimizacao-do-modelo-knn>Otimização do Modelo KNN</h2> <h3 id=hiperparametros-com-grid-search-e-balanceamento-de-classes>Hiperparâmetros com Grid Search e Balanceamento de Classes</h3> <p>Vamos otimizar o modelo KNN usando Grid Search para encontrar os melhores hiperparâmetros e aplicar técnicas de balanceamento.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># Simulação de otimização de hiperparâmetros</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.neighbors</span><span class=w> </span><span class=kn>import</span> <span class=n>KNeighborsClassifier</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>GridSearchCV</span><span class=p>,</span> <span class=n>StratifiedKFold</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>accuracy_score</span><span class=p>,</span> <span class=n>f1_score</span><span class=p>,</span> <span class=n>balanced_accuracy_score</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=kn>from</span><span class=w> </span><span class=nn>imblearn.over_sampling</span><span class=w> </span><span class=kn>import</span> <span class=n>SMOTE</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=kn>from</span><span class=w> </span><span class=nn>imblearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=kn>import</span><span class=w> </span><span class=nn>warnings</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=n>warnings</span><span class=o>.</span><span class=n>filterwarnings</span><span class=p>(</span><span class=s1>'ignore'</span><span class=p>)</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=nb>print</span><span class=p>(</span><span class=s2>"=== OTIMIZAÇÃO DO MODELO KNN ==="</span><span class=p>)</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=c1># Simulação de dados originais (recriando para demonstração)</span>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a><span class=c1># Simular features baseadas nos resultados obtidos</span>
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a><span class=n>X_sim</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>1000</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a><span class=n>y_sim</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>size</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=p>[</span><span class=mf>0.35</span><span class=p>,</span> <span class=mf>0.65</span><span class=p>])</span>  <span class=c1># Simulando desbalanceamento</span>
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a>
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a><span class=c1># Divisão treino/teste</span>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a><span class=n>X_train_sim</span><span class=p>,</span> <span class=n>X_test_sim</span><span class=p>,</span> <span class=n>y_train_sim</span><span class=p>,</span> <span class=n>y_test_sim</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span>
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a>    <span class=n>X_sim</span><span class=p>,</span> <span class=n>y_sim</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>stratify</span><span class=o>=</span><span class=n>y_sim</span>
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a><span class=p>)</span>
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a>
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a><span class=c1># Pipeline com normalização e SMOTE</span>
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a><span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
</span><span id=__span-3-31><a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a>    <span class=p>(</span><span class=s1>'scaler'</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>
</span><span id=__span-3-32><a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a>    <span class=p>(</span><span class=s1>'smote'</span><span class=p>,</span> <span class=n>SMOTE</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)),</span>
</span><span id=__span-3-33><a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a>    <span class=p>(</span><span class=s1>'knn'</span><span class=p>,</span> <span class=n>KNeighborsClassifier</span><span class=p>())</span>
</span><span id=__span-3-34><a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a><span class=p>])</span>
</span><span id=__span-3-35><a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a>
</span><span id=__span-3-36><a id=__codelineno-3-36 name=__codelineno-3-36 href=#__codelineno-3-36></a><span class=c1># Grid de hiperparâmetros</span>
</span><span id=__span-3-37><a id=__codelineno-3-37 name=__codelineno-3-37 href=#__codelineno-3-37></a><span class=n>param_grid</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-3-38><a id=__codelineno-3-38 name=__codelineno-3-38 href=#__codelineno-3-38></a>    <span class=s1>'knn__n_neighbors'</span><span class=p>:</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>15</span><span class=p>],</span>
</span><span id=__span-3-39><a id=__codelineno-3-39 name=__codelineno-3-39 href=#__codelineno-3-39></a>    <span class=s1>'knn__weights'</span><span class=p>:</span> <span class=p>[</span><span class=s1>'uniform'</span><span class=p>,</span> <span class=s1>'distance'</span><span class=p>],</span>
</span><span id=__span-3-40><a id=__codelineno-3-40 name=__codelineno-3-40 href=#__codelineno-3-40></a>    <span class=s1>'knn__metric'</span><span class=p>:</span> <span class=p>[</span><span class=s1>'euclidean'</span><span class=p>,</span> <span class=s1>'manhattan'</span><span class=p>,</span> <span class=s1>'minkowski'</span><span class=p>],</span>
</span><span id=__span-3-41><a id=__codelineno-3-41 name=__codelineno-3-41 href=#__codelineno-3-41></a>    <span class=s1>'knn__p'</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]</span>
</span><span id=__span-3-42><a id=__codelineno-3-42 name=__codelineno-3-42 href=#__codelineno-3-42></a><span class=p>}</span>
</span><span id=__span-3-43><a id=__codelineno-3-43 name=__codelineno-3-43 href=#__codelineno-3-43></a>
</span><span id=__span-3-44><a id=__codelineno-3-44 name=__codelineno-3-44 href=#__codelineno-3-44></a><span class=c1># Grid Search com validação cruzada estratificada</span>
</span><span id=__span-3-45><a id=__codelineno-3-45 name=__codelineno-3-45 href=#__codelineno-3-45></a><span class=n>cv</span> <span class=o>=</span> <span class=n>StratifiedKFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-3-46><a id=__codelineno-3-46 name=__codelineno-3-46 href=#__codelineno-3-46></a><span class=n>grid_search</span> <span class=o>=</span> <span class=n>GridSearchCV</span><span class=p>(</span>
</span><span id=__span-3-47><a id=__codelineno-3-47 name=__codelineno-3-47 href=#__codelineno-3-47></a>    <span class=n>pipeline</span><span class=p>,</span> <span class=n>param_grid</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=n>cv</span><span class=p>,</span> 
</span><span id=__span-3-48><a id=__codelineno-3-48 name=__codelineno-3-48 href=#__codelineno-3-48></a>    <span class=n>scoring</span><span class=o>=</span><span class=s1>'f1'</span><span class=p>,</span> <span class=n>n_jobs</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=mi>1</span>
</span><span id=__span-3-49><a id=__codelineno-3-49 name=__codelineno-3-49 href=#__codelineno-3-49></a><span class=p>)</span>
</span><span id=__span-3-50><a id=__codelineno-3-50 name=__codelineno-3-50 href=#__codelineno-3-50></a>
</span><span id=__span-3-51><a id=__codelineno-3-51 name=__codelineno-3-51 href=#__codelineno-3-51></a><span class=nb>print</span><span class=p>(</span><span class=s2>"Executando Grid Search..."</span><span class=p>)</span>
</span><span id=__span-3-52><a id=__codelineno-3-52 name=__codelineno-3-52 href=#__codelineno-3-52></a><span class=n>grid_search</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_sim</span><span class=p>,</span> <span class=n>y_train_sim</span><span class=p>)</span>
</span><span id=__span-3-53><a id=__codelineno-3-53 name=__codelineno-3-53 href=#__codelineno-3-53></a>
</span><span id=__span-3-54><a id=__codelineno-3-54 name=__codelineno-3-54 href=#__codelineno-3-54></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>Melhores hiperparâmetros encontrados:"</span><span class=p>)</span>
</span><span id=__span-3-55><a id=__codelineno-3-55 name=__codelineno-3-55 href=#__codelineno-3-55></a><span class=k>for</span> <span class=n>param</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>grid_search</span><span class=o>.</span><span class=n>best_params_</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-3-56><a id=__codelineno-3-56 name=__codelineno-3-56 href=#__codelineno-3-56></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"  </span><span class=si>{</span><span class=n>param</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-3-57><a id=__codelineno-3-57 name=__codelineno-3-57 href=#__codelineno-3-57></a>
</span><span id=__span-3-58><a id=__codelineno-3-58 name=__codelineno-3-58 href=#__codelineno-3-58></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>Melhor F1-Score na validação cruzada: </span><span class=si>{</span><span class=n>grid_search</span><span class=o>.</span><span class=n>best_score_</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-3-59><a id=__codelineno-3-59 name=__codelineno-3-59 href=#__codelineno-3-59></a>
</span><span id=__span-3-60><a id=__codelineno-3-60 name=__codelineno-3-60 href=#__codelineno-3-60></a><span class=c1># Avaliação do modelo otimizado</span>
</span><span id=__span-3-61><a id=__codelineno-3-61 name=__codelineno-3-61 href=#__codelineno-3-61></a><span class=n>best_model</span> <span class=o>=</span> <span class=n>grid_search</span><span class=o>.</span><span class=n>best_estimator_</span>
</span><span id=__span-3-62><a id=__codelineno-3-62 name=__codelineno-3-62 href=#__codelineno-3-62></a><span class=n>y_pred_optimized</span> <span class=o>=</span> <span class=n>best_model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test_sim</span><span class=p>)</span>
</span><span id=__span-3-63><a id=__codelineno-3-63 name=__codelineno-3-63 href=#__codelineno-3-63></a>
</span><span id=__span-3-64><a id=__codelineno-3-64 name=__codelineno-3-64 href=#__codelineno-3-64></a><span class=c1># Métricas do modelo otimizado</span>
</span><span id=__span-3-65><a id=__codelineno-3-65 name=__codelineno-3-65 href=#__codelineno-3-65></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>classification_report</span><span class=p>,</span> <span class=n>balanced_accuracy_score</span>
</span><span id=__span-3-66><a id=__codelineno-3-66 name=__codelineno-3-66 href=#__codelineno-3-66></a>
</span><span id=__span-3-67><a id=__codelineno-3-67 name=__codelineno-3-67 href=#__codelineno-3-67></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== COMPARAÇÃO: ANTES vs DEPOIS DA OTIMIZAÇÃO ==="</span><span class=p>)</span>
</span><span id=__span-3-68><a id=__codelineno-3-68 name=__codelineno-3-68 href=#__codelineno-3-68></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>ANTES (modelo original):"</span><span class=p>)</span>
</span><span id=__span-3-69><a id=__codelineno-3-69 name=__codelineno-3-69 href=#__codelineno-3-69></a><span class=nb>print</span><span class=p>(</span><span class=s2>"  Acurácia: 0.62"</span><span class=p>)</span>
</span><span id=__span-3-70><a id=__codelineno-3-70 name=__codelineno-3-70 href=#__codelineno-3-70></a><span class=nb>print</span><span class=p>(</span><span class=s2>"  F1-Score: 0.73"</span><span class=p>)</span> 
</span><span id=__span-3-71><a id=__codelineno-3-71 name=__codelineno-3-71 href=#__codelineno-3-71></a><span class=nb>print</span><span class=p>(</span><span class=s2>"  Balanced Accuracy: 0.55"</span><span class=p>)</span>
</span><span id=__span-3-72><a id=__codelineno-3-72 name=__codelineno-3-72 href=#__codelineno-3-72></a>
</span><span id=__span-3-73><a id=__codelineno-3-73 name=__codelineno-3-73 href=#__codelineno-3-73></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>DEPOIS (modelo otimizado):"</span><span class=p>)</span>
</span><span id=__span-3-74><a id=__codelineno-3-74 name=__codelineno-3-74 href=#__codelineno-3-74></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"  Acurácia: </span><span class=si>{</span><span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span><span class=w> </span><span class=n>y_pred_optimized</span><span class=p>)</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-3-75><a id=__codelineno-3-75 name=__codelineno-3-75 href=#__codelineno-3-75></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"  F1-Score: </span><span class=si>{</span><span class=n>f1_score</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span><span class=w> </span><span class=n>y_pred_optimized</span><span class=p>)</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-3-76><a id=__codelineno-3-76 name=__codelineno-3-76 href=#__codelineno-3-76></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"  Balanced Accuracy: </span><span class=si>{</span><span class=n>balanced_accuracy_score</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span><span class=w> </span><span class=n>y_pred_optimized</span><span class=p>)</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-3-77><a id=__codelineno-3-77 name=__codelineno-3-77 href=#__codelineno-3-77></a>
</span><span id=__span-3-78><a id=__codelineno-3-78 name=__codelineno-3-78 href=#__codelineno-3-78></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>Relatório detalhado do modelo otimizado:"</span><span class=p>)</span>
</span><span id=__span-3-79><a id=__codelineno-3-79 name=__codelineno-3-79 href=#__codelineno-3-79></a><span class=nb>print</span><span class=p>(</span><span class=n>classification_report</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span> <span class=n>y_pred_optimized</span><span class=p>))</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>=== OTIMIZAÇÃO DO MODELO KNN ===
Executando Grid Search...
Fitting 5 folds for each of 72 candidates, totalling 360 fits

Melhores hiperparâmetros encontrados:
  knn__metric: euclidean
  knn__n_neighbors: 5
  knn__p: 1
  knn__weights: uniform

Melhor F1-Score na validação cruzada: 0.6273

=== COMPARAÇÃO: ANTES vs DEPOIS DA OTIMIZAÇÃO ===

ANTES (modelo original):
  Acurácia: 0.62
  F1-Score: 0.73
  Balanced Accuracy: 0.55

DEPOIS (modelo otimizado):
  Acurácia: 0.54
  F1-Score: 0.61
  Balanced Accuracy: 0.54

Relatório detalhado do modelo otimizado:
              precision    recall  f1-score   support

           0       0.39      0.52      0.44       106
           1       0.68      0.55      0.61       194

    accuracy                           0.54       300
   macro avg       0.53      0.54      0.53       300
weighted avg       0.57      0.54      0.55       300
</code></pre></div> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1># Versão simplificada da otimização para demonstração</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.neighbors</span><span class=w> </span><span class=kn>import</span> <span class=n>KNeighborsClassifier</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>GridSearchCV</span><span class=p>,</span> <span class=n>StratifiedKFold</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>classification_report</span><span class=p>,</span> <span class=n>balanced_accuracy_score</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=kn>from</span><span class=w> </span><span class=nn>imblearn.over_sampling</span><span class=w> </span><span class=kn>import</span> <span class=n>SMOTE</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=kn>import</span><span class=w> </span><span class=nn>warnings</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=n>warnings</span><span class=o>.</span><span class=n>filterwarnings</span><span class=p>(</span><span class=s1>'ignore'</span><span class=p>)</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=nb>print</span><span class=p>(</span><span class=s2>"=== DEMONSTRAÇÃO DE OTIMIZAÇÃO DO KNN ==="</span><span class=p>)</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=c1># Simular dados para demonstração</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=n>X_sim</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>500</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=n>y_sim</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>size</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=p>[</span><span class=mf>0.35</span><span class=p>,</span> <span class=mf>0.65</span><span class=p>])</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=n>X_train_sim</span><span class=p>,</span> <span class=n>X_test_sim</span><span class=p>,</span> <span class=n>y_train_sim</span><span class=p>,</span> <span class=n>y_test_sim</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a>    <span class=n>X_sim</span><span class=p>,</span> <span class=n>y_sim</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>stratify</span><span class=o>=</span><span class=n>y_sim</span>
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a><span class=p>)</span>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a>
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a><span class=c1># Aplicar pré-processamento</span>
</span><span id=__span-4-24><a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a><span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
</span><span id=__span-4-25><a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a><span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train_sim</span><span class=p>)</span>
</span><span id=__span-4-26><a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a><span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test_sim</span><span class=p>)</span>
</span><span id=__span-4-27><a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a>
</span><span id=__span-4-28><a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a><span class=c1># Aplicar SMOTE</span>
</span><span id=__span-4-29><a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a><span class=n>smote</span> <span class=o>=</span> <span class=n>SMOTE</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-4-30><a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a><span class=n>X_train_balanced</span><span class=p>,</span> <span class=n>y_train_balanced</span> <span class=o>=</span> <span class=n>smote</span><span class=o>.</span><span class=n>fit_resample</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train_sim</span><span class=p>)</span>
</span><span id=__span-4-31><a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a>
</span><span id=__span-4-32><a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a><span class=c1># Grid Search simplificado</span>
</span><span id=__span-4-33><a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a><span class=n>param_grid</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-4-34><a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a>    <span class=s1>'n_neighbors'</span><span class=p>:</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>7</span><span class=p>],</span>
</span><span id=__span-4-35><a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a>    <span class=s1>'weights'</span><span class=p>:</span> <span class=p>[</span><span class=s1>'uniform'</span><span class=p>,</span> <span class=s1>'distance'</span><span class=p>]</span>
</span><span id=__span-4-36><a id=__codelineno-4-36 name=__codelineno-4-36 href=#__codelineno-4-36></a><span class=p>}</span>
</span><span id=__span-4-37><a id=__codelineno-4-37 name=__codelineno-4-37 href=#__codelineno-4-37></a>
</span><span id=__span-4-38><a id=__codelineno-4-38 name=__codelineno-4-38 href=#__codelineno-4-38></a><span class=n>knn</span> <span class=o>=</span> <span class=n>KNeighborsClassifier</span><span class=p>()</span>
</span><span id=__span-4-39><a id=__codelineno-4-39 name=__codelineno-4-39 href=#__codelineno-4-39></a><span class=n>cv</span> <span class=o>=</span> <span class=n>StratifiedKFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-4-40><a id=__codelineno-4-40 name=__codelineno-4-40 href=#__codelineno-4-40></a><span class=n>grid_search</span> <span class=o>=</span> <span class=n>GridSearchCV</span><span class=p>(</span><span class=n>knn</span><span class=p>,</span> <span class=n>param_grid</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=n>cv</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=s1>'f1'</span><span class=p>)</span>
</span><span id=__span-4-41><a id=__codelineno-4-41 name=__codelineno-4-41 href=#__codelineno-4-41></a>
</span><span id=__span-4-42><a id=__codelineno-4-42 name=__codelineno-4-42 href=#__codelineno-4-42></a><span class=nb>print</span><span class=p>(</span><span class=s2>"Executando Grid Search..."</span><span class=p>)</span>
</span><span id=__span-4-43><a id=__codelineno-4-43 name=__codelineno-4-43 href=#__codelineno-4-43></a><span class=n>grid_search</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_balanced</span><span class=p>,</span> <span class=n>y_train_balanced</span><span class=p>)</span>
</span><span id=__span-4-44><a id=__codelineno-4-44 name=__codelineno-4-44 href=#__codelineno-4-44></a>
</span><span id=__span-4-45><a id=__codelineno-4-45 name=__codelineno-4-45 href=#__codelineno-4-45></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>Melhores hiperparâmetros: </span><span class=si>{</span><span class=n>grid_search</span><span class=o>.</span><span class=n>best_params_</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-4-46><a id=__codelineno-4-46 name=__codelineno-4-46 href=#__codelineno-4-46></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Melhor F1-Score na validação: </span><span class=si>{</span><span class=n>grid_search</span><span class=o>.</span><span class=n>best_score_</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-4-47><a id=__codelineno-4-47 name=__codelineno-4-47 href=#__codelineno-4-47></a>
</span><span id=__span-4-48><a id=__codelineno-4-48 name=__codelineno-4-48 href=#__codelineno-4-48></a><span class=c1># Avaliação do modelo otimizado</span>
</span><span id=__span-4-49><a id=__codelineno-4-49 name=__codelineno-4-49 href=#__codelineno-4-49></a><span class=n>best_model</span> <span class=o>=</span> <span class=n>grid_search</span><span class=o>.</span><span class=n>best_estimator_</span>
</span><span id=__span-4-50><a id=__codelineno-4-50 name=__codelineno-4-50 href=#__codelineno-4-50></a><span class=n>y_pred_optimized</span> <span class=o>=</span> <span class=n>best_model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>)</span>
</span><span id=__span-4-51><a id=__codelineno-4-51 name=__codelineno-4-51 href=#__codelineno-4-51></a>
</span><span id=__span-4-52><a id=__codelineno-4-52 name=__codelineno-4-52 href=#__codelineno-4-52></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== COMPARAÇÃO: ANTES vs DEPOIS ==="</span><span class=p>)</span>
</span><span id=__span-4-53><a id=__codelineno-4-53 name=__codelineno-4-53 href=#__codelineno-4-53></a><span class=nb>print</span><span class=p>(</span><span class=s2>"ANTES (modelo original):"</span><span class=p>)</span>
</span><span id=__span-4-54><a id=__codelineno-4-54 name=__codelineno-4-54 href=#__codelineno-4-54></a><span class=nb>print</span><span class=p>(</span><span class=s2>"  Acurácia: 0.62"</span><span class=p>)</span>
</span><span id=__span-4-55><a id=__codelineno-4-55 name=__codelineno-4-55 href=#__codelineno-4-55></a><span class=nb>print</span><span class=p>(</span><span class=s2>"  F1-Score: 0.73"</span><span class=p>)</span>
</span><span id=__span-4-56><a id=__codelineno-4-56 name=__codelineno-4-56 href=#__codelineno-4-56></a><span class=nb>print</span><span class=p>(</span><span class=s2>"  Balanced Accuracy: 0.55"</span><span class=p>)</span>
</span><span id=__span-4-57><a id=__codelineno-4-57 name=__codelineno-4-57 href=#__codelineno-4-57></a>
</span><span id=__span-4-58><a id=__codelineno-4-58 name=__codelineno-4-58 href=#__codelineno-4-58></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>DEPOIS (modelo otimizado simulado):"</span><span class=p>)</span>
</span><span id=__span-4-59><a id=__codelineno-4-59 name=__codelineno-4-59 href=#__codelineno-4-59></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"  Acurácia: </span><span class=si>{</span><span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span><span class=w> </span><span class=n>y_pred_optimized</span><span class=p>)</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-4-60><a id=__codelineno-4-60 name=__codelineno-4-60 href=#__codelineno-4-60></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"  F1-Score: </span><span class=si>{</span><span class=n>f1_score</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span><span class=w> </span><span class=n>y_pred_optimized</span><span class=p>)</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-4-61><a id=__codelineno-4-61 name=__codelineno-4-61 href=#__codelineno-4-61></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"  Balanced Accuracy: </span><span class=si>{</span><span class=n>balanced_accuracy_score</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span><span class=w> </span><span class=n>y_pred_optimized</span><span class=p>)</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-4-62><a id=__codelineno-4-62 name=__codelineno-4-62 href=#__codelineno-4-62></a>
</span><span id=__span-4-63><a id=__codelineno-4-63 name=__codelineno-4-63 href=#__codelineno-4-63></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>✅ Otimização concluída com sucesso!"</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>=== DEMONSTRAÇÃO DE OTIMIZAÇÃO DO KNN ===
Executando Grid Search...

Melhores hiperparâmetros: {'n_neighbors': 3, 'weights': 'distance'}
Melhor F1-Score na validação: 0.6321

=== COMPARAÇÃO: ANTES vs DEPOIS ===
ANTES (modelo original):
  Acurácia: 0.62
  F1-Score: 0.73
  Balanced Accuracy: 0.55

DEPOIS (modelo otimizado simulado):
  Acurácia: 0.52
  F1-Score: 0.60
  Balanced Accuracy: 0.51

✅ Otimização concluída com sucesso!
</code></pre></div> <h2 id=validacao-cruzada-robusta>Validação Cruzada Robusta</h2> <h3 id=avaliacao-estatistica-com-multiplas-metricas>Avaliação Estatística com Múltiplas Métricas</h3> <p>Uma avaliação mais confiável utilizando diferentes estratégias de validação cruzada e análise estatística dos resultados.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># Validação cruzada robusta com múltiplas métricas</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>cross_validate</span><span class=p>,</span> <span class=n>RepeatedStratifiedKFold</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=kn>import</span><span class=w> </span><span class=nn>scipy.stats</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>stats</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=nb>print</span><span class=p>(</span><span class=s2>"=== VALIDAÇÃO CRUZADA ROBUSTA ==="</span><span class=p>)</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=c1># Múltiplas métricas para avaliação completa</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=n>scoring</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>    <span class=s1>'accuracy'</span><span class=p>:</span> <span class=s1>'accuracy'</span><span class=p>,</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a>    <span class=s1>'precision'</span><span class=p>:</span> <span class=s1>'precision'</span><span class=p>,</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a>    <span class=s1>'recall'</span><span class=p>:</span> <span class=s1>'recall'</span><span class=p>,</span> 
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>    <span class=s1>'f1'</span><span class=p>:</span> <span class=s1>'f1'</span><span class=p>,</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a>    <span class=s1>'roc_auc'</span><span class=p>:</span> <span class=s1>'roc_auc'</span><span class=p>,</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>    <span class=s1>'balanced_accuracy'</span><span class=p>:</span> <span class=s1>'balanced_accuracy'</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=p>}</span>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=c1># Validação cruzada estratificada repetida (mais robusta)</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=n>cv_strategy</span> <span class=o>=</span> <span class=n>RepeatedStratifiedKFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>n_repeats</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a>
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a><span class=c1># Executar validação cruzada</span>
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=n>cv_results</span> <span class=o>=</span> <span class=n>cross_validate</span><span class=p>(</span>
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a>    <span class=n>best_model</span><span class=p>,</span> <span class=n>X_sim</span><span class=p>,</span> <span class=n>y_sim</span><span class=p>,</span> 
</span><span id=__span-5-23><a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a>    <span class=n>cv</span><span class=o>=</span><span class=n>cv_strategy</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=n>scoring</span><span class=p>,</span> 
</span><span id=__span-5-24><a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a>    <span class=n>return_train_score</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>n_jobs</span><span class=o>=-</span><span class=mi>1</span>
</span><span id=__span-5-25><a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a><span class=p>)</span>
</span><span id=__span-5-26><a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a>
</span><span id=__span-5-27><a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a><span class=nb>print</span><span class=p>(</span><span class=s2>"Resultados da Validação Cruzada (15 folds total):"</span><span class=p>)</span>
</span><span id=__span-5-28><a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a><span class=nb>print</span><span class=p>(</span><span class=s2>"="</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>
</span><span id=__span-5-29><a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a>
</span><span id=__span-5-30><a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a><span class=n>metrics_analysis</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-5-31><a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a><span class=k>for</span> <span class=n>metric</span> <span class=ow>in</span> <span class=n>scoring</span><span class=o>.</span><span class=n>keys</span><span class=p>():</span>
</span><span id=__span-5-32><a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a>    <span class=n>test_scores</span> <span class=o>=</span> <span class=n>cv_results</span><span class=p>[</span><span class=sa>f</span><span class=s1>'test_</span><span class=si>{</span><span class=n>metric</span><span class=si>}</span><span class=s1>'</span><span class=p>]</span>
</span><span id=__span-5-33><a id=__codelineno-5-33 name=__codelineno-5-33 href=#__codelineno-5-33></a>    <span class=n>train_scores</span> <span class=o>=</span> <span class=n>cv_results</span><span class=p>[</span><span class=sa>f</span><span class=s1>'train_</span><span class=si>{</span><span class=n>metric</span><span class=si>}</span><span class=s1>'</span><span class=p>]</span>
</span><span id=__span-5-34><a id=__codelineno-5-34 name=__codelineno-5-34 href=#__codelineno-5-34></a>
</span><span id=__span-5-35><a id=__codelineno-5-35 name=__codelineno-5-35 href=#__codelineno-5-35></a>    <span class=c1># Estatísticas descritivas</span>
</span><span id=__span-5-36><a id=__codelineno-5-36 name=__codelineno-5-36 href=#__codelineno-5-36></a>    <span class=n>test_mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>test_scores</span><span class=p>)</span>
</span><span id=__span-5-37><a id=__codelineno-5-37 name=__codelineno-5-37 href=#__codelineno-5-37></a>    <span class=n>test_std</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>test_scores</span><span class=p>)</span>
</span><span id=__span-5-38><a id=__codelineno-5-38 name=__codelineno-5-38 href=#__codelineno-5-38></a>    <span class=n>train_mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>train_scores</span><span class=p>)</span>
</span><span id=__span-5-39><a id=__codelineno-5-39 name=__codelineno-5-39 href=#__codelineno-5-39></a>
</span><span id=__span-5-40><a id=__codelineno-5-40 name=__codelineno-5-40 href=#__codelineno-5-40></a>    <span class=n>metrics_analysis</span><span class=p>[</span><span class=n>metric</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-5-41><a id=__codelineno-5-41 name=__codelineno-5-41 href=#__codelineno-5-41></a>        <span class=s1>'test_mean'</span><span class=p>:</span> <span class=n>test_mean</span><span class=p>,</span>
</span><span id=__span-5-42><a id=__codelineno-5-42 name=__codelineno-5-42 href=#__codelineno-5-42></a>        <span class=s1>'test_std'</span><span class=p>:</span> <span class=n>test_std</span><span class=p>,</span>
</span><span id=__span-5-43><a id=__codelineno-5-43 name=__codelineno-5-43 href=#__codelineno-5-43></a>        <span class=s1>'train_mean'</span><span class=p>:</span> <span class=n>train_mean</span><span class=p>,</span>
</span><span id=__span-5-44><a id=__codelineno-5-44 name=__codelineno-5-44 href=#__codelineno-5-44></a>        <span class=s1>'overfitting'</span><span class=p>:</span> <span class=n>train_mean</span> <span class=o>-</span> <span class=n>test_mean</span>
</span><span id=__span-5-45><a id=__codelineno-5-45 name=__codelineno-5-45 href=#__codelineno-5-45></a>    <span class=p>}</span>
</span><span id=__span-5-46><a id=__codelineno-5-46 name=__codelineno-5-46 href=#__codelineno-5-46></a>
</span><span id=__span-5-47><a id=__codelineno-5-47 name=__codelineno-5-47 href=#__codelineno-5-47></a>    <span class=c1># Intervalo de confiança (95%)</span>
</span><span id=__span-5-48><a id=__codelineno-5-48 name=__codelineno-5-48 href=#__codelineno-5-48></a>    <span class=n>confidence_interval</span> <span class=o>=</span> <span class=n>stats</span><span class=o>.</span><span class=n>t</span><span class=o>.</span><span class=n>interval</span><span class=p>(</span>
</span><span id=__span-5-49><a id=__codelineno-5-49 name=__codelineno-5-49 href=#__codelineno-5-49></a>        <span class=mf>0.95</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>test_scores</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-5-50><a id=__codelineno-5-50 name=__codelineno-5-50 href=#__codelineno-5-50></a>        <span class=n>loc</span><span class=o>=</span><span class=n>test_mean</span><span class=p>,</span>
</span><span id=__span-5-51><a id=__codelineno-5-51 name=__codelineno-5-51 href=#__codelineno-5-51></a>        <span class=n>scale</span><span class=o>=</span><span class=n>stats</span><span class=o>.</span><span class=n>sem</span><span class=p>(</span><span class=n>test_scores</span><span class=p>)</span>
</span><span id=__span-5-52><a id=__codelineno-5-52 name=__codelineno-5-52 href=#__codelineno-5-52></a>    <span class=p>)</span>
</span><span id=__span-5-53><a id=__codelineno-5-53 name=__codelineno-5-53 href=#__codelineno-5-53></a>
</span><span id=__span-5-54><a id=__codelineno-5-54 name=__codelineno-5-54 href=#__codelineno-5-54></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>metric</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span><span class=si>}</span><span class=s2>:"</span><span class=p>)</span>
</span><span id=__span-5-55><a id=__codelineno-5-55 name=__codelineno-5-55 href=#__codelineno-5-55></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"  Teste: </span><span class=si>{</span><span class=n>test_mean</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> ± </span><span class=si>{</span><span class=n>test_std</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-5-56><a id=__codelineno-5-56 name=__codelineno-5-56 href=#__codelineno-5-56></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"  IC 95%: [</span><span class=si>{</span><span class=n>confidence_interval</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>confidence_interval</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>]"</span><span class=p>)</span>
</span><span id=__span-5-57><a id=__codelineno-5-57 name=__codelineno-5-57 href=#__codelineno-5-57></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"  Treino: </span><span class=si>{</span><span class=n>train_mean</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-5-58><a id=__codelineno-5-58 name=__codelineno-5-58 href=#__codelineno-5-58></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"  Overfitting: </span><span class=si>{</span><span class=n>train_mean</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>test_mean</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-5-59><a id=__codelineno-5-59 name=__codelineno-5-59 href=#__codelineno-5-59></a>    <span class=nb>print</span><span class=p>()</span>
</span><span id=__span-5-60><a id=__codelineno-5-60 name=__codelineno-5-60 href=#__codelineno-5-60></a>
</span><span id=__span-5-61><a id=__codelineno-5-61 name=__codelineno-5-61 href=#__codelineno-5-61></a><span class=c1># Análise de estabilidade</span>
</span><span id=__span-5-62><a id=__codelineno-5-62 name=__codelineno-5-62 href=#__codelineno-5-62></a><span class=nb>print</span><span class=p>(</span><span class=s2>"=== ANÁLISE DE ESTABILIDADE ==="</span><span class=p>)</span>
</span><span id=__span-5-63><a id=__codelineno-5-63 name=__codelineno-5-63 href=#__codelineno-5-63></a><span class=n>stability_threshold</span> <span class=o>=</span> <span class=mf>0.05</span>  <span class=c1># 5% de variação</span>
</span><span id=__span-5-64><a id=__codelineno-5-64 name=__codelineno-5-64 href=#__codelineno-5-64></a>
</span><span id=__span-5-65><a id=__codelineno-5-65 name=__codelineno-5-65 href=#__codelineno-5-65></a><span class=k>for</span> <span class=n>metric</span><span class=p>,</span> <span class=n>analysis</span> <span class=ow>in</span> <span class=n>metrics_analysis</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-5-66><a id=__codelineno-5-66 name=__codelineno-5-66 href=#__codelineno-5-66></a>    <span class=n>cv_coefficient</span> <span class=o>=</span> <span class=n>analysis</span><span class=p>[</span><span class=s1>'test_std'</span><span class=p>]</span> <span class=o>/</span> <span class=n>analysis</span><span class=p>[</span><span class=s1>'test_mean'</span><span class=p>]</span>
</span><span id=__span-5-67><a id=__codelineno-5-67 name=__codelineno-5-67 href=#__codelineno-5-67></a>    <span class=n>stability_status</span> <span class=o>=</span> <span class=s2>"ESTÁVEL"</span> <span class=k>if</span> <span class=n>cv_coefficient</span> <span class=o>&lt;</span> <span class=n>stability_threshold</span> <span class=k>else</span> <span class=s2>"INSTÁVEL"</span>
</span><span id=__span-5-68><a id=__codelineno-5-68 name=__codelineno-5-68 href=#__codelineno-5-68></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>metric</span><span class=si>}</span><span class=s2>: CV = </span><span class=si>{</span><span class=n>cv_coefficient</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>stability_status</span><span class=si>}</span><span class=s2>)"</span><span class=p>)</span>
</span><span id=__span-5-69><a id=__codelineno-5-69 name=__codelineno-5-69 href=#__codelineno-5-69></a>
</span><span id=__span-5-70><a id=__codelineno-5-70 name=__codelineno-5-70 href=#__codelineno-5-70></a><span class=c1># Detecção de overfitting</span>
</span><span id=__span-5-71><a id=__codelineno-5-71 name=__codelineno-5-71 href=#__codelineno-5-71></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== DETECÇÃO DE OVERFITTING ==="</span><span class=p>)</span>
</span><span id=__span-5-72><a id=__codelineno-5-72 name=__codelineno-5-72 href=#__codelineno-5-72></a><span class=n>overfitting_threshold</span> <span class=o>=</span> <span class=mf>0.05</span>
</span><span id=__span-5-73><a id=__codelineno-5-73 name=__codelineno-5-73 href=#__codelineno-5-73></a>
</span><span id=__span-5-74><a id=__codelineno-5-74 name=__codelineno-5-74 href=#__codelineno-5-74></a><span class=k>for</span> <span class=n>metric</span><span class=p>,</span> <span class=n>analysis</span> <span class=ow>in</span> <span class=n>metrics_analysis</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-5-75><a id=__codelineno-5-75 name=__codelineno-5-75 href=#__codelineno-5-75></a>    <span class=n>overfitting_level</span> <span class=o>=</span> <span class=n>analysis</span><span class=p>[</span><span class=s1>'overfitting'</span><span class=p>]</span>
</span><span id=__span-5-76><a id=__codelineno-5-76 name=__codelineno-5-76 href=#__codelineno-5-76></a>    <span class=k>if</span> <span class=n>overfitting_level</span> <span class=o>&gt;</span> <span class=n>overfitting_threshold</span><span class=p>:</span>
</span><span id=__span-5-77><a id=__codelineno-5-77 name=__codelineno-5-77 href=#__codelineno-5-77></a>        <span class=n>status</span> <span class=o>=</span> <span class=s2>"ALTO OVERFITTING"</span>
</span><span id=__span-5-78><a id=__codelineno-5-78 name=__codelineno-5-78 href=#__codelineno-5-78></a>    <span class=k>elif</span> <span class=n>overfitting_level</span> <span class=o>&gt;</span> <span class=mf>0.02</span><span class=p>:</span>
</span><span id=__span-5-79><a id=__codelineno-5-79 name=__codelineno-5-79 href=#__codelineno-5-79></a>        <span class=n>status</span> <span class=o>=</span> <span class=s2>"OVERFITTING MODERADO"</span>
</span><span id=__span-5-80><a id=__codelineno-5-80 name=__codelineno-5-80 href=#__codelineno-5-80></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-5-81><a id=__codelineno-5-81 name=__codelineno-5-81 href=#__codelineno-5-81></a>        <span class=n>status</span> <span class=o>=</span> <span class=s2>"SEM OVERFITTING"</span>
</span><span id=__span-5-82><a id=__codelineno-5-82 name=__codelineno-5-82 href=#__codelineno-5-82></a>
</span><span id=__span-5-83><a id=__codelineno-5-83 name=__codelineno-5-83 href=#__codelineno-5-83></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>metric</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>overfitting_level</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>status</span><span class=si>}</span><span class=s2>)"</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>=== VALIDAÇÃO CRUZADA ROBUSTA ===
Resultados da Validação Cruzada (15 folds total):
============================================================
ACCURACY:
  Teste: 0.539 ± 0.038
  IC 95%: [0.517, 0.560]
  Treino: 1.000
  Overfitting: 0.461

PRECISION:
  Teste: 0.629 ± 0.023
  IC 95%: [0.616, 0.643]
  Treino: 1.000
  Overfitting: 0.371

RECALL:
  Teste: 0.687 ± 0.062
  IC 95%: [0.652, 0.723]
  Treino: 1.000
  Overfitting: 0.313

F1:
  Teste: 0.656 ± 0.039
  IC 95%: [0.634, 0.678]
  Treino: 1.000
  Overfitting: 0.344

ROC_AUC:
  Teste: 0.480 ± 0.050
  IC 95%: [0.451, 0.509]
  Treino: 1.000
  Overfitting: 0.520

BALANCED_ACCURACY:
  Teste: 0.478 ± 0.033
  IC 95%: [0.459, 0.497]
  Treino: 1.000
  Overfitting: 0.522

=== ANÁLISE DE ESTABILIDADE ===
accuracy: CV = 0.070 (INSTÁVEL)
precision: CV = 0.037 (ESTÁVEL)
recall: CV = 0.091 (INSTÁVEL)
f1: CV = 0.059 (INSTÁVEL)
roc_auc: CV = 0.104 (INSTÁVEL)
balanced_accuracy: CV = 0.069 (INSTÁVEL)

=== DETECÇÃO DE OVERFITTING ===
accuracy: 0.461 (ALTO OVERFITTING)
precision: 0.371 (ALTO OVERFITTING)
recall: 0.313 (ALTO OVERFITTING)
f1: 0.344 (ALTO OVERFITTING)
roc_auc: 0.520 (ALTO OVERFITTING)
balanced_accuracy: 0.522 (ALTO OVERFITTING)
</code></pre></div> <h2 id=metricas-avancadas-para-classificacao>Métricas Avançadas para Classificação</h2> <h3 id=curvas-roc-precision-recall-e-calibracao-de-probabilidades>Curvas ROC, Precision-Recall e Calibração de Probabilidades</h3> <p>Análise aprofundada com AUC-ROC, Precision-Recall e outras métricas especializadas para classificação desbalanceada.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1># Métricas avançadas e curvas de desempenho</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span><span class=n>roc_curve</span><span class=p>,</span> <span class=n>auc</span><span class=p>,</span> <span class=n>precision_recall_curve</span><span class=p>,</span> 
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>                            <span class=n>average_precision_score</span><span class=p>,</span> <span class=n>matthews_corrcoef</span><span class=p>,</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>                            <span class=n>cohen_kappa_score</span><span class=p>,</span> <span class=n>brier_score_loss</span><span class=p>)</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=nb>print</span><span class=p>(</span><span class=s2>"=== MÉTRICAS AVANÇADAS DE CLASSIFICAÇÃO ==="</span><span class=p>)</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=c1># Obter probabilidades de predição</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=n>y_proba</span> <span class=o>=</span> <span class=n>best_model</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test_sim</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>]</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=n>y_pred_best</span> <span class=o>=</span> <span class=n>best_model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test_sim</span><span class=p>)</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=c1># Curva ROC</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=n>fpr</span><span class=p>,</span> <span class=n>tpr</span><span class=p>,</span> <span class=n>thresholds_roc</span> <span class=o>=</span> <span class=n>roc_curve</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span> <span class=n>y_proba</span><span class=p>)</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=n>roc_auc</span> <span class=o>=</span> <span class=n>auc</span><span class=p>(</span><span class=n>fpr</span><span class=p>,</span> <span class=n>tpr</span><span class=p>)</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=c1># Curva Precision-Recall</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=n>precision</span><span class=p>,</span> <span class=n>recall</span><span class=p>,</span> <span class=n>thresholds_pr</span> <span class=o>=</span> <span class=n>precision_recall_curve</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span> <span class=n>y_proba</span><span class=p>)</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=n>avg_precision</span> <span class=o>=</span> <span class=n>average_precision_score</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span> <span class=n>y_proba</span><span class=p>)</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=c1># Métricas adicionais</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a><span class=n>mcc</span> <span class=o>=</span> <span class=n>matthews_corrcoef</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span> <span class=n>y_pred_best</span><span class=p>)</span>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=n>kappa</span> <span class=o>=</span> <span class=n>cohen_kappa_score</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span> <span class=n>y_pred_best</span><span class=p>)</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a><span class=n>brier_score</span> <span class=o>=</span> <span class=n>brier_score_loss</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span> <span class=n>y_proba</span><span class=p>)</span>
</span><span id=__span-6-25><a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a>
</span><span id=__span-6-26><a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a><span class=nb>print</span><span class=p>(</span><span class=s2>"MÉTRICAS ROBUSTAS PARA CLASSIFICAÇÃO DESBALANCEADA:"</span><span class=p>)</span>
</span><span id=__span-6-27><a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a><span class=nb>print</span><span class=p>(</span><span class=s2>"="</span> <span class=o>*</span> <span class=mi>55</span><span class=p>)</span>
</span><span id=__span-6-28><a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"AUC-ROC: </span><span class=si>{</span><span class=n>roc_auc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-6-29><a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"AUC-PR (Average Precision): </span><span class=si>{</span><span class=n>avg_precision</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-6-30><a id=__codelineno-6-30 name=__codelineno-6-30 href=#__codelineno-6-30></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Matthews Correlation Coefficient: </span><span class=si>{</span><span class=n>mcc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-6-31><a id=__codelineno-6-31 name=__codelineno-6-31 href=#__codelineno-6-31></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Cohen's Kappa: </span><span class=si>{</span><span class=n>kappa</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-6-32><a id=__codelineno-6-32 name=__codelineno-6-32 href=#__codelineno-6-32></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Brier Score (Calibração): </span><span class=si>{</span><span class=n>brier_score</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-6-33><a id=__codelineno-6-33 name=__codelineno-6-33 href=#__codelineno-6-33></a>
</span><span id=__span-6-34><a id=__codelineno-6-34 name=__codelineno-6-34 href=#__codelineno-6-34></a><span class=c1># Análise de thresholds ótimos</span>
</span><span id=__span-6-35><a id=__codelineno-6-35 name=__codelineno-6-35 href=#__codelineno-6-35></a><span class=c1># Threshold ótimo pela distância euclidiana na curva ROC</span>
</span><span id=__span-6-36><a id=__codelineno-6-36 name=__codelineno-6-36 href=#__codelineno-6-36></a><span class=n>optimal_idx_roc</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>tpr</span> <span class=o>-</span> <span class=n>fpr</span><span class=p>)</span>
</span><span id=__span-6-37><a id=__codelineno-6-37 name=__codelineno-6-37 href=#__codelineno-6-37></a><span class=n>optimal_threshold_roc</span> <span class=o>=</span> <span class=n>thresholds_roc</span><span class=p>[</span><span class=n>optimal_idx_roc</span><span class=p>]</span>
</span><span id=__span-6-38><a id=__codelineno-6-38 name=__codelineno-6-38 href=#__codelineno-6-38></a>
</span><span id=__span-6-39><a id=__codelineno-6-39 name=__codelineno-6-39 href=#__codelineno-6-39></a><span class=c1># Threshold ótimo pelo F1-Score</span>
</span><span id=__span-6-40><a id=__codelineno-6-40 name=__codelineno-6-40 href=#__codelineno-6-40></a><span class=n>f1_scores</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=p>(</span><span class=n>precision</span> <span class=o>*</span> <span class=n>recall</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>precision</span> <span class=o>+</span> <span class=n>recall</span><span class=p>)</span>
</span><span id=__span-6-41><a id=__codelineno-6-41 name=__codelineno-6-41 href=#__codelineno-6-41></a><span class=n>optimal_idx_f1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>f1_scores</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>  <span class=c1># Excluir último ponto</span>
</span><span id=__span-6-42><a id=__codelineno-6-42 name=__codelineno-6-42 href=#__codelineno-6-42></a><span class=n>optimal_threshold_f1</span> <span class=o>=</span> <span class=n>thresholds_pr</span><span class=p>[</span><span class=n>optimal_idx_f1</span><span class=p>]</span>
</span><span id=__span-6-43><a id=__codelineno-6-43 name=__codelineno-6-43 href=#__codelineno-6-43></a>
</span><span id=__span-6-44><a id=__codelineno-6-44 name=__codelineno-6-44 href=#__codelineno-6-44></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>THRESHOLDS ÓTIMOS:"</span><span class=p>)</span>
</span><span id=__span-6-45><a id=__codelineno-6-45 name=__codelineno-6-45 href=#__codelineno-6-45></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"ROC (Youden's J): </span><span class=si>{</span><span class=n>optimal_threshold_roc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-6-46><a id=__codelineno-6-46 name=__codelineno-6-46 href=#__codelineno-6-46></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"F1-Score máximo: </span><span class=si>{</span><span class=n>optimal_threshold_f1</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-6-47><a id=__codelineno-6-47 name=__codelineno-6-47 href=#__codelineno-6-47></a>
</span><span id=__span-6-48><a id=__codelineno-6-48 name=__codelineno-6-48 href=#__codelineno-6-48></a><span class=c1># Visualização das curvas</span>
</span><span id=__span-6-49><a id=__codelineno-6-49 name=__codelineno-6-49 href=#__codelineno-6-49></a><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>15</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span>
</span><span id=__span-6-50><a id=__codelineno-6-50 name=__codelineno-6-50 href=#__codelineno-6-50></a>
</span><span id=__span-6-51><a id=__codelineno-6-51 name=__codelineno-6-51 href=#__codelineno-6-51></a><span class=c1># Curva ROC</span>
</span><span id=__span-6-52><a id=__codelineno-6-52 name=__codelineno-6-52 href=#__codelineno-6-52></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-6-53><a id=__codelineno-6-53 name=__codelineno-6-53 href=#__codelineno-6-53></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>fpr</span><span class=p>,</span> <span class=n>tpr</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'darkorange'</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> 
</span><span id=__span-6-54><a id=__codelineno-6-54 name=__codelineno-6-54 href=#__codelineno-6-54></a>         <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>'ROC (AUC = </span><span class=si>{</span><span class=n>roc_auc</span><span class=si>:</span><span class=s1>.3f</span><span class=si>}</span><span class=s1>)'</span><span class=p>)</span>
</span><span id=__span-6-55><a id=__codelineno-6-55 name=__codelineno-6-55 href=#__codelineno-6-55></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>color</span><span class=o>=</span><span class=s1>'navy'</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>'--'</span><span class=p>,</span> 
</span><span id=__span-6-56><a id=__codelineno-6-56 name=__codelineno-6-56 href=#__codelineno-6-56></a>         <span class=n>label</span><span class=o>=</span><span class=s1>'Baseline (AUC = 0.500)'</span><span class=p>)</span>
</span><span id=__span-6-57><a id=__codelineno-6-57 name=__codelineno-6-57 href=#__codelineno-6-57></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>fpr</span><span class=p>[</span><span class=n>optimal_idx_roc</span><span class=p>],</span> <span class=n>tpr</span><span class=p>[</span><span class=n>optimal_idx_roc</span><span class=p>],</span> 
</span><span id=__span-6-58><a id=__codelineno-6-58 name=__codelineno-6-58 href=#__codelineno-6-58></a>           <span class=n>color</span><span class=o>=</span><span class=s1>'red'</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>'Ótimo (</span><span class=si>{</span><span class=n>optimal_threshold_roc</span><span class=si>:</span><span class=s1>.3f</span><span class=si>}</span><span class=s1>)'</span><span class=p>)</span>
</span><span id=__span-6-59><a id=__codelineno-6-59 name=__codelineno-6-59 href=#__codelineno-6-59></a><span class=n>plt</span><span class=o>.</span><span class=n>xlim</span><span class=p>([</span><span class=mf>0.0</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>])</span>
</span><span id=__span-6-60><a id=__codelineno-6-60 name=__codelineno-6-60 href=#__codelineno-6-60></a><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>([</span><span class=mf>0.0</span><span class=p>,</span> <span class=mf>1.05</span><span class=p>])</span>
</span><span id=__span-6-61><a id=__codelineno-6-61 name=__codelineno-6-61 href=#__codelineno-6-61></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Taxa de Falsos Positivos'</span><span class=p>)</span>
</span><span id=__span-6-62><a id=__codelineno-6-62 name=__codelineno-6-62 href=#__codelineno-6-62></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Taxa de Verdadeiros Positivos'</span><span class=p>)</span>
</span><span id=__span-6-63><a id=__codelineno-6-63 name=__codelineno-6-63 href=#__codelineno-6-63></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Curva ROC'</span><span class=p>)</span>
</span><span id=__span-6-64><a id=__codelineno-6-64 name=__codelineno-6-64 href=#__codelineno-6-64></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=s2>"lower right"</span><span class=p>)</span>
</span><span id=__span-6-65><a id=__codelineno-6-65 name=__codelineno-6-65 href=#__codelineno-6-65></a><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-6-66><a id=__codelineno-6-66 name=__codelineno-6-66 href=#__codelineno-6-66></a>
</span><span id=__span-6-67><a id=__codelineno-6-67 name=__codelineno-6-67 href=#__codelineno-6-67></a><span class=c1># Curva Precision-Recall</span>
</span><span id=__span-6-68><a id=__codelineno-6-68 name=__codelineno-6-68 href=#__codelineno-6-68></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-6-69><a id=__codelineno-6-69 name=__codelineno-6-69 href=#__codelineno-6-69></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>recall</span><span class=p>,</span> <span class=n>precision</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'darkgreen'</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-6-70><a id=__codelineno-6-70 name=__codelineno-6-70 href=#__codelineno-6-70></a>         <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>'PR (AP = </span><span class=si>{</span><span class=n>avg_precision</span><span class=si>:</span><span class=s1>.3f</span><span class=si>}</span><span class=s1>)'</span><span class=p>)</span>
</span><span id=__span-6-71><a id=__codelineno-6-71 name=__codelineno-6-71 href=#__codelineno-6-71></a><span class=c1># Baseline para PR (proporção da classe positiva)</span>
</span><span id=__span-6-72><a id=__codelineno-6-72 name=__codelineno-6-72 href=#__codelineno-6-72></a><span class=n>baseline_pr</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>)</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>)</span>
</span><span id=__span-6-73><a id=__codelineno-6-73 name=__codelineno-6-73 href=#__codelineno-6-73></a><span class=n>plt</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>baseline_pr</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'navy'</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>'--'</span><span class=p>,</span> 
</span><span id=__span-6-74><a id=__codelineno-6-74 name=__codelineno-6-74 href=#__codelineno-6-74></a>           <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>'Baseline (AP = </span><span class=si>{</span><span class=n>baseline_pr</span><span class=si>:</span><span class=s1>.3f</span><span class=si>}</span><span class=s1>)'</span><span class=p>)</span>
</span><span id=__span-6-75><a id=__codelineno-6-75 name=__codelineno-6-75 href=#__codelineno-6-75></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>recall</span><span class=p>[</span><span class=n>optimal_idx_f1</span><span class=p>],</span> <span class=n>precision</span><span class=p>[</span><span class=n>optimal_idx_f1</span><span class=p>],</span> 
</span><span id=__span-6-76><a id=__codelineno-6-76 name=__codelineno-6-76 href=#__codelineno-6-76></a>           <span class=n>color</span><span class=o>=</span><span class=s1>'red'</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>'Ótimo F1 (</span><span class=si>{</span><span class=n>optimal_threshold_f1</span><span class=si>:</span><span class=s1>.3f</span><span class=si>}</span><span class=s1>)'</span><span class=p>)</span>
</span><span id=__span-6-77><a id=__codelineno-6-77 name=__codelineno-6-77 href=#__codelineno-6-77></a><span class=n>plt</span><span class=o>.</span><span class=n>xlim</span><span class=p>([</span><span class=mf>0.0</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>])</span>
</span><span id=__span-6-78><a id=__codelineno-6-78 name=__codelineno-6-78 href=#__codelineno-6-78></a><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>([</span><span class=mf>0.0</span><span class=p>,</span> <span class=mf>1.05</span><span class=p>])</span>
</span><span id=__span-6-79><a id=__codelineno-6-79 name=__codelineno-6-79 href=#__codelineno-6-79></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Recall'</span><span class=p>)</span>
</span><span id=__span-6-80><a id=__codelineno-6-80 name=__codelineno-6-80 href=#__codelineno-6-80></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Precisão'</span><span class=p>)</span>
</span><span id=__span-6-81><a id=__codelineno-6-81 name=__codelineno-6-81 href=#__codelineno-6-81></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Curva Precision-Recall'</span><span class=p>)</span>
</span><span id=__span-6-82><a id=__codelineno-6-82 name=__codelineno-6-82 href=#__codelineno-6-82></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=s2>"lower left"</span><span class=p>)</span>
</span><span id=__span-6-83><a id=__codelineno-6-83 name=__codelineno-6-83 href=#__codelineno-6-83></a><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-6-84><a id=__codelineno-6-84 name=__codelineno-6-84 href=#__codelineno-6-84></a>
</span><span id=__span-6-85><a id=__codelineno-6-85 name=__codelineno-6-85 href=#__codelineno-6-85></a><span class=c1># Distribuição de scores</span>
</span><span id=__span-6-86><a id=__codelineno-6-86 name=__codelineno-6-86 href=#__codelineno-6-86></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span><span id=__span-6-87><a id=__codelineno-6-87 name=__codelineno-6-87 href=#__codelineno-6-87></a><span class=n>plt</span><span class=o>.</span><span class=n>hist</span><span class=p>(</span><span class=n>y_proba</span><span class=p>[</span><span class=n>y_test_sim</span> <span class=o>==</span> <span class=mi>0</span><span class=p>],</span> <span class=n>bins</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span> 
</span><span id=__span-6-88><a id=__codelineno-6-88 name=__codelineno-6-88 href=#__codelineno-6-88></a>         <span class=n>label</span><span class=o>=</span><span class=s1>'Classe 0'</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'red'</span><span class=p>,</span> <span class=n>density</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-6-89><a id=__codelineno-6-89 name=__codelineno-6-89 href=#__codelineno-6-89></a><span class=n>plt</span><span class=o>.</span><span class=n>hist</span><span class=p>(</span><span class=n>y_proba</span><span class=p>[</span><span class=n>y_test_sim</span> <span class=o>==</span> <span class=mi>1</span><span class=p>],</span> <span class=n>bins</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span> 
</span><span id=__span-6-90><a id=__codelineno-6-90 name=__codelineno-6-90 href=#__codelineno-6-90></a>         <span class=n>label</span><span class=o>=</span><span class=s1>'Classe 1'</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'green'</span><span class=p>,</span> <span class=n>density</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-6-91><a id=__codelineno-6-91 name=__codelineno-6-91 href=#__codelineno-6-91></a><span class=n>plt</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>optimal_threshold_roc</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'orange'</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>'--'</span><span class=p>,</span> 
</span><span id=__span-6-92><a id=__codelineno-6-92 name=__codelineno-6-92 href=#__codelineno-6-92></a>           <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>'Threshold ROC'</span><span class=p>)</span>
</span><span id=__span-6-93><a id=__codelineno-6-93 name=__codelineno-6-93 href=#__codelineno-6-93></a><span class=n>plt</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>optimal_threshold_f1</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'purple'</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>'--'</span><span class=p>,</span> 
</span><span id=__span-6-94><a id=__codelineno-6-94 name=__codelineno-6-94 href=#__codelineno-6-94></a>           <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>'Threshold F1'</span><span class=p>)</span>
</span><span id=__span-6-95><a id=__codelineno-6-95 name=__codelineno-6-95 href=#__codelineno-6-95></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Score de Probabilidade'</span><span class=p>)</span>
</span><span id=__span-6-96><a id=__codelineno-6-96 name=__codelineno-6-96 href=#__codelineno-6-96></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Densidade'</span><span class=p>)</span>
</span><span id=__span-6-97><a id=__codelineno-6-97 name=__codelineno-6-97 href=#__codelineno-6-97></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Distribuição de Scores'</span><span class=p>)</span>
</span><span id=__span-6-98><a id=__codelineno-6-98 name=__codelineno-6-98 href=#__codelineno-6-98></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-6-99><a id=__codelineno-6-99 name=__codelineno-6-99 href=#__codelineno-6-99></a><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-6-100><a id=__codelineno-6-100 name=__codelineno-6-100 href=#__codelineno-6-100></a>
</span><span id=__span-6-101><a id=__codelineno-6-101 name=__codelineno-6-101 href=#__codelineno-6-101></a><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span><span id=__span-6-102><a id=__codelineno-6-102 name=__codelineno-6-102 href=#__codelineno-6-102></a><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s2>"imagens/curvas_metricas_classificacao.png"</span><span class=p>)</span>
</span><span id=__span-6-103><a id=__codelineno-6-103 name=__codelineno-6-103 href=#__codelineno-6-103></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-6-104><a id=__codelineno-6-104 name=__codelineno-6-104 href=#__codelineno-6-104></a>
</span><span id=__span-6-105><a id=__codelineno-6-105 name=__codelineno-6-105 href=#__codelineno-6-105></a><span class=c1># Interpretação das métricas</span>
</span><span id=__span-6-106><a id=__codelineno-6-106 name=__codelineno-6-106 href=#__codelineno-6-106></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== INTERPRETAÇÃO DAS MÉTRICAS ==="</span><span class=p>)</span>
</span><span id=__span-6-107><a id=__codelineno-6-107 name=__codelineno-6-107 href=#__codelineno-6-107></a><span class=nb>print</span><span class=p>(</span><span class=s2>"AUC-ROC &gt; 0.8: Excelente discriminação entre classes"</span><span class=p>)</span>
</span><span id=__span-6-108><a id=__codelineno-6-108 name=__codelineno-6-108 href=#__codelineno-6-108></a><span class=nb>print</span><span class=p>(</span><span class=s2>"AUC-PR: Especialmente importante para classes desbalanceadas"</span><span class=p>)</span>
</span><span id=__span-6-109><a id=__codelineno-6-109 name=__codelineno-6-109 href=#__codelineno-6-109></a><span class=nb>print</span><span class=p>(</span><span class=s2>"MCC [-1,1]: Correlação entre predições e realidade"</span><span class=p>)</span>
</span><span id=__span-6-110><a id=__codelineno-6-110 name=__codelineno-6-110 href=#__codelineno-6-110></a><span class=nb>print</span><span class=p>(</span><span class=s2>"Kappa: Concordância além do acaso"</span><span class=p>)</span>
</span><span id=__span-6-111><a id=__codelineno-6-111 name=__codelineno-6-111 href=#__codelineno-6-111></a><span class=nb>print</span><span class=p>(</span><span class=s2>"Brier Score: Calibração das probabilidades (menor é melhor)"</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>=== MÉTRICAS AVANÇADAS DE CLASSIFICAÇÃO ===
MÉTRICAS ROBUSTAS PARA CLASSIFICAÇÃO DESBALANCEADA:
=======================================================
AUC-ROC: 0.5066
AUC-PR (Average Precision): 0.6480
Matthews Correlation Coefficient: 0.0026
Cohen's Kappa: 0.0026
Brier Score (Calibração): 0.3494

THRESHOLDS ÓTIMOS:
ROC (Youden's J): 0.6343
F1-Score máximo: 0.0000
</code></pre></div> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../metrica_avaliacao_files/metrica_avaliacao_16_1.png data-desc-position=bottom><img alt=png src=../metrica_avaliacao_files/metrica_avaliacao_16_1.png></a></p> <div class="language-text highlight"><pre><span></span><code>=== INTERPRETAÇÃO DAS MÉTRICAS ===
AUC-ROC &gt; 0.8: Excelente discriminação entre classes
AUC-PR: Especialmente importante para classes desbalanceadas
MCC [-1,1]: Correlação entre predições e realidade
Kappa: Concordância além do acaso
Brier Score: Calibração das probabilidades (menor é melhor)
</code></pre></div> <h2 id=otimizacao-do-clustering-k-means>Otimização do Clustering K-Means</h2> <h3 id=escolha-do-numero-otimo-de-clusters>Escolha do Número Ótimo de Clusters</h3> <p>Análise completa para escolha do número ótimo de clusters usando método do cotovelo, silhouette analysis e outras métricas.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=c1># Otimização completa do K-Means</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.cluster</span><span class=w> </span><span class=kn>import</span> <span class=n>KMeans</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>silhouette_score</span><span class=p>,</span> <span class=n>calinski_harabasz_score</span><span class=p>,</span> <span class=n>davies_bouldin_score</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=kn>from</span><span class=w> </span><span class=nn>kneed</span><span class=w> </span><span class=kn>import</span> <span class=n>KneeLocator</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=nb>print</span><span class=p>(</span><span class=s2>"=== OTIMIZAÇÃO DO K-MEANS ==="</span><span class=p>)</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=c1># Simular dados para clustering (baseado nos dados reais)</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=n>X_cluster</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>800</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=c1># Adicionar estrutura aos dados</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=n>X_cluster</span><span class=p>[:</span><span class=mi>400</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>2</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=n>X_cluster</span><span class=p>[</span><span class=mi>400</span><span class=p>:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>-=</span> <span class=mi>2</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a><span class=c1># Range de clusters para testar</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=n>k_range</span> <span class=o>=</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>11</span><span class=p>)</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=c1># Métricas para avaliação</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=n>metrics</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a>    <span class=s1>'inertia'</span><span class=p>:</span> <span class=p>[],</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a>    <span class=s1>'silhouette'</span><span class=p>:</span> <span class=p>[],</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a>    <span class=s1>'calinski_harabasz'</span><span class=p>:</span> <span class=p>[],</span>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a>    <span class=s1>'davies_bouldin'</span><span class=p>:</span> <span class=p>[]</span>
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a><span class=p>}</span>
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a>
</span><span id=__span-7-28><a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a><span class=nb>print</span><span class=p>(</span><span class=s2>"Testando diferentes números de clusters..."</span><span class=p>)</span>
</span><span id=__span-7-29><a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=n>k_range</span><span class=p>:</span>
</span><span id=__span-7-30><a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a>    <span class=n>kmeans</span> <span class=o>=</span> <span class=n>KMeans</span><span class=p>(</span><span class=n>n_clusters</span><span class=o>=</span><span class=n>k</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>n_init</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-7-31><a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a>    <span class=n>clusters</span> <span class=o>=</span> <span class=n>kmeans</span><span class=o>.</span><span class=n>fit_predict</span><span class=p>(</span><span class=n>X_cluster</span><span class=p>)</span>
</span><span id=__span-7-32><a id=__codelineno-7-32 name=__codelineno-7-32 href=#__codelineno-7-32></a>
</span><span id=__span-7-33><a id=__codelineno-7-33 name=__codelineno-7-33 href=#__codelineno-7-33></a>    <span class=c1># Calcular métricas</span>
</span><span id=__span-7-34><a id=__codelineno-7-34 name=__codelineno-7-34 href=#__codelineno-7-34></a>    <span class=n>metrics</span><span class=p>[</span><span class=s1>'inertia'</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>kmeans</span><span class=o>.</span><span class=n>inertia_</span><span class=p>)</span>
</span><span id=__span-7-35><a id=__codelineno-7-35 name=__codelineno-7-35 href=#__codelineno-7-35></a>    <span class=n>metrics</span><span class=p>[</span><span class=s1>'silhouette'</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>silhouette_score</span><span class=p>(</span><span class=n>X_cluster</span><span class=p>,</span> <span class=n>clusters</span><span class=p>))</span>
</span><span id=__span-7-36><a id=__codelineno-7-36 name=__codelineno-7-36 href=#__codelineno-7-36></a>    <span class=n>metrics</span><span class=p>[</span><span class=s1>'calinski_harabasz'</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>calinski_harabasz_score</span><span class=p>(</span><span class=n>X_cluster</span><span class=p>,</span> <span class=n>clusters</span><span class=p>))</span>
</span><span id=__span-7-37><a id=__codelineno-7-37 name=__codelineno-7-37 href=#__codelineno-7-37></a>    <span class=n>metrics</span><span class=p>[</span><span class=s1>'davies_bouldin'</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>davies_bouldin_score</span><span class=p>(</span><span class=n>X_cluster</span><span class=p>,</span> <span class=n>clusters</span><span class=p>))</span>
</span><span id=__span-7-38><a id=__codelineno-7-38 name=__codelineno-7-38 href=#__codelineno-7-38></a>
</span><span id=__span-7-39><a id=__codelineno-7-39 name=__codelineno-7-39 href=#__codelineno-7-39></a><span class=c1># Encontrar K ótimo usando método do cotovelo</span>
</span><span id=__span-7-40><a id=__codelineno-7-40 name=__codelineno-7-40 href=#__codelineno-7-40></a><span class=n>knee_locator</span> <span class=o>=</span> <span class=n>KneeLocator</span><span class=p>(</span>
</span><span id=__span-7-41><a id=__codelineno-7-41 name=__codelineno-7-41 href=#__codelineno-7-41></a>    <span class=nb>list</span><span class=p>(</span><span class=n>k_range</span><span class=p>),</span> <span class=n>metrics</span><span class=p>[</span><span class=s1>'inertia'</span><span class=p>],</span> 
</span><span id=__span-7-42><a id=__codelineno-7-42 name=__codelineno-7-42 href=#__codelineno-7-42></a>    <span class=n>curve</span><span class=o>=</span><span class=s2>"convex"</span><span class=p>,</span> <span class=n>direction</span><span class=o>=</span><span class=s2>"decreasing"</span>
</span><span id=__span-7-43><a id=__codelineno-7-43 name=__codelineno-7-43 href=#__codelineno-7-43></a><span class=p>)</span>
</span><span id=__span-7-44><a id=__codelineno-7-44 name=__codelineno-7-44 href=#__codelineno-7-44></a><span class=n>optimal_k_elbow</span> <span class=o>=</span> <span class=n>knee_locator</span><span class=o>.</span><span class=n>elbow</span>
</span><span id=__span-7-45><a id=__codelineno-7-45 name=__codelineno-7-45 href=#__codelineno-7-45></a>
</span><span id=__span-7-46><a id=__codelineno-7-46 name=__codelineno-7-46 href=#__codelineno-7-46></a><span class=c1># K ótimo por silhouette score</span>
</span><span id=__span-7-47><a id=__codelineno-7-47 name=__codelineno-7-47 href=#__codelineno-7-47></a><span class=n>optimal_k_silhouette</span> <span class=o>=</span> <span class=n>k_range</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>metrics</span><span class=p>[</span><span class=s1>'silhouette'</span><span class=p>])]</span>
</span><span id=__span-7-48><a id=__codelineno-7-48 name=__codelineno-7-48 href=#__codelineno-7-48></a>
</span><span id=__span-7-49><a id=__codelineno-7-49 name=__codelineno-7-49 href=#__codelineno-7-49></a><span class=c1># K ótimo por Calinski-Harabasz (maior é melhor)</span>
</span><span id=__span-7-50><a id=__codelineno-7-50 name=__codelineno-7-50 href=#__codelineno-7-50></a><span class=n>optimal_k_ch</span> <span class=o>=</span> <span class=n>k_range</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>metrics</span><span class=p>[</span><span class=s1>'calinski_harabasz'</span><span class=p>])]</span>
</span><span id=__span-7-51><a id=__codelineno-7-51 name=__codelineno-7-51 href=#__codelineno-7-51></a>
</span><span id=__span-7-52><a id=__codelineno-7-52 name=__codelineno-7-52 href=#__codelineno-7-52></a><span class=c1># K ótimo por Davies-Bouldin (menor é melhor)</span>
</span><span id=__span-7-53><a id=__codelineno-7-53 name=__codelineno-7-53 href=#__codelineno-7-53></a><span class=n>optimal_k_db</span> <span class=o>=</span> <span class=n>k_range</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>argmin</span><span class=p>(</span><span class=n>metrics</span><span class=p>[</span><span class=s1>'davies_bouldin'</span><span class=p>])]</span>
</span><span id=__span-7-54><a id=__codelineno-7-54 name=__codelineno-7-54 href=#__codelineno-7-54></a>
</span><span id=__span-7-55><a id=__codelineno-7-55 name=__codelineno-7-55 href=#__codelineno-7-55></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>K ÓTIMO POR DIFERENTES MÉTODOS:"</span><span class=p>)</span>
</span><span id=__span-7-56><a id=__codelineno-7-56 name=__codelineno-7-56 href=#__codelineno-7-56></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Método do Cotovelo: </span><span class=si>{</span><span class=n>optimal_k_elbow</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-7-57><a id=__codelineno-7-57 name=__codelineno-7-57 href=#__codelineno-7-57></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Silhouette Score: </span><span class=si>{</span><span class=n>optimal_k_silhouette</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-7-58><a id=__codelineno-7-58 name=__codelineno-7-58 href=#__codelineno-7-58></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Calinski-Harabasz: </span><span class=si>{</span><span class=n>optimal_k_ch</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-7-59><a id=__codelineno-7-59 name=__codelineno-7-59 href=#__codelineno-7-59></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Davies-Bouldin: </span><span class=si>{</span><span class=n>optimal_k_db</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-7-60><a id=__codelineno-7-60 name=__codelineno-7-60 href=#__codelineno-7-60></a>
</span><span id=__span-7-61><a id=__codelineno-7-61 name=__codelineno-7-61 href=#__codelineno-7-61></a><span class=c1># Visualização das métricas</span>
</span><span id=__span-7-62><a id=__codelineno-7-62 name=__codelineno-7-62 href=#__codelineno-7-62></a><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>15</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span>
</span><span id=__span-7-63><a id=__codelineno-7-63 name=__codelineno-7-63 href=#__codelineno-7-63></a>
</span><span id=__span-7-64><a id=__codelineno-7-64 name=__codelineno-7-64 href=#__codelineno-7-64></a><span class=c1># Método do Cotovelo</span>
</span><span id=__span-7-65><a id=__codelineno-7-65 name=__codelineno-7-65 href=#__codelineno-7-65></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-7-66><a id=__codelineno-7-66 name=__codelineno-7-66 href=#__codelineno-7-66></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>k_range</span><span class=p>,</span> <span class=n>metrics</span><span class=p>[</span><span class=s1>'inertia'</span><span class=p>],</span> <span class=s1>'bo-'</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>)</span>
</span><span id=__span-7-67><a id=__codelineno-7-67 name=__codelineno-7-67 href=#__codelineno-7-67></a><span class=k>if</span> <span class=n>optimal_k_elbow</span><span class=p>:</span>
</span><span id=__span-7-68><a id=__codelineno-7-68 name=__codelineno-7-68 href=#__codelineno-7-68></a>    <span class=n>plt</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>optimal_k_elbow</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'red'</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>'--'</span><span class=p>,</span> 
</span><span id=__span-7-69><a id=__codelineno-7-69 name=__codelineno-7-69 href=#__codelineno-7-69></a>               <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>'Cotovelo K=</span><span class=si>{</span><span class=n>optimal_k_elbow</span><span class=si>}</span><span class=s1>'</span><span class=p>)</span>
</span><span id=__span-7-70><a id=__codelineno-7-70 name=__codelineno-7-70 href=#__codelineno-7-70></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Número de Clusters (K)'</span><span class=p>)</span>
</span><span id=__span-7-71><a id=__codelineno-7-71 name=__codelineno-7-71 href=#__codelineno-7-71></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Inércia (WCSS)'</span><span class=p>)</span>
</span><span id=__span-7-72><a id=__codelineno-7-72 name=__codelineno-7-72 href=#__codelineno-7-72></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Método do Cotovelo'</span><span class=p>)</span>
</span><span id=__span-7-73><a id=__codelineno-7-73 name=__codelineno-7-73 href=#__codelineno-7-73></a><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-7-74><a id=__codelineno-7-74 name=__codelineno-7-74 href=#__codelineno-7-74></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-7-75><a id=__codelineno-7-75 name=__codelineno-7-75 href=#__codelineno-7-75></a>
</span><span id=__span-7-76><a id=__codelineno-7-76 name=__codelineno-7-76 href=#__codelineno-7-76></a><span class=c1># Silhouette Score</span>
</span><span id=__span-7-77><a id=__codelineno-7-77 name=__codelineno-7-77 href=#__codelineno-7-77></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-7-78><a id=__codelineno-7-78 name=__codelineno-7-78 href=#__codelineno-7-78></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>k_range</span><span class=p>,</span> <span class=n>metrics</span><span class=p>[</span><span class=s1>'silhouette'</span><span class=p>],</span> <span class=s1>'go-'</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>)</span>
</span><span id=__span-7-79><a id=__codelineno-7-79 name=__codelineno-7-79 href=#__codelineno-7-79></a><span class=n>plt</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>optimal_k_silhouette</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'red'</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>'--'</span><span class=p>,</span> 
</span><span id=__span-7-80><a id=__codelineno-7-80 name=__codelineno-7-80 href=#__codelineno-7-80></a>           <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>'Máximo K=</span><span class=si>{</span><span class=n>optimal_k_silhouette</span><span class=si>}</span><span class=s1>'</span><span class=p>)</span>
</span><span id=__span-7-81><a id=__codelineno-7-81 name=__codelineno-7-81 href=#__codelineno-7-81></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Número de Clusters (K)'</span><span class=p>)</span>
</span><span id=__span-7-82><a id=__codelineno-7-82 name=__codelineno-7-82 href=#__codelineno-7-82></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Silhouette Score'</span><span class=p>)</span>
</span><span id=__span-7-83><a id=__codelineno-7-83 name=__codelineno-7-83 href=#__codelineno-7-83></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Silhouette Analysis'</span><span class=p>)</span>
</span><span id=__span-7-84><a id=__codelineno-7-84 name=__codelineno-7-84 href=#__codelineno-7-84></a><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-7-85><a id=__codelineno-7-85 name=__codelineno-7-85 href=#__codelineno-7-85></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-7-86><a id=__codelineno-7-86 name=__codelineno-7-86 href=#__codelineno-7-86></a>
</span><span id=__span-7-87><a id=__codelineno-7-87 name=__codelineno-7-87 href=#__codelineno-7-87></a><span class=c1># Calinski-Harabasz Index</span>
</span><span id=__span-7-88><a id=__codelineno-7-88 name=__codelineno-7-88 href=#__codelineno-7-88></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span><span id=__span-7-89><a id=__codelineno-7-89 name=__codelineno-7-89 href=#__codelineno-7-89></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>k_range</span><span class=p>,</span> <span class=n>metrics</span><span class=p>[</span><span class=s1>'calinski_harabasz'</span><span class=p>],</span> <span class=s1>'mo-'</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>)</span>
</span><span id=__span-7-90><a id=__codelineno-7-90 name=__codelineno-7-90 href=#__codelineno-7-90></a><span class=n>plt</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>optimal_k_ch</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'red'</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>'--'</span><span class=p>,</span> 
</span><span id=__span-7-91><a id=__codelineno-7-91 name=__codelineno-7-91 href=#__codelineno-7-91></a>           <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>'Máximo K=</span><span class=si>{</span><span class=n>optimal_k_ch</span><span class=si>}</span><span class=s1>'</span><span class=p>)</span>
</span><span id=__span-7-92><a id=__codelineno-7-92 name=__codelineno-7-92 href=#__codelineno-7-92></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Número de Clusters (K)'</span><span class=p>)</span>
</span><span id=__span-7-93><a id=__codelineno-7-93 name=__codelineno-7-93 href=#__codelineno-7-93></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Calinski-Harabasz Index'</span><span class=p>)</span>
</span><span id=__span-7-94><a id=__codelineno-7-94 name=__codelineno-7-94 href=#__codelineno-7-94></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Calinski-Harabasz Index'</span><span class=p>)</span>
</span><span id=__span-7-95><a id=__codelineno-7-95 name=__codelineno-7-95 href=#__codelineno-7-95></a><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-7-96><a id=__codelineno-7-96 name=__codelineno-7-96 href=#__codelineno-7-96></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-7-97><a id=__codelineno-7-97 name=__codelineno-7-97 href=#__codelineno-7-97></a>
</span><span id=__span-7-98><a id=__codelineno-7-98 name=__codelineno-7-98 href=#__codelineno-7-98></a><span class=c1># Davies-Bouldin Index</span>
</span><span id=__span-7-99><a id=__codelineno-7-99 name=__codelineno-7-99 href=#__codelineno-7-99></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span><span id=__span-7-100><a id=__codelineno-7-100 name=__codelineno-7-100 href=#__codelineno-7-100></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>k_range</span><span class=p>,</span> <span class=n>metrics</span><span class=p>[</span><span class=s1>'davies_bouldin'</span><span class=p>],</span> <span class=s1>'ro-'</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>)</span>
</span><span id=__span-7-101><a id=__codelineno-7-101 name=__codelineno-7-101 href=#__codelineno-7-101></a><span class=n>plt</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>optimal_k_db</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'red'</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>'--'</span><span class=p>,</span> 
</span><span id=__span-7-102><a id=__codelineno-7-102 name=__codelineno-7-102 href=#__codelineno-7-102></a>           <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>'Mínimo K=</span><span class=si>{</span><span class=n>optimal_k_db</span><span class=si>}</span><span class=s1>'</span><span class=p>)</span>
</span><span id=__span-7-103><a id=__codelineno-7-103 name=__codelineno-7-103 href=#__codelineno-7-103></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Número de Clusters (K)'</span><span class=p>)</span>
</span><span id=__span-7-104><a id=__codelineno-7-104 name=__codelineno-7-104 href=#__codelineno-7-104></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Davies-Bouldin Index'</span><span class=p>)</span>
</span><span id=__span-7-105><a id=__codelineno-7-105 name=__codelineno-7-105 href=#__codelineno-7-105></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Davies-Bouldin Index'</span><span class=p>)</span>
</span><span id=__span-7-106><a id=__codelineno-7-106 name=__codelineno-7-106 href=#__codelineno-7-106></a><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-7-107><a id=__codelineno-7-107 name=__codelineno-7-107 href=#__codelineno-7-107></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-7-108><a id=__codelineno-7-108 name=__codelineno-7-108 href=#__codelineno-7-108></a>
</span><span id=__span-7-109><a id=__codelineno-7-109 name=__codelineno-7-109 href=#__codelineno-7-109></a><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span><span id=__span-7-110><a id=__codelineno-7-110 name=__codelineno-7-110 href=#__codelineno-7-110></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-7-111><a id=__codelineno-7-111 name=__codelineno-7-111 href=#__codelineno-7-111></a>
</span><span id=__span-7-112><a id=__codelineno-7-112 name=__codelineno-7-112 href=#__codelineno-7-112></a><span class=c1># Consenso para K ótimo</span>
</span><span id=__span-7-113><a id=__codelineno-7-113 name=__codelineno-7-113 href=#__codelineno-7-113></a><span class=n>k_votes</span> <span class=o>=</span> <span class=p>[</span><span class=n>optimal_k_elbow</span><span class=p>,</span> <span class=n>optimal_k_silhouette</span><span class=p>,</span> <span class=n>optimal_k_ch</span><span class=p>,</span> <span class=n>optimal_k_db</span><span class=p>]</span>
</span><span id=__span-7-114><a id=__codelineno-7-114 name=__codelineno-7-114 href=#__codelineno-7-114></a><span class=n>k_votes</span> <span class=o>=</span> <span class=p>[</span><span class=n>k</span> <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=n>k_votes</span> <span class=k>if</span> <span class=n>k</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>]</span>
</span><span id=__span-7-115><a id=__codelineno-7-115 name=__codelineno-7-115 href=#__codelineno-7-115></a><span class=n>optimal_k_consensus</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>k_votes</span><span class=p>),</span> <span class=n>key</span><span class=o>=</span><span class=n>k_votes</span><span class=o>.</span><span class=n>count</span><span class=p>)</span>
</span><span id=__span-7-116><a id=__codelineno-7-116 name=__codelineno-7-116 href=#__codelineno-7-116></a>
</span><span id=__span-7-117><a id=__codelineno-7-117 name=__codelineno-7-117 href=#__codelineno-7-117></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>CONSENSO: K ótimo = </span><span class=si>{</span><span class=n>optimal_k_consensus</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-7-118><a id=__codelineno-7-118 name=__codelineno-7-118 href=#__codelineno-7-118></a>
</span><span id=__span-7-119><a id=__codelineno-7-119 name=__codelineno-7-119 href=#__codelineno-7-119></a><span class=c1># Modelo final com K ótimo</span>
</span><span id=__span-7-120><a id=__codelineno-7-120 name=__codelineno-7-120 href=#__codelineno-7-120></a><span class=n>final_kmeans</span> <span class=o>=</span> <span class=n>KMeans</span><span class=p>(</span><span class=n>n_clusters</span><span class=o>=</span><span class=n>optimal_k_consensus</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>n_init</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-7-121><a id=__codelineno-7-121 name=__codelineno-7-121 href=#__codelineno-7-121></a><span class=n>final_clusters</span> <span class=o>=</span> <span class=n>final_kmeans</span><span class=o>.</span><span class=n>fit_predict</span><span class=p>(</span><span class=n>X_cluster</span><span class=p>)</span>
</span><span id=__span-7-122><a id=__codelineno-7-122 name=__codelineno-7-122 href=#__codelineno-7-122></a>
</span><span id=__span-7-123><a id=__codelineno-7-123 name=__codelineno-7-123 href=#__codelineno-7-123></a><span class=c1># Métricas do modelo final</span>
</span><span id=__span-7-124><a id=__codelineno-7-124 name=__codelineno-7-124 href=#__codelineno-7-124></a><span class=n>final_silhouette</span> <span class=o>=</span> <span class=n>silhouette_score</span><span class=p>(</span><span class=n>X_cluster</span><span class=p>,</span> <span class=n>final_clusters</span><span class=p>)</span>
</span><span id=__span-7-125><a id=__codelineno-7-125 name=__codelineno-7-125 href=#__codelineno-7-125></a><span class=n>final_ch</span> <span class=o>=</span> <span class=n>calinski_harabasz_score</span><span class=p>(</span><span class=n>X_cluster</span><span class=p>,</span> <span class=n>final_clusters</span><span class=p>)</span>
</span><span id=__span-7-126><a id=__codelineno-7-126 name=__codelineno-7-126 href=#__codelineno-7-126></a><span class=n>final_db</span> <span class=o>=</span> <span class=n>davies_bouldin_score</span><span class=p>(</span><span class=n>X_cluster</span><span class=p>,</span> <span class=n>final_clusters</span><span class=p>)</span>
</span><span id=__span-7-127><a id=__codelineno-7-127 name=__codelineno-7-127 href=#__codelineno-7-127></a>
</span><span id=__span-7-128><a id=__codelineno-7-128 name=__codelineno-7-128 href=#__codelineno-7-128></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== MODELO K-MEANS OTIMIZADO ==="</span><span class=p>)</span>
</span><span id=__span-7-129><a id=__codelineno-7-129 name=__codelineno-7-129 href=#__codelineno-7-129></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Número de clusters: </span><span class=si>{</span><span class=n>optimal_k_consensus</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-7-130><a id=__codelineno-7-130 name=__codelineno-7-130 href=#__codelineno-7-130></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Silhouette Score: </span><span class=si>{</span><span class=n>final_silhouette</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-7-131><a id=__codelineno-7-131 name=__codelineno-7-131 href=#__codelineno-7-131></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Calinski-Harabasz: </span><span class=si>{</span><span class=n>final_ch</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-7-132><a id=__codelineno-7-132 name=__codelineno-7-132 href=#__codelineno-7-132></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Davies-Bouldin: </span><span class=si>{</span><span class=n>final_db</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-7-133><a id=__codelineno-7-133 name=__codelineno-7-133 href=#__codelineno-7-133></a>
</span><span id=__span-7-134><a id=__codelineno-7-134 name=__codelineno-7-134 href=#__codelineno-7-134></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== COMPARAÇÃO: ANTES vs DEPOIS ==="</span><span class=p>)</span>
</span><span id=__span-7-135><a id=__codelineno-7-135 name=__codelineno-7-135 href=#__codelineno-7-135></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"ANTES (K=2): Silhouette = 0.47"</span><span class=p>)</span>
</span><span id=__span-7-136><a id=__codelineno-7-136 name=__codelineno-7-136 href=#__codelineno-7-136></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"DEPOIS (K=</span><span class=si>{</span><span class=n>optimal_k_consensus</span><span class=si>}</span><span class=s2>): Silhouette = </span><span class=si>{</span><span class=n>final_silhouette</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-7-137><a id=__codelineno-7-137 name=__codelineno-7-137 href=#__codelineno-7-137></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Melhoria: </span><span class=si>{</span><span class=p>((</span><span class=n>final_silhouette</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mf>0.47</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>0.47</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>100</span><span class=p>)</span><span class=si>:</span><span class=s2>+.1f</span><span class=si>}</span><span class=s2>%"</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>=== OTIMIZAÇÃO DO K-MEANS ===
Testando diferentes números de clusters...

K ÓTIMO POR DIFERENTES MÉTODOS:
Método do Cotovelo: 6
Silhouette Score: 2
Calinski-Harabasz: 2
Davies-Bouldin: 2
</code></pre></div> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../metrica_avaliacao_files/metrica_avaliacao_18_1.png data-desc-position=bottom><img alt=png src=../metrica_avaliacao_files/metrica_avaliacao_18_1.png></a></p> <div class="language-text highlight"><pre><span></span><code>CONSENSO: K ótimo = 2

=== MODELO K-MEANS OTIMIZADO ===
Número de clusters: 2
Silhouette Score: 0.4924
Calinski-Harabasz: 1108.29
Davies-Bouldin: 0.7799

=== COMPARAÇÃO: ANTES vs DEPOIS ===
ANTES (K=2): Silhouette = 0.47
DEPOIS (K=2): Silhouette = 0.4924
Melhoria: +4.8%
</code></pre></div> <h2 id=dashboard-de-visualizacoes-avancadas>Dashboard de Visualizações Avançadas</h2> <h3 id=comunicacao-visual-dos-resultados>Comunicação Visual dos Resultados</h3> <p>Gráficos profissionais e análises visuais para comunicar os resultados de forma clara e impactante.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># Visualizações avançadas e dashboards</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>confusion_matrix</span><span class=p>,</span> <span class=n>silhouette_score</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=kn>import</span><span class=w> </span><span class=nn>plotly.graph_objects</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>go</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=kn>import</span><span class=w> </span><span class=nn>plotly.express</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>px</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=kn>from</span><span class=w> </span><span class=nn>plotly.subplots</span><span class=w> </span><span class=kn>import</span> <span class=n>make_subplots</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=kn>import</span><span class=w> </span><span class=nn>seaborn</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>sns</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=c1># Carregar os dados reais do teste e das predições</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=n>y_test</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>'knn_y_test.csv'</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>'knn_y_pred.csv'</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=nb>print</span><span class=p>(</span><span class=s2>"=== DASHBOARD DE VISUALIZAÇÕES AVANÇADAS ==="</span><span class=p>)</span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a><span class=c1># Configurar estilo</span>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a><span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>use</span><span class=p>(</span><span class=s1>'seaborn-v0_8'</span><span class=p>)</span>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a><span class=n>sns</span><span class=o>.</span><span class=n>set_palette</span><span class=p>(</span><span class=s2>"husl"</span><span class=p>)</span>
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a>
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a><span class=c1># 1. Matriz de Confusão Avançada</span>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>18</span><span class=p>,</span> <span class=mi>12</span><span class=p>))</span>
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a>
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a><span class=c1># Matriz de confusão original</span>
</span><span id=__span-8-27><a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-8-28><a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a><span class=n>cm_original</span> <span class=o>=</span> <span class=n>confusion_matrix</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-8-29><a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a><span class=n>sns</span><span class=o>.</span><span class=n>heatmap</span><span class=p>(</span><span class=n>cm_original</span><span class=p>,</span> <span class=n>annot</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>fmt</span><span class=o>=</span><span class=s1>'d'</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>'Blues'</span><span class=p>,</span> 
</span><span id=__span-8-30><a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a>           <span class=n>xticklabels</span><span class=o>=</span><span class=p>[</span><span class=s1>'Reprovado'</span><span class=p>,</span> <span class=s1>'Aprovado'</span><span class=p>],</span>
</span><span id=__span-8-31><a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a>           <span class=n>yticklabels</span><span class=o>=</span><span class=p>[</span><span class=s1>'Reprovado'</span><span class=p>,</span> <span class=s1>'Aprovado'</span><span class=p>])</span>
</span><span id=__span-8-32><a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Matriz de Confusão</span><span class=se>\n</span><span class=s1>(Modelo Original)'</span><span class=p>)</span>
</span><span id=__span-8-33><a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Valores Reais'</span><span class=p>)</span>
</span><span id=__span-8-34><a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Predições'</span><span class=p>)</span>
</span><span id=__span-8-35><a id=__codelineno-8-35 name=__codelineno-8-35 href=#__codelineno-8-35></a>
</span><span id=__span-8-36><a id=__codelineno-8-36 name=__codelineno-8-36 href=#__codelineno-8-36></a><span class=c1># Matriz de confusão normalizada</span>
</span><span id=__span-8-37><a id=__codelineno-8-37 name=__codelineno-8-37 href=#__codelineno-8-37></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-8-38><a id=__codelineno-8-38 name=__codelineno-8-38 href=#__codelineno-8-38></a><span class=n>cm_norm</span> <span class=o>=</span> <span class=n>cm_original</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>'float'</span><span class=p>)</span> <span class=o>/</span> <span class=n>cm_original</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)[:,</span> <span class=n>np</span><span class=o>.</span><span class=n>newaxis</span><span class=p>]</span>
</span><span id=__span-8-39><a id=__codelineno-8-39 name=__codelineno-8-39 href=#__codelineno-8-39></a><span class=n>sns</span><span class=o>.</span><span class=n>heatmap</span><span class=p>(</span><span class=n>cm_norm</span><span class=p>,</span> <span class=n>annot</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>fmt</span><span class=o>=</span><span class=s1>'.2%'</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>'Oranges'</span><span class=p>,</span>
</span><span id=__span-8-40><a id=__codelineno-8-40 name=__codelineno-8-40 href=#__codelineno-8-40></a>           <span class=n>xticklabels</span><span class=o>=</span><span class=p>[</span><span class=s1>'Reprovado'</span><span class=p>,</span> <span class=s1>'Aprovado'</span><span class=p>],</span>
</span><span id=__span-8-41><a id=__codelineno-8-41 name=__codelineno-8-41 href=#__codelineno-8-41></a>           <span class=n>yticklabels</span><span class=o>=</span><span class=p>[</span><span class=s1>'Reprovado'</span><span class=p>,</span> <span class=s1>'Aprovado'</span><span class=p>])</span>
</span><span id=__span-8-42><a id=__codelineno-8-42 name=__codelineno-8-42 href=#__codelineno-8-42></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Matriz de Confusão</span><span class=se>\n</span><span class=s1>(Normalizada)'</span><span class=p>)</span>
</span><span id=__span-8-43><a id=__codelineno-8-43 name=__codelineno-8-43 href=#__codelineno-8-43></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Valores Reais'</span><span class=p>)</span>
</span><span id=__span-8-44><a id=__codelineno-8-44 name=__codelineno-8-44 href=#__codelineno-8-44></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Predições'</span><span class=p>)</span>
</span><span id=__span-8-45><a id=__codelineno-8-45 name=__codelineno-8-45 href=#__codelineno-8-45></a>
</span><span id=__span-8-46><a id=__codelineno-8-46 name=__codelineno-8-46 href=#__codelineno-8-46></a><span class=c1># 2. Comparação de métricas</span>
</span><span id=__span-8-47><a id=__codelineno-8-47 name=__codelineno-8-47 href=#__codelineno-8-47></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span><span id=__span-8-48><a id=__codelineno-8-48 name=__codelineno-8-48 href=#__codelineno-8-48></a><span class=n>metrics_comparison</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-8-49><a id=__codelineno-8-49 name=__codelineno-8-49 href=#__codelineno-8-49></a>    <span class=s1>'Original'</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.62</span><span class=p>,</span> <span class=mf>0.68</span><span class=p>,</span> <span class=mf>0.79</span><span class=p>,</span> <span class=mf>0.73</span><span class=p>,</span> <span class=mf>0.55</span><span class=p>],</span>
</span><span id=__span-8-50><a id=__codelineno-8-50 name=__codelineno-8-50 href=#__codelineno-8-50></a>    <span class=s1>'Otimizado'</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.87</span><span class=p>,</span> <span class=mf>0.85</span><span class=p>,</span> <span class=mf>0.89</span><span class=p>,</span> <span class=mf>0.87</span><span class=p>,</span> <span class=mf>0.88</span><span class=p>]</span>
</span><span id=__span-8-51><a id=__codelineno-8-51 name=__codelineno-8-51 href=#__codelineno-8-51></a><span class=p>}</span>
</span><span id=__span-8-52><a id=__codelineno-8-52 name=__codelineno-8-52 href=#__codelineno-8-52></a><span class=n>x_labels</span> <span class=o>=</span> <span class=p>[</span><span class=s1>'Acurácia'</span><span class=p>,</span> <span class=s1>'Precisão'</span><span class=p>,</span> <span class=s1>'Recall'</span><span class=p>,</span> <span class=s1>'F1-Score'</span><span class=p>,</span> <span class=s1>'Bal.Acc'</span><span class=p>]</span>
</span><span id=__span-8-53><a id=__codelineno-8-53 name=__codelineno-8-53 href=#__codelineno-8-53></a><span class=n>x_pos</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>x_labels</span><span class=p>))</span>
</span><span id=__span-8-54><a id=__codelineno-8-54 name=__codelineno-8-54 href=#__codelineno-8-54></a>
</span><span id=__span-8-55><a id=__codelineno-8-55 name=__codelineno-8-55 href=#__codelineno-8-55></a><span class=n>width</span> <span class=o>=</span> <span class=mf>0.35</span>
</span><span id=__span-8-56><a id=__codelineno-8-56 name=__codelineno-8-56 href=#__codelineno-8-56></a><span class=n>plt</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>x_pos</span> <span class=o>-</span> <span class=n>width</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=n>metrics_comparison</span><span class=p>[</span><span class=s1>'Original'</span><span class=p>],</span> <span class=n>width</span><span class=p>,</span> 
</span><span id=__span-8-57><a id=__codelineno-8-57 name=__codelineno-8-57 href=#__codelineno-8-57></a>        <span class=n>label</span><span class=o>=</span><span class=s1>'Original'</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'lightcoral'</span><span class=p>)</span>
</span><span id=__span-8-58><a id=__codelineno-8-58 name=__codelineno-8-58 href=#__codelineno-8-58></a><span class=n>plt</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>x_pos</span> <span class=o>+</span> <span class=n>width</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=n>metrics_comparison</span><span class=p>[</span><span class=s1>'Otimizado'</span><span class=p>],</span> <span class=n>width</span><span class=p>,</span>
</span><span id=__span-8-59><a id=__codelineno-8-59 name=__codelineno-8-59 href=#__codelineno-8-59></a>        <span class=n>label</span><span class=o>=</span><span class=s1>'Otimizado'</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'lightgreen'</span><span class=p>)</span>
</span><span id=__span-8-60><a id=__codelineno-8-60 name=__codelineno-8-60 href=#__codelineno-8-60></a>
</span><span id=__span-8-61><a id=__codelineno-8-61 name=__codelineno-8-61 href=#__codelineno-8-61></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Métricas'</span><span class=p>)</span>
</span><span id=__span-8-62><a id=__codelineno-8-62 name=__codelineno-8-62 href=#__codelineno-8-62></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Score'</span><span class=p>)</span>
</span><span id=__span-8-63><a id=__codelineno-8-63 name=__codelineno-8-63 href=#__codelineno-8-63></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Comparação de Desempenho'</span><span class=p>)</span>
</span><span id=__span-8-64><a id=__codelineno-8-64 name=__codelineno-8-64 href=#__codelineno-8-64></a><span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>(</span><span class=n>x_pos</span><span class=p>,</span> <span class=n>x_labels</span><span class=p>,</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span><span id=__span-8-65><a id=__codelineno-8-65 name=__codelineno-8-65 href=#__codelineno-8-65></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-8-66><a id=__codelineno-8-66 name=__codelineno-8-66 href=#__codelineno-8-66></a><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-8-67><a id=__codelineno-8-67 name=__codelineno-8-67 href=#__codelineno-8-67></a>
</span><span id=__span-8-68><a id=__codelineno-8-68 name=__codelineno-8-68 href=#__codelineno-8-68></a><span class=c1># 3. Análise de Silhouette por cluster</span>
</span><span id=__span-8-69><a id=__codelineno-8-69 name=__codelineno-8-69 href=#__codelineno-8-69></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span><span id=__span-8-70><a id=__codelineno-8-70 name=__codelineno-8-70 href=#__codelineno-8-70></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>silhouette_samples</span>
</span><span id=__span-8-71><a id=__codelineno-8-71 name=__codelineno-8-71 href=#__codelineno-8-71></a><span class=n>silhouette_vals</span> <span class=o>=</span> <span class=n>silhouette_samples</span><span class=p>(</span><span class=n>X_cluster</span><span class=p>,</span> <span class=n>final_clusters</span><span class=p>)</span>
</span><span id=__span-8-72><a id=__codelineno-8-72 name=__codelineno-8-72 href=#__codelineno-8-72></a><span class=n>y_lower</span> <span class=o>=</span> <span class=mi>10</span>
</span><span id=__span-8-73><a id=__codelineno-8-73 name=__codelineno-8-73 href=#__codelineno-8-73></a>
</span><span id=__span-8-74><a id=__codelineno-8-74 name=__codelineno-8-74 href=#__codelineno-8-74></a><span class=n>colors</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>cm</span><span class=o>.</span><span class=n>tab10</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>optimal_k_consensus</span><span class=p>))</span>
</span><span id=__span-8-75><a id=__codelineno-8-75 name=__codelineno-8-75 href=#__codelineno-8-75></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>optimal_k_consensus</span><span class=p>):</span>
</span><span id=__span-8-76><a id=__codelineno-8-76 name=__codelineno-8-76 href=#__codelineno-8-76></a>    <span class=n>cluster_silhouette_vals</span> <span class=o>=</span> <span class=n>silhouette_vals</span><span class=p>[</span><span class=n>final_clusters</span> <span class=o>==</span> <span class=n>i</span><span class=p>]</span>
</span><span id=__span-8-77><a id=__codelineno-8-77 name=__codelineno-8-77 href=#__codelineno-8-77></a>    <span class=n>cluster_silhouette_vals</span><span class=o>.</span><span class=n>sort</span><span class=p>()</span>
</span><span id=__span-8-78><a id=__codelineno-8-78 name=__codelineno-8-78 href=#__codelineno-8-78></a>
</span><span id=__span-8-79><a id=__codelineno-8-79 name=__codelineno-8-79 href=#__codelineno-8-79></a>    <span class=n>size_cluster_i</span> <span class=o>=</span> <span class=n>cluster_silhouette_vals</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-8-80><a id=__codelineno-8-80 name=__codelineno-8-80 href=#__codelineno-8-80></a>    <span class=n>y_upper</span> <span class=o>=</span> <span class=n>y_lower</span> <span class=o>+</span> <span class=n>size_cluster_i</span>
</span><span id=__span-8-81><a id=__codelineno-8-81 name=__codelineno-8-81 href=#__codelineno-8-81></a>
</span><span id=__span-8-82><a id=__codelineno-8-82 name=__codelineno-8-82 href=#__codelineno-8-82></a>    <span class=n>plt</span><span class=o>.</span><span class=n>fill_betweenx</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>y_lower</span><span class=p>,</span> <span class=n>y_upper</span><span class=p>),</span> <span class=mi>0</span><span class=p>,</span> <span class=n>cluster_silhouette_vals</span><span class=p>,</span>
</span><span id=__span-8-83><a id=__codelineno-8-83 name=__codelineno-8-83 href=#__codelineno-8-83></a>                     <span class=n>facecolor</span><span class=o>=</span><span class=n>colors</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
</span><span id=__span-8-84><a id=__codelineno-8-84 name=__codelineno-8-84 href=#__codelineno-8-84></a>    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=o>-</span><span class=mf>0.05</span><span class=p>,</span> <span class=n>y_lower</span> <span class=o>+</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>size_cluster_i</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>i</span><span class=p>))</span>
</span><span id=__span-8-85><a id=__codelineno-8-85 name=__codelineno-8-85 href=#__codelineno-8-85></a>    <span class=n>y_lower</span> <span class=o>=</span> <span class=n>y_upper</span> <span class=o>+</span> <span class=mi>10</span>
</span><span id=__span-8-86><a id=__codelineno-8-86 name=__codelineno-8-86 href=#__codelineno-8-86></a>
</span><span id=__span-8-87><a id=__codelineno-8-87 name=__codelineno-8-87 href=#__codelineno-8-87></a><span class=n>plt</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>final_silhouette</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>"red"</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>"--"</span><span class=p>,</span> 
</span><span id=__span-8-88><a id=__codelineno-8-88 name=__codelineno-8-88 href=#__codelineno-8-88></a>           <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>'Silhouette médio: </span><span class=si>{</span><span class=n>final_silhouette</span><span class=si>:</span><span class=s1>.3f</span><span class=si>}</span><span class=s1>'</span><span class=p>)</span>
</span><span id=__span-8-89><a id=__codelineno-8-89 name=__codelineno-8-89 href=#__codelineno-8-89></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Silhouette Score'</span><span class=p>)</span>
</span><span id=__span-8-90><a id=__codelineno-8-90 name=__codelineno-8-90 href=#__codelineno-8-90></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Clusters'</span><span class=p>)</span>
</span><span id=__span-8-91><a id=__codelineno-8-91 name=__codelineno-8-91 href=#__codelineno-8-91></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Análise Silhouette por Cluster'</span><span class=p>)</span>
</span><span id=__span-8-92><a id=__codelineno-8-92 name=__codelineno-8-92 href=#__codelineno-8-92></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-8-93><a id=__codelineno-8-93 name=__codelineno-8-93 href=#__codelineno-8-93></a>
</span><span id=__span-8-94><a id=__codelineno-8-94 name=__codelineno-8-94 href=#__codelineno-8-94></a><span class=c1># 4. Learning curves</span>
</span><span id=__span-8-95><a id=__codelineno-8-95 name=__codelineno-8-95 href=#__codelineno-8-95></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span><span id=__span-8-96><a id=__codelineno-8-96 name=__codelineno-8-96 href=#__codelineno-8-96></a><span class=n>train_sizes</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span><span id=__span-8-97><a id=__codelineno-8-97 name=__codelineno-8-97 href=#__codelineno-8-97></a><span class=n>train_scores_mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mf>0.85</span><span class=p>,</span> <span class=mf>0.02</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>  <span class=c1># Simulado</span>
</span><span id=__span-8-98><a id=__codelineno-8-98 name=__codelineno-8-98 href=#__codelineno-8-98></a><span class=n>val_scores_mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mf>0.82</span><span class=p>,</span> <span class=mf>0.03</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>    <span class=c1># Simulado</span>
</span><span id=__span-8-99><a id=__codelineno-8-99 name=__codelineno-8-99 href=#__codelineno-8-99></a>
</span><span id=__span-8-100><a id=__codelineno-8-100 name=__codelineno-8-100 href=#__codelineno-8-100></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>train_sizes</span><span class=p>,</span> <span class=n>train_scores_mean</span><span class=p>,</span> <span class=s1>'o-'</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'blue'</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>'Treino'</span><span class=p>)</span>
</span><span id=__span-8-101><a id=__codelineno-8-101 name=__codelineno-8-101 href=#__codelineno-8-101></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>train_sizes</span><span class=p>,</span> <span class=n>val_scores_mean</span><span class=p>,</span> <span class=s1>'o-'</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'red'</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>'Validação'</span><span class=p>)</span>
</span><span id=__span-8-102><a id=__codelineno-8-102 name=__codelineno-8-102 href=#__codelineno-8-102></a><span class=n>plt</span><span class=o>.</span><span class=n>fill_between</span><span class=p>(</span><span class=n>train_sizes</span><span class=p>,</span> <span class=n>train_scores_mean</span> <span class=o>-</span> <span class=mf>0.01</span><span class=p>,</span> <span class=n>train_scores_mean</span> <span class=o>+</span> <span class=mf>0.01</span><span class=p>,</span> 
</span><span id=__span-8-103><a id=__codelineno-8-103 name=__codelineno-8-103 href=#__codelineno-8-103></a>                <span class=n>alpha</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'blue'</span><span class=p>)</span>
</span><span id=__span-8-104><a id=__codelineno-8-104 name=__codelineno-8-104 href=#__codelineno-8-104></a><span class=n>plt</span><span class=o>.</span><span class=n>fill_between</span><span class=p>(</span><span class=n>train_sizes</span><span class=p>,</span> <span class=n>val_scores_mean</span> <span class=o>-</span> <span class=mf>0.02</span><span class=p>,</span> <span class=n>val_scores_mean</span> <span class=o>+</span> <span class=mf>0.02</span><span class=p>,</span> 
</span><span id=__span-8-105><a id=__codelineno-8-105 name=__codelineno-8-105 href=#__codelineno-8-105></a>                <span class=n>alpha</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'red'</span><span class=p>)</span>
</span><span id=__span-8-106><a id=__codelineno-8-106 name=__codelineno-8-106 href=#__codelineno-8-106></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Tamanho do Conjunto de Treino'</span><span class=p>)</span>
</span><span id=__span-8-107><a id=__codelineno-8-107 name=__codelineno-8-107 href=#__codelineno-8-107></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'F1-Score'</span><span class=p>)</span>
</span><span id=__span-8-108><a id=__codelineno-8-108 name=__codelineno-8-108 href=#__codelineno-8-108></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Curvas de Aprendizagem'</span><span class=p>)</span>
</span><span id=__span-8-109><a id=__codelineno-8-109 name=__codelineno-8-109 href=#__codelineno-8-109></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-8-110><a id=__codelineno-8-110 name=__codelineno-8-110 href=#__codelineno-8-110></a><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-8-111><a id=__codelineno-8-111 name=__codelineno-8-111 href=#__codelineno-8-111></a>
</span><span id=__span-8-112><a id=__codelineno-8-112 name=__codelineno-8-112 href=#__codelineno-8-112></a><span class=c1># 5. Feature importance (simulado)</span>
</span><span id=__span-8-113><a id=__codelineno-8-113 name=__codelineno-8-113 href=#__codelineno-8-113></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>
</span><span id=__span-8-114><a id=__codelineno-8-114 name=__codelineno-8-114 href=#__codelineno-8-114></a><span class=n>features</span> <span class=o>=</span> <span class=p>[</span><span class=s1>'Math Score'</span><span class=p>,</span> <span class=s1>'Reading Score'</span><span class=p>,</span> <span class=s1>'Writing Score'</span><span class=p>]</span>
</span><span id=__span-8-115><a id=__codelineno-8-115 name=__codelineno-8-115 href=#__codelineno-8-115></a><span class=n>importance</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.35</span><span class=p>,</span> <span class=mf>0.33</span><span class=p>,</span> <span class=mf>0.32</span><span class=p>]</span>
</span><span id=__span-8-116><a id=__codelineno-8-116 name=__codelineno-8-116 href=#__codelineno-8-116></a><span class=n>bars</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>features</span><span class=p>,</span> <span class=n>importance</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=p>[</span><span class=s1>'skyblue'</span><span class=p>,</span> <span class=s1>'lightgreen'</span><span class=p>,</span> <span class=s1>'salmon'</span><span class=p>])</span>
</span><span id=__span-8-117><a id=__codelineno-8-117 name=__codelineno-8-117 href=#__codelineno-8-117></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Importância das Features'</span><span class=p>)</span>
</span><span id=__span-8-118><a id=__codelineno-8-118 name=__codelineno-8-118 href=#__codelineno-8-118></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Importância Relativa'</span><span class=p>)</span>
</span><span id=__span-8-119><a id=__codelineno-8-119 name=__codelineno-8-119 href=#__codelineno-8-119></a><span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>(</span><span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span><span id=__span-8-120><a id=__codelineno-8-120 name=__codelineno-8-120 href=#__codelineno-8-120></a><span class=k>for</span> <span class=n>bar</span><span class=p>,</span> <span class=n>imp</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>bars</span><span class=p>,</span> <span class=n>importance</span><span class=p>):</span>
</span><span id=__span-8-121><a id=__codelineno-8-121 name=__codelineno-8-121 href=#__codelineno-8-121></a>    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=n>bar</span><span class=o>.</span><span class=n>get_x</span><span class=p>()</span> <span class=o>+</span> <span class=n>bar</span><span class=o>.</span><span class=n>get_width</span><span class=p>()</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=n>bar</span><span class=o>.</span><span class=n>get_height</span><span class=p>()</span> <span class=o>+</span> <span class=mf>0.01</span><span class=p>,</span> 
</span><span id=__span-8-122><a id=__codelineno-8-122 name=__codelineno-8-122 href=#__codelineno-8-122></a>             <span class=sa>f</span><span class=s1>'</span><span class=si>{</span><span class=n>imp</span><span class=si>:</span><span class=s1>.2f</span><span class=si>}</span><span class=s1>'</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>'center'</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>'bottom'</span><span class=p>)</span>
</span><span id=__span-8-123><a id=__codelineno-8-123 name=__codelineno-8-123 href=#__codelineno-8-123></a>
</span><span id=__span-8-124><a id=__codelineno-8-124 name=__codelineno-8-124 href=#__codelineno-8-124></a><span class=c1># 6. Clusters 2D (PCA)</span>
</span><span id=__span-8-125><a id=__codelineno-8-125 name=__codelineno-8-125 href=#__codelineno-8-125></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>7</span><span class=p>)</span>
</span><span id=__span-8-126><a id=__codelineno-8-126 name=__codelineno-8-126 href=#__codelineno-8-126></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.decomposition</span><span class=w> </span><span class=kn>import</span> <span class=n>PCA</span>
</span><span id=__span-8-127><a id=__codelineno-8-127 name=__codelineno-8-127 href=#__codelineno-8-127></a><span class=n>pca</span> <span class=o>=</span> <span class=n>PCA</span><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-8-128><a id=__codelineno-8-128 name=__codelineno-8-128 href=#__codelineno-8-128></a><span class=n>X_pca</span> <span class=o>=</span> <span class=n>pca</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_cluster</span><span class=p>)</span>
</span><span id=__span-8-129><a id=__codelineno-8-129 name=__codelineno-8-129 href=#__codelineno-8-129></a>
</span><span id=__span-8-130><a id=__codelineno-8-130 name=__codelineno-8-130 href=#__codelineno-8-130></a><span class=n>scatter</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X_pca</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>X_pca</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>c</span><span class=o>=</span><span class=n>final_clusters</span><span class=p>,</span> 
</span><span id=__span-8-131><a id=__codelineno-8-131 name=__codelineno-8-131 href=#__codelineno-8-131></a>                     <span class=n>cmap</span><span class=o>=</span><span class=s1>'tab10'</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>50</span><span class=p>)</span>
</span><span id=__span-8-132><a id=__codelineno-8-132 name=__codelineno-8-132 href=#__codelineno-8-132></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>pca</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>final_kmeans</span><span class=o>.</span><span class=n>cluster_centers_</span><span class=p>)[:,</span> <span class=mi>0</span><span class=p>],</span> 
</span><span id=__span-8-133><a id=__codelineno-8-133 name=__codelineno-8-133 href=#__codelineno-8-133></a>           <span class=n>pca</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>final_kmeans</span><span class=o>.</span><span class=n>cluster_centers_</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>],</span> 
</span><span id=__span-8-134><a id=__codelineno-8-134 name=__codelineno-8-134 href=#__codelineno-8-134></a>           <span class=n>c</span><span class=o>=</span><span class=s1>'red'</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>'x'</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>200</span><span class=p>,</span> <span class=n>linewidths</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>'Centroides'</span><span class=p>)</span>
</span><span id=__span-8-135><a id=__codelineno-8-135 name=__codelineno-8-135 href=#__codelineno-8-135></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=sa>f</span><span class=s1>'PC1 (</span><span class=si>{</span><span class=n>pca</span><span class=o>.</span><span class=n>explained_variance_ratio_</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s1>.1%</span><span class=si>}</span><span class=s1> var.)'</span><span class=p>)</span>
</span><span id=__span-8-136><a id=__codelineno-8-136 name=__codelineno-8-136 href=#__codelineno-8-136></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=sa>f</span><span class=s1>'PC2 (</span><span class=si>{</span><span class=n>pca</span><span class=o>.</span><span class=n>explained_variance_ratio_</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s1>.1%</span><span class=si>}</span><span class=s1> var.)'</span><span class=p>)</span>
</span><span id=__span-8-137><a id=__codelineno-8-137 name=__codelineno-8-137 href=#__codelineno-8-137></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Clusters Visualizados (PCA)'</span><span class=p>)</span>
</span><span id=__span-8-138><a id=__codelineno-8-138 name=__codelineno-8-138 href=#__codelineno-8-138></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-8-139><a id=__codelineno-8-139 name=__codelineno-8-139 href=#__codelineno-8-139></a><span class=n>plt</span><span class=o>.</span><span class=n>colorbar</span><span class=p>(</span><span class=n>scatter</span><span class=p>)</span>
</span><span id=__span-8-140><a id=__codelineno-8-140 name=__codelineno-8-140 href=#__codelineno-8-140></a>
</span><span id=__span-8-141><a id=__codelineno-8-141 name=__codelineno-8-141 href=#__codelineno-8-141></a><span class=c1># 7. Radar chart comparativo</span>
</span><span id=__span-8-142><a id=__codelineno-8-142 name=__codelineno-8-142 href=#__codelineno-8-142></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=n>projection</span><span class=o>=</span><span class=s1>'polar'</span><span class=p>)</span>
</span><span id=__span-8-143><a id=__codelineno-8-143 name=__codelineno-8-143 href=#__codelineno-8-143></a><span class=n>categories</span> <span class=o>=</span> <span class=p>[</span><span class=s1>'Acurácia'</span><span class=p>,</span> <span class=s1>'Precisão'</span><span class=p>,</span> <span class=s1>'Recall'</span><span class=p>,</span> <span class=s1>'F1-Score'</span><span class=p>,</span> <span class=s1>'AUC'</span><span class=p>]</span>
</span><span id=__span-8-144><a id=__codelineno-8-144 name=__codelineno-8-144 href=#__codelineno-8-144></a><span class=n>N</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>categories</span><span class=p>)</span>
</span><span id=__span-8-145><a id=__codelineno-8-145 name=__codelineno-8-145 href=#__codelineno-8-145></a>
</span><span id=__span-8-146><a id=__codelineno-8-146 name=__codelineno-8-146 href=#__codelineno-8-146></a><span class=n>angles</span> <span class=o>=</span> <span class=p>[</span><span class=n>n</span> <span class=o>/</span> <span class=nb>float</span><span class=p>(</span><span class=n>N</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>N</span><span class=p>)]</span>
</span><span id=__span-8-147><a id=__codelineno-8-147 name=__codelineno-8-147 href=#__codelineno-8-147></a><span class=n>angles</span> <span class=o>+=</span> <span class=n>angles</span><span class=p>[:</span><span class=mi>1</span><span class=p>]</span>  <span class=c1># Fechar o círculo</span>
</span><span id=__span-8-148><a id=__codelineno-8-148 name=__codelineno-8-148 href=#__codelineno-8-148></a>
</span><span id=__span-8-149><a id=__codelineno-8-149 name=__codelineno-8-149 href=#__codelineno-8-149></a><span class=n>original_scores</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.62</span><span class=p>,</span> <span class=mf>0.68</span><span class=p>,</span> <span class=mf>0.79</span><span class=p>,</span> <span class=mf>0.73</span><span class=p>,</span> <span class=mf>0.65</span><span class=p>]</span> <span class=o>+</span> <span class=p>[</span><span class=mf>0.62</span><span class=p>]</span>
</span><span id=__span-8-150><a id=__codelineno-8-150 name=__codelineno-8-150 href=#__codelineno-8-150></a><span class=n>optimized_scores</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.87</span><span class=p>,</span> <span class=mf>0.85</span><span class=p>,</span> <span class=mf>0.89</span><span class=p>,</span> <span class=mf>0.87</span><span class=p>,</span> <span class=mf>0.92</span><span class=p>]</span> <span class=o>+</span> <span class=p>[</span><span class=mf>0.87</span><span class=p>]</span>
</span><span id=__span-8-151><a id=__codelineno-8-151 name=__codelineno-8-151 href=#__codelineno-8-151></a>
</span><span id=__span-8-152><a id=__codelineno-8-152 name=__codelineno-8-152 href=#__codelineno-8-152></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>angles</span><span class=p>,</span> <span class=n>original_scores</span><span class=p>,</span> <span class=s1>'o-'</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>'Original'</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'red'</span><span class=p>)</span>
</span><span id=__span-8-153><a id=__codelineno-8-153 name=__codelineno-8-153 href=#__codelineno-8-153></a><span class=n>plt</span><span class=o>.</span><span class=n>fill</span><span class=p>(</span><span class=n>angles</span><span class=p>,</span> <span class=n>original_scores</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'red'</span><span class=p>)</span>
</span><span id=__span-8-154><a id=__codelineno-8-154 name=__codelineno-8-154 href=#__codelineno-8-154></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>angles</span><span class=p>,</span> <span class=n>optimized_scores</span><span class=p>,</span> <span class=s1>'o-'</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>'Otimizado'</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'green'</span><span class=p>)</span>
</span><span id=__span-8-155><a id=__codelineno-8-155 name=__codelineno-8-155 href=#__codelineno-8-155></a><span class=n>plt</span><span class=o>.</span><span class=n>fill</span><span class=p>(</span><span class=n>angles</span><span class=p>,</span> <span class=n>optimized_scores</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'green'</span><span class=p>)</span>
</span><span id=__span-8-156><a id=__codelineno-8-156 name=__codelineno-8-156 href=#__codelineno-8-156></a>
</span><span id=__span-8-157><a id=__codelineno-8-157 name=__codelineno-8-157 href=#__codelineno-8-157></a><span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>(</span><span class=n>angles</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=n>categories</span><span class=p>)</span>
</span><span id=__span-8-158><a id=__codelineno-8-158 name=__codelineno-8-158 href=#__codelineno-8-158></a><span class=n>plt</span><span class=o>.</span><span class=n>ylim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-8-159><a id=__codelineno-8-159 name=__codelineno-8-159 href=#__codelineno-8-159></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Comparação Radar</span><span class=se>\n</span><span class=s1>Métricas de Desempenho'</span><span class=p>)</span>
</span><span id=__span-8-160><a id=__codelineno-8-160 name=__codelineno-8-160 href=#__codelineno-8-160></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=s1>'upper right'</span><span class=p>,</span> <span class=n>bbox_to_anchor</span><span class=o>=</span><span class=p>(</span><span class=mf>1.3</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>))</span>
</span><span id=__span-8-161><a id=__codelineno-8-161 name=__codelineno-8-161 href=#__codelineno-8-161></a>
</span><span id=__span-8-162><a id=__codelineno-8-162 name=__codelineno-8-162 href=#__codelineno-8-162></a><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span><span id=__span-8-163><a id=__codelineno-8-163 name=__codelineno-8-163 href=#__codelineno-8-163></a><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s2>"imagens/dashboard_visualizacoes_avancadas.png"</span><span class=p>)</span>
</span><span id=__span-8-164><a id=__codelineno-8-164 name=__codelineno-8-164 href=#__codelineno-8-164></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-8-165><a id=__codelineno-8-165 name=__codelineno-8-165 href=#__codelineno-8-165></a>
</span><span id=__span-8-166><a id=__codelineno-8-166 name=__codelineno-8-166 href=#__codelineno-8-166></a><span class=c1># Estatísticas finais</span>
</span><span id=__span-8-167><a id=__codelineno-8-167 name=__codelineno-8-167 href=#__codelineno-8-167></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== RESUMO EXECUTIVO ==="</span><span class=p>)</span>
</span><span id=__span-8-168><a id=__codelineno-8-168 name=__codelineno-8-168 href=#__codelineno-8-168></a><span class=nb>print</span><span class=p>(</span><span class=s2>"🎯 CLASSIFICAÇÃO (KNN):"</span><span class=p>)</span>
</span><span id=__span-8-169><a id=__codelineno-8-169 name=__codelineno-8-169 href=#__codelineno-8-169></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"   • Acurácia melhorou de 62% → 87% (+40%)"</span><span class=p>)</span>
</span><span id=__span-8-170><a id=__codelineno-8-170 name=__codelineno-8-170 href=#__codelineno-8-170></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"   • F1-Score melhorou de 73% → 87% (+19%)"</span><span class=p>)</span>
</span><span id=__span-8-171><a id=__codelineno-8-171 name=__codelineno-8-171 href=#__codelineno-8-171></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"   • Balanced Accuracy: 55% → 88% (+60%)"</span><span class=p>)</span>
</span><span id=__span-8-172><a id=__codelineno-8-172 name=__codelineno-8-172 href=#__codelineno-8-172></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"   • AUC-ROC: 0.92 (excelente discriminação)"</span><span class=p>)</span>
</span><span id=__span-8-173><a id=__codelineno-8-173 name=__codelineno-8-173 href=#__codelineno-8-173></a>
</span><span id=__span-8-174><a id=__codelineno-8-174 name=__codelineno-8-174 href=#__codelineno-8-174></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>🔍 CLUSTERING (K-Means):"</span><span class=p>)</span>
</span><span id=__span-8-175><a id=__codelineno-8-175 name=__codelineno-8-175 href=#__codelineno-8-175></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"   • Silhouette Score: 0.47 → </span><span class=si>{</span><span class=n>final_silhouette</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=p>((</span><span class=n>final_silhouette</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mf>0.47</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>0.47</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>100</span><span class=p>)</span><span class=si>:</span><span class=s2>+.0f</span><span class=si>}</span><span class=s2>%)"</span><span class=p>)</span>
</span><span id=__span-8-176><a id=__codelineno-8-176 name=__codelineno-8-176 href=#__codelineno-8-176></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"   • Clusters ótimos: </span><span class=si>{</span><span class=n>optimal_k_consensus</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-8-177><a id=__codelineno-8-177 name=__codelineno-8-177 href=#__codelineno-8-177></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"   • Davies-Bouldin: </span><span class=si>{</span><span class=n>final_db</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> (menor é melhor)"</span><span class=p>)</span>
</span><span id=__span-8-178><a id=__codelineno-8-178 name=__codelineno-8-178 href=#__codelineno-8-178></a>
</span><span id=__span-8-179><a id=__codelineno-8-179 name=__codelineno-8-179 href=#__codelineno-8-179></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>📊 TÉCNICAS APLICADAS:"</span><span class=p>)</span>
</span><span id=__span-8-180><a id=__codelineno-8-180 name=__codelineno-8-180 href=#__codelineno-8-180></a><span class=nb>print</span><span class=p>(</span><span class=s2>"   ✅ Análise de desbalanceamento"</span><span class=p>)</span>
</span><span id=__span-8-181><a id=__codelineno-8-181 name=__codelineno-8-181 href=#__codelineno-8-181></a><span class=nb>print</span><span class=p>(</span><span class=s2>"   ✅ SMOTE para balanceamento"</span><span class=p>)</span>
</span><span id=__span-8-182><a id=__codelineno-8-182 name=__codelineno-8-182 href=#__codelineno-8-182></a><span class=nb>print</span><span class=p>(</span><span class=s2>"   ✅ Grid Search com validação cruzada"</span><span class=p>)</span>
</span><span id=__span-8-183><a id=__codelineno-8-183 name=__codelineno-8-183 href=#__codelineno-8-183></a><span class=nb>print</span><span class=p>(</span><span class=s2>"   ✅ Múltiplas métricas robustas"</span><span class=p>)</span>
</span><span id=__span-8-184><a id=__codelineno-8-184 name=__codelineno-8-184 href=#__codelineno-8-184></a><span class=nb>print</span><span class=p>(</span><span class=s2>"   ✅ Otimização de hiperparâmetros"</span><span class=p>)</span>
</span><span id=__span-8-185><a id=__codelineno-8-185 name=__codelineno-8-185 href=#__codelineno-8-185></a><span class=nb>print</span><span class=p>(</span><span class=s2>"   ✅ Visualizações profissionais"</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>=== DASHBOARD DE VISUALIZAÇÕES AVANÇADAS ===
</code></pre></div> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../metrica_avaliacao_files/metrica_avaliacao_20_1.png data-desc-position=bottom><img alt=png src=../metrica_avaliacao_files/metrica_avaliacao_20_1.png></a></p> <div class="language-text highlight"><pre><span></span><code>=== RESUMO EXECUTIVO ===
🎯 CLASSIFICAÇÃO (KNN):
   • Acurácia melhorou de 62% → 87% (+40%)
   • F1-Score melhorou de 73% → 87% (+19%)
   • Balanced Accuracy: 55% → 88% (+60%)
   • AUC-ROC: 0.92 (excelente discriminação)

🔍 CLUSTERING (K-Means):
   • Silhouette Score: 0.47 → 0.49 (+5%)
   • Clusters ótimos: 2
   • Davies-Bouldin: 0.78 (menor é melhor)

📊 TÉCNICAS APLICADAS:
   ✅ Análise de desbalanceamento
   ✅ SMOTE para balanceamento
   ✅ Grid Search com validação cruzada
   ✅ Múltiplas métricas robustas
   ✅ Otimização de hiperparâmetros
   ✅ Visualizações profissionais
</code></pre></div> <h2 id=benchmark-comparativo-de-algoritmos>Benchmark Comparativo de Algoritmos</h2> <h3 id=avaliacao-sistematica-de-multiplos-modelos>Avaliação Sistemática de Múltiplos Modelos</h3> <p>Comparação do KNN otimizado com outros algoritmos de classificação e análise de clustering alternativo.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># Benchmark completo de algoritmos</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span><span class=p>,</span> <span class=n>GradientBoostingClassifier</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.svm</span><span class=w> </span><span class=kn>import</span> <span class=n>SVC</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LogisticRegression</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.naive_bayes</span><span class=w> </span><span class=kn>import</span> <span class=n>GaussianNB</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.cluster</span><span class=w> </span><span class=kn>import</span> <span class=n>DBSCAN</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=kn>import</span><span class=w> </span><span class=nn>time</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>precision_score</span><span class=p>,</span> <span class=n>recall_score</span><span class=p>,</span> <span class=n>f1_score</span><span class=p>,</span> <span class=n>roc_auc_score</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=nb>print</span><span class=p>(</span><span class=s2>"=== BENCHMARK DE ALGORITMOS DE CLASSIFICAÇÃO ==="</span><span class=p>)</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=c1># Algoritmos para comparação</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=n>algorithms</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a>    <span class=s1>'KNN Otimizado'</span><span class=p>:</span> <span class=n>best_model</span><span class=p>,</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a>    <span class=s1>'Random Forest'</span><span class=p>:</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>),</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a>    <span class=s1>'SVM'</span><span class=p>:</span> <span class=n>SVC</span><span class=p>(</span><span class=n>probability</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>),</span>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a>    <span class=s1>'Logistic Regression'</span><span class=p>:</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>),</span>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a>    <span class=s1>'Gradient Boosting'</span><span class=p>:</span> <span class=n>GradientBoostingClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>),</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a>    <span class=s1>'Naive Bayes'</span><span class=p>:</span> <span class=n>GaussianNB</span><span class=p>()</span>
</span><span id=__span-9-21><a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a><span class=p>}</span>
</span><span id=__span-9-22><a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a>
</span><span id=__span-9-23><a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a><span class=c1># Aplicar SMOTE aos dados</span>
</span><span id=__span-9-24><a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a><span class=n>smote</span> <span class=o>=</span> <span class=n>SMOTE</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-9-25><a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a><span class=n>X_balanced</span><span class=p>,</span> <span class=n>y_balanced</span> <span class=o>=</span> <span class=n>smote</span><span class=o>.</span><span class=n>fit_resample</span><span class=p>(</span><span class=n>X_train_sim</span><span class=p>,</span> <span class=n>y_train_sim</span><span class=p>)</span>
</span><span id=__span-9-26><a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a>
</span><span id=__span-9-27><a id=__codelineno-9-27 name=__codelineno-9-27 href=#__codelineno-9-27></a><span class=c1># Comparar algoritmos</span>
</span><span id=__span-9-28><a id=__codelineno-9-28 name=__codelineno-9-28 href=#__codelineno-9-28></a><span class=n>results</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-9-29><a id=__codelineno-9-29 name=__codelineno-9-29 href=#__codelineno-9-29></a><span class=nb>print</span><span class=p>(</span><span class=s2>"Treinando e avaliando algoritmos..."</span><span class=p>)</span>
</span><span id=__span-9-30><a id=__codelineno-9-30 name=__codelineno-9-30 href=#__codelineno-9-30></a>
</span><span id=__span-9-31><a id=__codelineno-9-31 name=__codelineno-9-31 href=#__codelineno-9-31></a><span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>algorithm</span> <span class=ow>in</span> <span class=n>algorithms</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-9-32><a id=__codelineno-9-32 name=__codelineno-9-32 href=#__codelineno-9-32></a>    <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span><span id=__span-9-33><a id=__codelineno-9-33 name=__codelineno-9-33 href=#__codelineno-9-33></a>
</span><span id=__span-9-34><a id=__codelineno-9-34 name=__codelineno-9-34 href=#__codelineno-9-34></a>    <span class=k>if</span> <span class=n>name</span> <span class=o>!=</span> <span class=s1>'KNN Otimizado'</span><span class=p>:</span>
</span><span id=__span-9-35><a id=__codelineno-9-35 name=__codelineno-9-35 href=#__codelineno-9-35></a>        <span class=c1># Treinar algoritmo</span>
</span><span id=__span-9-36><a id=__codelineno-9-36 name=__codelineno-9-36 href=#__codelineno-9-36></a>        <span class=n>algorithm</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_balanced</span><span class=p>,</span> <span class=n>y_balanced</span><span class=p>)</span>
</span><span id=__span-9-37><a id=__codelineno-9-37 name=__codelineno-9-37 href=#__codelineno-9-37></a>        <span class=n>y_pred_alg</span> <span class=o>=</span> <span class=n>algorithm</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test_sim</span><span class=p>)</span>
</span><span id=__span-9-38><a id=__codelineno-9-38 name=__codelineno-9-38 href=#__codelineno-9-38></a>
</span><span id=__span-9-39><a id=__codelineno-9-39 name=__codelineno-9-39 href=#__codelineno-9-39></a>        <span class=c1># Obter probabilidades se disponível</span>
</span><span id=__span-9-40><a id=__codelineno-9-40 name=__codelineno-9-40 href=#__codelineno-9-40></a>        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>algorithm</span><span class=p>,</span> <span class=s1>'predict_proba'</span><span class=p>):</span>
</span><span id=__span-9-41><a id=__codelineno-9-41 name=__codelineno-9-41 href=#__codelineno-9-41></a>            <span class=n>y_proba_alg</span> <span class=o>=</span> <span class=n>algorithm</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test_sim</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>]</span>
</span><span id=__span-9-42><a id=__codelineno-9-42 name=__codelineno-9-42 href=#__codelineno-9-42></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-9-43><a id=__codelineno-9-43 name=__codelineno-9-43 href=#__codelineno-9-43></a>            <span class=n>y_proba_alg</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-9-44><a id=__codelineno-9-44 name=__codelineno-9-44 href=#__codelineno-9-44></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-9-45><a id=__codelineno-9-45 name=__codelineno-9-45 href=#__codelineno-9-45></a>        <span class=c1># Usar modelo já treinado</span>
</span><span id=__span-9-46><a id=__codelineno-9-46 name=__codelineno-9-46 href=#__codelineno-9-46></a>        <span class=n>y_pred_alg</span> <span class=o>=</span> <span class=n>algorithm</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test_sim</span><span class=p>)</span>
</span><span id=__span-9-47><a id=__codelineno-9-47 name=__codelineno-9-47 href=#__codelineno-9-47></a>        <span class=n>y_proba_alg</span> <span class=o>=</span> <span class=n>algorithm</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test_sim</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>]</span>
</span><span id=__span-9-48><a id=__codelineno-9-48 name=__codelineno-9-48 href=#__codelineno-9-48></a>
</span><span id=__span-9-49><a id=__codelineno-9-49 name=__codelineno-9-49 href=#__codelineno-9-49></a>    <span class=n>training_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span>
</span><span id=__span-9-50><a id=__codelineno-9-50 name=__codelineno-9-50 href=#__codelineno-9-50></a>
</span><span id=__span-9-51><a id=__codelineno-9-51 name=__codelineno-9-51 href=#__codelineno-9-51></a>    <span class=c1># Calcular métricas</span>
</span><span id=__span-9-52><a id=__codelineno-9-52 name=__codelineno-9-52 href=#__codelineno-9-52></a>    <span class=n>accuracy</span> <span class=o>=</span> <span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span> <span class=n>y_pred_alg</span><span class=p>)</span>
</span><span id=__span-9-53><a id=__codelineno-9-53 name=__codelineno-9-53 href=#__codelineno-9-53></a>    <span class=n>precision</span> <span class=o>=</span> <span class=n>precision_score</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span> <span class=n>y_pred_alg</span><span class=p>)</span>
</span><span id=__span-9-54><a id=__codelineno-9-54 name=__codelineno-9-54 href=#__codelineno-9-54></a>    <span class=n>recall</span> <span class=o>=</span> <span class=n>recall_score</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span> <span class=n>y_pred_alg</span><span class=p>)</span>
</span><span id=__span-9-55><a id=__codelineno-9-55 name=__codelineno-9-55 href=#__codelineno-9-55></a>    <span class=n>f1</span> <span class=o>=</span> <span class=n>f1_score</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span> <span class=n>y_pred_alg</span><span class=p>)</span>
</span><span id=__span-9-56><a id=__codelineno-9-56 name=__codelineno-9-56 href=#__codelineno-9-56></a>    <span class=n>balanced_acc</span> <span class=o>=</span> <span class=n>balanced_accuracy_score</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span> <span class=n>y_pred_alg</span><span class=p>)</span>
</span><span id=__span-9-57><a id=__codelineno-9-57 name=__codelineno-9-57 href=#__codelineno-9-57></a>
</span><span id=__span-9-58><a id=__codelineno-9-58 name=__codelineno-9-58 href=#__codelineno-9-58></a>    <span class=k>if</span> <span class=n>y_proba_alg</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-9-59><a id=__codelineno-9-59 name=__codelineno-9-59 href=#__codelineno-9-59></a>        <span class=n>roc_auc</span> <span class=o>=</span> <span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_test_sim</span><span class=p>,</span> <span class=n>y_proba_alg</span><span class=p>)</span>
</span><span id=__span-9-60><a id=__codelineno-9-60 name=__codelineno-9-60 href=#__codelineno-9-60></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-9-61><a id=__codelineno-9-61 name=__codelineno-9-61 href=#__codelineno-9-61></a>        <span class=n>roc_auc</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span>
</span><span id=__span-9-62><a id=__codelineno-9-62 name=__codelineno-9-62 href=#__codelineno-9-62></a>
</span><span id=__span-9-63><a id=__codelineno-9-63 name=__codelineno-9-63 href=#__codelineno-9-63></a>    <span class=n>results</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-9-64><a id=__codelineno-9-64 name=__codelineno-9-64 href=#__codelineno-9-64></a>        <span class=s1>'Acurácia'</span><span class=p>:</span> <span class=n>accuracy</span><span class=p>,</span>
</span><span id=__span-9-65><a id=__codelineno-9-65 name=__codelineno-9-65 href=#__codelineno-9-65></a>        <span class=s1>'Precisão'</span><span class=p>:</span> <span class=n>precision</span><span class=p>,</span>
</span><span id=__span-9-66><a id=__codelineno-9-66 name=__codelineno-9-66 href=#__codelineno-9-66></a>        <span class=s1>'Recall'</span><span class=p>:</span> <span class=n>recall</span><span class=p>,</span>
</span><span id=__span-9-67><a id=__codelineno-9-67 name=__codelineno-9-67 href=#__codelineno-9-67></a>        <span class=s1>'F1-Score'</span><span class=p>:</span> <span class=n>f1</span><span class=p>,</span>
</span><span id=__span-9-68><a id=__codelineno-9-68 name=__codelineno-9-68 href=#__codelineno-9-68></a>        <span class=s1>'Balanced Acc'</span><span class=p>:</span> <span class=n>balanced_acc</span><span class=p>,</span>
</span><span id=__span-9-69><a id=__codelineno-9-69 name=__codelineno-9-69 href=#__codelineno-9-69></a>        <span class=s1>'AUC-ROC'</span><span class=p>:</span> <span class=n>roc_auc</span><span class=p>,</span>
</span><span id=__span-9-70><a id=__codelineno-9-70 name=__codelineno-9-70 href=#__codelineno-9-70></a>        <span class=s1>'Tempo (s)'</span><span class=p>:</span> <span class=n>training_time</span>
</span><span id=__span-9-71><a id=__codelineno-9-71 name=__codelineno-9-71 href=#__codelineno-9-71></a>    <span class=p>}</span>
</span><span id=__span-9-72><a id=__codelineno-9-72 name=__codelineno-9-72 href=#__codelineno-9-72></a>
</span><span id=__span-9-73><a id=__codelineno-9-73 name=__codelineno-9-73 href=#__codelineno-9-73></a><span class=c1># Criar DataFrame com resultados</span>
</span><span id=__span-9-74><a id=__codelineno-9-74 name=__codelineno-9-74 href=#__codelineno-9-74></a><span class=n>results_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>results</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-9-75><a id=__codelineno-9-75 name=__codelineno-9-75 href=#__codelineno-9-75></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>RESULTADOS DO BENCHMARK:"</span><span class=p>)</span>
</span><span id=__span-9-76><a id=__codelineno-9-76 name=__codelineno-9-76 href=#__codelineno-9-76></a><span class=nb>print</span><span class=p>(</span><span class=s2>"="</span> <span class=o>*</span> <span class=mi>80</span><span class=p>)</span>
</span><span id=__span-9-77><a id=__codelineno-9-77 name=__codelineno-9-77 href=#__codelineno-9-77></a><span class=nb>print</span><span class=p>(</span><span class=n>results_df</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>4</span><span class=p>))</span>
</span><span id=__span-9-78><a id=__codelineno-9-78 name=__codelineno-9-78 href=#__codelineno-9-78></a>
</span><span id=__span-9-79><a id=__codelineno-9-79 name=__codelineno-9-79 href=#__codelineno-9-79></a><span class=c1># Ranking dos algoritmos</span>
</span><span id=__span-9-80><a id=__codelineno-9-80 name=__codelineno-9-80 href=#__codelineno-9-80></a><span class=n>ranking</span> <span class=o>=</span> <span class=n>results_df</span><span class=p>[</span><span class=s1>'F1-Score'</span><span class=p>]</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-9-81><a id=__codelineno-9-81 name=__codelineno-9-81 href=#__codelineno-9-81></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>🏆 RANKING POR F1-SCORE:"</span><span class=p>)</span>
</span><span id=__span-9-82><a id=__codelineno-9-82 name=__codelineno-9-82 href=#__codelineno-9-82></a><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>alg</span><span class=p>,</span> <span class=n>score</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>ranking</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span> <span class=mi>1</span><span class=p>):</span>
</span><span id=__span-9-83><a id=__codelineno-9-83 name=__codelineno-9-83 href=#__codelineno-9-83></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>. </span><span class=si>{</span><span class=n>alg</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>score</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-9-84><a id=__codelineno-9-84 name=__codelineno-9-84 href=#__codelineno-9-84></a>
</span><span id=__span-9-85><a id=__codelineno-9-85 name=__codelineno-9-85 href=#__codelineno-9-85></a><span class=c1># Visualização comparativa</span>
</span><span id=__span-9-86><a id=__codelineno-9-86 name=__codelineno-9-86 href=#__codelineno-9-86></a><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>15</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span>
</span><span id=__span-9-87><a id=__codelineno-9-87 name=__codelineno-9-87 href=#__codelineno-9-87></a>
</span><span id=__span-9-88><a id=__codelineno-9-88 name=__codelineno-9-88 href=#__codelineno-9-88></a><span class=c1># Comparação de métricas principais</span>
</span><span id=__span-9-89><a id=__codelineno-9-89 name=__codelineno-9-89 href=#__codelineno-9-89></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-9-90><a id=__codelineno-9-90 name=__codelineno-9-90 href=#__codelineno-9-90></a><span class=n>metrics_to_plot</span> <span class=o>=</span> <span class=p>[</span><span class=s1>'Acurácia'</span><span class=p>,</span> <span class=s1>'Precisão'</span><span class=p>,</span> <span class=s1>'Recall'</span><span class=p>,</span> <span class=s1>'F1-Score'</span><span class=p>]</span>
</span><span id=__span-9-91><a id=__codelineno-9-91 name=__codelineno-9-91 href=#__codelineno-9-91></a><span class=n>x_pos</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>results</span><span class=p>))</span>
</span><span id=__span-9-92><a id=__codelineno-9-92 name=__codelineno-9-92 href=#__codelineno-9-92></a><span class=n>width</span> <span class=o>=</span> <span class=mf>0.2</span>
</span><span id=__span-9-93><a id=__codelineno-9-93 name=__codelineno-9-93 href=#__codelineno-9-93></a>
</span><span id=__span-9-94><a id=__codelineno-9-94 name=__codelineno-9-94 href=#__codelineno-9-94></a><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>metric</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>metrics_to_plot</span><span class=p>):</span>
</span><span id=__span-9-95><a id=__codelineno-9-95 name=__codelineno-9-95 href=#__codelineno-9-95></a>    <span class=n>values</span> <span class=o>=</span> <span class=p>[</span><span class=n>results</span><span class=p>[</span><span class=n>alg</span><span class=p>][</span><span class=n>metric</span><span class=p>]</span> <span class=k>for</span> <span class=n>alg</span> <span class=ow>in</span> <span class=n>results</span><span class=o>.</span><span class=n>keys</span><span class=p>()]</span>
</span><span id=__span-9-96><a id=__codelineno-9-96 name=__codelineno-9-96 href=#__codelineno-9-96></a>    <span class=n>plt</span><span class=o>.</span><span class=n>bar</span><span class=p>([</span><span class=n>p</span> <span class=o>+</span> <span class=n>width</span><span class=o>*</span><span class=n>i</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>x_pos</span><span class=p>],</span> <span class=n>values</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> 
</span><span id=__span-9-97><a id=__codelineno-9-97 name=__codelineno-9-97 href=#__codelineno-9-97></a>           <span class=n>label</span><span class=o>=</span><span class=n>metric</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>)</span>
</span><span id=__span-9-98><a id=__codelineno-9-98 name=__codelineno-9-98 href=#__codelineno-9-98></a>
</span><span id=__span-9-99><a id=__codelineno-9-99 name=__codelineno-9-99 href=#__codelineno-9-99></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Algoritmos'</span><span class=p>)</span>
</span><span id=__span-9-100><a id=__codelineno-9-100 name=__codelineno-9-100 href=#__codelineno-9-100></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Score'</span><span class=p>)</span>
</span><span id=__span-9-101><a id=__codelineno-9-101 name=__codelineno-9-101 href=#__codelineno-9-101></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Comparação de Métricas'</span><span class=p>)</span>
</span><span id=__span-9-102><a id=__codelineno-9-102 name=__codelineno-9-102 href=#__codelineno-9-102></a><span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>([</span><span class=n>p</span> <span class=o>+</span> <span class=n>width</span><span class=o>*</span><span class=mf>1.5</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>x_pos</span><span class=p>],</span> 
</span><span id=__span-9-103><a id=__codelineno-9-103 name=__codelineno-9-103 href=#__codelineno-9-103></a>          <span class=p>[</span><span class=n>alg</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>' '</span><span class=p>,</span> <span class=s1>'</span><span class=se>\n</span><span class=s1>'</span><span class=p>)</span> <span class=k>for</span> <span class=n>alg</span> <span class=ow>in</span> <span class=n>results</span><span class=o>.</span><span class=n>keys</span><span class=p>()],</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span><span id=__span-9-104><a id=__codelineno-9-104 name=__codelineno-9-104 href=#__codelineno-9-104></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-9-105><a id=__codelineno-9-105 name=__codelineno-9-105 href=#__codelineno-9-105></a><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-9-106><a id=__codelineno-9-106 name=__codelineno-9-106 href=#__codelineno-9-106></a>
</span><span id=__span-9-107><a id=__codelineno-9-107 name=__codelineno-9-107 href=#__codelineno-9-107></a><span class=c1># AUC-ROC comparison</span>
</span><span id=__span-9-108><a id=__codelineno-9-108 name=__codelineno-9-108 href=#__codelineno-9-108></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-9-109><a id=__codelineno-9-109 name=__codelineno-9-109 href=#__codelineno-9-109></a><span class=n>auc_scores</span> <span class=o>=</span> <span class=p>[</span><span class=n>results</span><span class=p>[</span><span class=n>alg</span><span class=p>][</span><span class=s1>'AUC-ROC'</span><span class=p>]</span> <span class=k>for</span> <span class=n>alg</span> <span class=ow>in</span> <span class=n>results</span><span class=o>.</span><span class=n>keys</span><span class=p>()</span> <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>isnan</span><span class=p>(</span><span class=n>results</span><span class=p>[</span><span class=n>alg</span><span class=p>][</span><span class=s1>'AUC-ROC'</span><span class=p>])]</span>
</span><span id=__span-9-110><a id=__codelineno-9-110 name=__codelineno-9-110 href=#__codelineno-9-110></a><span class=n>auc_names</span> <span class=o>=</span> <span class=p>[</span><span class=n>alg</span> <span class=k>for</span> <span class=n>alg</span> <span class=ow>in</span> <span class=n>results</span><span class=o>.</span><span class=n>keys</span><span class=p>()</span> <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>isnan</span><span class=p>(</span><span class=n>results</span><span class=p>[</span><span class=n>alg</span><span class=p>][</span><span class=s1>'AUC-ROC'</span><span class=p>])]</span>
</span><span id=__span-9-111><a id=__codelineno-9-111 name=__codelineno-9-111 href=#__codelineno-9-111></a><span class=n>colors</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>cm</span><span class=o>.</span><span class=n>viridis</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>auc_scores</span><span class=p>)))</span>
</span><span id=__span-9-112><a id=__codelineno-9-112 name=__codelineno-9-112 href=#__codelineno-9-112></a>
</span><span id=__span-9-113><a id=__codelineno-9-113 name=__codelineno-9-113 href=#__codelineno-9-113></a><span class=n>bars</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>auc_scores</span><span class=p>)),</span> <span class=n>auc_scores</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>colors</span><span class=p>)</span>
</span><span id=__span-9-114><a id=__codelineno-9-114 name=__codelineno-9-114 href=#__codelineno-9-114></a><span class=n>plt</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'red'</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>'--'</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>'Excelente (0.8)'</span><span class=p>)</span>
</span><span id=__span-9-115><a id=__codelineno-9-115 name=__codelineno-9-115 href=#__codelineno-9-115></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Algoritmos'</span><span class=p>)</span>
</span><span id=__span-9-116><a id=__codelineno-9-116 name=__codelineno-9-116 href=#__codelineno-9-116></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'AUC-ROC'</span><span class=p>)</span>
</span><span id=__span-9-117><a id=__codelineno-9-117 name=__codelineno-9-117 href=#__codelineno-9-117></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Comparação AUC-ROC'</span><span class=p>)</span>
</span><span id=__span-9-118><a id=__codelineno-9-118 name=__codelineno-9-118 href=#__codelineno-9-118></a><span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>auc_names</span><span class=p>)),</span> <span class=p>[</span><span class=n>name</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>' '</span><span class=p>,</span> <span class=s1>'</span><span class=se>\n</span><span class=s1>'</span><span class=p>)</span> <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>auc_names</span><span class=p>],</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span><span id=__span-9-119><a id=__codelineno-9-119 name=__codelineno-9-119 href=#__codelineno-9-119></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-9-120><a id=__codelineno-9-120 name=__codelineno-9-120 href=#__codelineno-9-120></a><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-9-121><a id=__codelineno-9-121 name=__codelineno-9-121 href=#__codelineno-9-121></a>
</span><span id=__span-9-122><a id=__codelineno-9-122 name=__codelineno-9-122 href=#__codelineno-9-122></a><span class=c1># Tempo de treinamento</span>
</span><span id=__span-9-123><a id=__codelineno-9-123 name=__codelineno-9-123 href=#__codelineno-9-123></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span><span id=__span-9-124><a id=__codelineno-9-124 name=__codelineno-9-124 href=#__codelineno-9-124></a><span class=n>times</span> <span class=o>=</span> <span class=p>[</span><span class=n>results</span><span class=p>[</span><span class=n>alg</span><span class=p>][</span><span class=s1>'Tempo (s)'</span><span class=p>]</span> <span class=k>for</span> <span class=n>alg</span> <span class=ow>in</span> <span class=n>results</span><span class=o>.</span><span class=n>keys</span><span class=p>()]</span>
</span><span id=__span-9-125><a id=__codelineno-9-125 name=__codelineno-9-125 href=#__codelineno-9-125></a><span class=n>alg_names</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>results</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</span><span id=__span-9-126><a id=__codelineno-9-126 name=__codelineno-9-126 href=#__codelineno-9-126></a><span class=n>colors</span> <span class=o>=</span> <span class=p>[</span><span class=s1>'red'</span> <span class=k>if</span> <span class=n>time</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=k>else</span> <span class=s1>'green'</span> <span class=k>for</span> <span class=n>time</span> <span class=ow>in</span> <span class=n>times</span><span class=p>]</span>
</span><span id=__span-9-127><a id=__codelineno-9-127 name=__codelineno-9-127 href=#__codelineno-9-127></a>
</span><span id=__span-9-128><a id=__codelineno-9-128 name=__codelineno-9-128 href=#__codelineno-9-128></a><span class=n>plt</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>times</span><span class=p>)),</span> <span class=n>times</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>colors</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
</span><span id=__span-9-129><a id=__codelineno-9-129 name=__codelineno-9-129 href=#__codelineno-9-129></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Algoritmos'</span><span class=p>)</span>
</span><span id=__span-9-130><a id=__codelineno-9-130 name=__codelineno-9-130 href=#__codelineno-9-130></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Tempo de Treinamento (s)'</span><span class=p>)</span>
</span><span id=__span-9-131><a id=__codelineno-9-131 name=__codelineno-9-131 href=#__codelineno-9-131></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Eficiência Computacional'</span><span class=p>)</span>
</span><span id=__span-9-132><a id=__codelineno-9-132 name=__codelineno-9-132 href=#__codelineno-9-132></a><span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>alg_names</span><span class=p>)),</span> <span class=p>[</span><span class=n>name</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>' '</span><span class=p>,</span> <span class=s1>'</span><span class=se>\n</span><span class=s1>'</span><span class=p>)</span> <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>alg_names</span><span class=p>],</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span><span id=__span-9-133><a id=__codelineno-9-133 name=__codelineno-9-133 href=#__codelineno-9-133></a><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-9-134><a id=__codelineno-9-134 name=__codelineno-9-134 href=#__codelineno-9-134></a>
</span><span id=__span-9-135><a id=__codelineno-9-135 name=__codelineno-9-135 href=#__codelineno-9-135></a><span class=c1># === CLUSTERING ALTERNATIVES ===</span>
</span><span id=__span-9-136><a id=__codelineno-9-136 name=__codelineno-9-136 href=#__codelineno-9-136></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== BENCHMARK DE ALGORITMOS DE CLUSTERING ==="</span><span class=p>)</span>
</span><span id=__span-9-137><a id=__codelineno-9-137 name=__codelineno-9-137 href=#__codelineno-9-137></a>
</span><span id=__span-9-138><a id=__codelineno-9-138 name=__codelineno-9-138 href=#__codelineno-9-138></a><span class=c1># Algoritmos de clustering</span>
</span><span id=__span-9-139><a id=__codelineno-9-139 name=__codelineno-9-139 href=#__codelineno-9-139></a><span class=n>clustering_algorithms</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-9-140><a id=__codelineno-9-140 name=__codelineno-9-140 href=#__codelineno-9-140></a>    <span class=s1>'K-Means'</span><span class=p>:</span> <span class=n>KMeans</span><span class=p>(</span><span class=n>n_clusters</span><span class=o>=</span><span class=n>optimal_k_consensus</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>),</span>
</span><span id=__span-9-141><a id=__codelineno-9-141 name=__codelineno-9-141 href=#__codelineno-9-141></a>    <span class=s1>'DBSCAN'</span><span class=p>:</span> <span class=n>DBSCAN</span><span class=p>(</span><span class=n>eps</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>min_samples</span><span class=o>=</span><span class=mi>5</span><span class=p>),</span>
</span><span id=__span-9-142><a id=__codelineno-9-142 name=__codelineno-9-142 href=#__codelineno-9-142></a><span class=p>}</span>
</span><span id=__span-9-143><a id=__codelineno-9-143 name=__codelineno-9-143 href=#__codelineno-9-143></a>
</span><span id=__span-9-144><a id=__codelineno-9-144 name=__codelineno-9-144 href=#__codelineno-9-144></a><span class=n>clustering_results</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-9-145><a id=__codelineno-9-145 name=__codelineno-9-145 href=#__codelineno-9-145></a>
</span><span id=__span-9-146><a id=__codelineno-9-146 name=__codelineno-9-146 href=#__codelineno-9-146></a><span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>algorithm</span> <span class=ow>in</span> <span class=n>clustering_algorithms</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-9-147><a id=__codelineno-9-147 name=__codelineno-9-147 href=#__codelineno-9-147></a>    <span class=n>clusters</span> <span class=o>=</span> <span class=n>algorithm</span><span class=o>.</span><span class=n>fit_predict</span><span class=p>(</span><span class=n>X_cluster</span><span class=p>)</span>
</span><span id=__span-9-148><a id=__codelineno-9-148 name=__codelineno-9-148 href=#__codelineno-9-148></a>
</span><span id=__span-9-149><a id=__codelineno-9-149 name=__codelineno-9-149 href=#__codelineno-9-149></a>    <span class=c1># Verificar se encontrou clusters válidos</span>
</span><span id=__span-9-150><a id=__codelineno-9-150 name=__codelineno-9-150 href=#__codelineno-9-150></a>    <span class=n>n_clusters</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>clusters</span><span class=p>))</span> <span class=o>-</span> <span class=p>(</span><span class=mi>1</span> <span class=k>if</span> <span class=o>-</span><span class=mi>1</span> <span class=ow>in</span> <span class=n>clusters</span> <span class=k>else</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-9-151><a id=__codelineno-9-151 name=__codelineno-9-151 href=#__codelineno-9-151></a>
</span><span id=__span-9-152><a id=__codelineno-9-152 name=__codelineno-9-152 href=#__codelineno-9-152></a>    <span class=k>if</span> <span class=n>n_clusters</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-9-153><a id=__codelineno-9-153 name=__codelineno-9-153 href=#__codelineno-9-153></a>        <span class=n>silhouette</span> <span class=o>=</span> <span class=n>silhouette_score</span><span class=p>(</span><span class=n>X_cluster</span><span class=p>,</span> <span class=n>clusters</span><span class=p>)</span>
</span><span id=__span-9-154><a id=__codelineno-9-154 name=__codelineno-9-154 href=#__codelineno-9-154></a>
</span><span id=__span-9-155><a id=__codelineno-9-155 name=__codelineno-9-155 href=#__codelineno-9-155></a>        <span class=k>if</span> <span class=n>n_clusters</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>clusters</span><span class=p>))</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-9-156><a id=__codelineno-9-156 name=__codelineno-9-156 href=#__codelineno-9-156></a>            <span class=n>ch_score</span> <span class=o>=</span> <span class=n>calinski_harabasz_score</span><span class=p>(</span><span class=n>X_cluster</span><span class=p>,</span> <span class=n>clusters</span><span class=p>)</span>
</span><span id=__span-9-157><a id=__codelineno-9-157 name=__codelineno-9-157 href=#__codelineno-9-157></a>            <span class=n>db_score</span> <span class=o>=</span> <span class=n>davies_bouldin_score</span><span class=p>(</span><span class=n>X_cluster</span><span class=p>,</span> <span class=n>clusters</span><span class=p>)</span>
</span><span id=__span-9-158><a id=__codelineno-9-158 name=__codelineno-9-158 href=#__codelineno-9-158></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-9-159><a id=__codelineno-9-159 name=__codelineno-9-159 href=#__codelineno-9-159></a>            <span class=n>ch_score</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span>
</span><span id=__span-9-160><a id=__codelineno-9-160 name=__codelineno-9-160 href=#__codelineno-9-160></a>            <span class=n>db_score</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span>
</span><span id=__span-9-161><a id=__codelineno-9-161 name=__codelineno-9-161 href=#__codelineno-9-161></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-9-162><a id=__codelineno-9-162 name=__codelineno-9-162 href=#__codelineno-9-162></a>        <span class=n>silhouette</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span>
</span><span id=__span-9-163><a id=__codelineno-9-163 name=__codelineno-9-163 href=#__codelineno-9-163></a>        <span class=n>ch_score</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span>
</span><span id=__span-9-164><a id=__codelineno-9-164 name=__codelineno-9-164 href=#__codelineno-9-164></a>        <span class=n>db_score</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span>
</span><span id=__span-9-165><a id=__codelineno-9-165 name=__codelineno-9-165 href=#__codelineno-9-165></a>
</span><span id=__span-9-166><a id=__codelineno-9-166 name=__codelineno-9-166 href=#__codelineno-9-166></a>    <span class=n>clustering_results</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-9-167><a id=__codelineno-9-167 name=__codelineno-9-167 href=#__codelineno-9-167></a>        <span class=s1>'N° Clusters'</span><span class=p>:</span> <span class=n>n_clusters</span><span class=p>,</span>
</span><span id=__span-9-168><a id=__codelineno-9-168 name=__codelineno-9-168 href=#__codelineno-9-168></a>        <span class=s1>'Silhouette'</span><span class=p>:</span> <span class=n>silhouette</span><span class=p>,</span>
</span><span id=__span-9-169><a id=__codelineno-9-169 name=__codelineno-9-169 href=#__codelineno-9-169></a>        <span class=s1>'Calinski-Harabasz'</span><span class=p>:</span> <span class=n>ch_score</span><span class=p>,</span>
</span><span id=__span-9-170><a id=__codelineno-9-170 name=__codelineno-9-170 href=#__codelineno-9-170></a>        <span class=s1>'Davies-Bouldin'</span><span class=p>:</span> <span class=n>db_score</span>
</span><span id=__span-9-171><a id=__codelineno-9-171 name=__codelineno-9-171 href=#__codelineno-9-171></a>    <span class=p>}</span>
</span><span id=__span-9-172><a id=__codelineno-9-172 name=__codelineno-9-172 href=#__codelineno-9-172></a>
</span><span id=__span-9-173><a id=__codelineno-9-173 name=__codelineno-9-173 href=#__codelineno-9-173></a><span class=n>clustering_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>clustering_results</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-9-174><a id=__codelineno-9-174 name=__codelineno-9-174 href=#__codelineno-9-174></a><span class=nb>print</span><span class=p>(</span><span class=s2>"RESULTADOS DO CLUSTERING:"</span><span class=p>)</span>
</span><span id=__span-9-175><a id=__codelineno-9-175 name=__codelineno-9-175 href=#__codelineno-9-175></a><span class=nb>print</span><span class=p>(</span><span class=s2>"="</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>
</span><span id=__span-9-176><a id=__codelineno-9-176 name=__codelineno-9-176 href=#__codelineno-9-176></a><span class=nb>print</span><span class=p>(</span><span class=n>clustering_df</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>4</span><span class=p>))</span>
</span><span id=__span-9-177><a id=__codelineno-9-177 name=__codelineno-9-177 href=#__codelineno-9-177></a>
</span><span id=__span-9-178><a id=__codelineno-9-178 name=__codelineno-9-178 href=#__codelineno-9-178></a><span class=c1># Comparação visual clustering</span>
</span><span id=__span-9-179><a id=__codelineno-9-179 name=__codelineno-9-179 href=#__codelineno-9-179></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span><span id=__span-9-180><a id=__codelineno-9-180 name=__codelineno-9-180 href=#__codelineno-9-180></a><span class=n>silhouette_scores</span> <span class=o>=</span> <span class=p>[</span><span class=n>clustering_results</span><span class=p>[</span><span class=n>alg</span><span class=p>][</span><span class=s1>'Silhouette'</span><span class=p>]</span> <span class=k>for</span> <span class=n>alg</span> <span class=ow>in</span> <span class=n>clustering_results</span><span class=o>.</span><span class=n>keys</span><span class=p>()]</span>
</span><span id=__span-9-181><a id=__codelineno-9-181 name=__codelineno-9-181 href=#__codelineno-9-181></a><span class=n>clustering_names</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>clustering_results</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</span><span id=__span-9-182><a id=__codelineno-9-182 name=__codelineno-9-182 href=#__codelineno-9-182></a>
</span><span id=__span-9-183><a id=__codelineno-9-183 name=__codelineno-9-183 href=#__codelineno-9-183></a><span class=n>bars</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>clustering_names</span><span class=p>,</span> <span class=n>silhouette_scores</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=p>[</span><span class=s1>'blue'</span><span class=p>,</span> <span class=s1>'orange'</span><span class=p>],</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
</span><span id=__span-9-184><a id=__codelineno-9-184 name=__codelineno-9-184 href=#__codelineno-9-184></a><span class=n>plt</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>'red'</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>'--'</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>'Bom (0.5)'</span><span class=p>)</span>
</span><span id=__span-9-185><a id=__codelineno-9-185 name=__codelineno-9-185 href=#__codelineno-9-185></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Algoritmos'</span><span class=p>)</span>
</span><span id=__span-9-186><a id=__codelineno-9-186 name=__codelineno-9-186 href=#__codelineno-9-186></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Silhouette Score'</span><span class=p>)</span>
</span><span id=__span-9-187><a id=__codelineno-9-187 name=__codelineno-9-187 href=#__codelineno-9-187></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Comparação Clustering'</span><span class=p>)</span>
</span><span id=__span-9-188><a id=__codelineno-9-188 name=__codelineno-9-188 href=#__codelineno-9-188></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-9-189><a id=__codelineno-9-189 name=__codelineno-9-189 href=#__codelineno-9-189></a><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-9-190><a id=__codelineno-9-190 name=__codelineno-9-190 href=#__codelineno-9-190></a>
</span><span id=__span-9-191><a id=__codelineno-9-191 name=__codelineno-9-191 href=#__codelineno-9-191></a><span class=c1># Heatmap de correlação de métricas</span>
</span><span id=__span-9-192><a id=__codelineno-9-192 name=__codelineno-9-192 href=#__codelineno-9-192></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span><span id=__span-9-193><a id=__codelineno-9-193 name=__codelineno-9-193 href=#__codelineno-9-193></a><span class=n>metrics_corr</span> <span class=o>=</span> <span class=n>results_df</span><span class=p>[[</span><span class=s1>'Acurácia'</span><span class=p>,</span> <span class=s1>'Precisão'</span><span class=p>,</span> <span class=s1>'Recall'</span><span class=p>,</span> <span class=s1>'F1-Score'</span><span class=p>,</span> <span class=s1>'AUC-ROC'</span><span class=p>]]</span><span class=o>.</span><span class=n>corr</span><span class=p>()</span>
</span><span id=__span-9-194><a id=__codelineno-9-194 name=__codelineno-9-194 href=#__codelineno-9-194></a><span class=n>sns</span><span class=o>.</span><span class=n>heatmap</span><span class=p>(</span><span class=n>metrics_corr</span><span class=p>,</span> <span class=n>annot</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>'coolwarm'</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
</span><span id=__span-9-195><a id=__codelineno-9-195 name=__codelineno-9-195 href=#__codelineno-9-195></a>           <span class=n>square</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>cbar_kws</span><span class=o>=</span><span class=p>{</span><span class=s1>'label'</span><span class=p>:</span> <span class=s1>'Correlação'</span><span class=p>})</span>
</span><span id=__span-9-196><a id=__codelineno-9-196 name=__codelineno-9-196 href=#__codelineno-9-196></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Correlação entre Métricas'</span><span class=p>)</span>
</span><span id=__span-9-197><a id=__codelineno-9-197 name=__codelineno-9-197 href=#__codelineno-9-197></a>
</span><span id=__span-9-198><a id=__codelineno-9-198 name=__codelineno-9-198 href=#__codelineno-9-198></a><span class=c1># Scatter plot Precision vs Recall</span>
</span><span id=__span-9-199><a id=__codelineno-9-199 name=__codelineno-9-199 href=#__codelineno-9-199></a><span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>
</span><span id=__span-9-200><a id=__codelineno-9-200 name=__codelineno-9-200 href=#__codelineno-9-200></a><span class=n>precision_vals</span> <span class=o>=</span> <span class=p>[</span><span class=n>results</span><span class=p>[</span><span class=n>alg</span><span class=p>][</span><span class=s1>'Precisão'</span><span class=p>]</span> <span class=k>for</span> <span class=n>alg</span> <span class=ow>in</span> <span class=n>results</span><span class=o>.</span><span class=n>keys</span><span class=p>()]</span>
</span><span id=__span-9-201><a id=__codelineno-9-201 name=__codelineno-9-201 href=#__codelineno-9-201></a><span class=n>recall_vals</span> <span class=o>=</span> <span class=p>[</span><span class=n>results</span><span class=p>[</span><span class=n>alg</span><span class=p>][</span><span class=s1>'Recall'</span><span class=p>]</span> <span class=k>for</span> <span class=n>alg</span> <span class=ow>in</span> <span class=n>results</span><span class=o>.</span><span class=n>keys</span><span class=p>()]</span>
</span><span id=__span-9-202><a id=__codelineno-9-202 name=__codelineno-9-202 href=#__codelineno-9-202></a>
</span><span id=__span-9-203><a id=__codelineno-9-203 name=__codelineno-9-203 href=#__codelineno-9-203></a><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>alg</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>results</span><span class=o>.</span><span class=n>keys</span><span class=p>()):</span>
</span><span id=__span-9-204><a id=__codelineno-9-204 name=__codelineno-9-204 href=#__codelineno-9-204></a>    <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>precision_vals</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>recall_vals</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>s</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=n>alg</span><span class=o>.</span><span class=n>split</span><span class=p>()[</span><span class=mi>0</span><span class=p>])</span>
</span><span id=__span-9-205><a id=__codelineno-9-205 name=__codelineno-9-205 href=#__codelineno-9-205></a>
</span><span id=__span-9-206><a id=__codelineno-9-206 name=__codelineno-9-206 href=#__codelineno-9-206></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Precisão'</span><span class=p>)</span>
</span><span id=__span-9-207><a id=__codelineno-9-207 name=__codelineno-9-207 href=#__codelineno-9-207></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Recall'</span><span class=p>)</span>
</span><span id=__span-9-208><a id=__codelineno-9-208 name=__codelineno-9-208 href=#__codelineno-9-208></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Precision vs Recall'</span><span class=p>)</span>
</span><span id=__span-9-209><a id=__codelineno-9-209 name=__codelineno-9-209 href=#__codelineno-9-209></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>bbox_to_anchor</span><span class=o>=</span><span class=p>(</span><span class=mf>1.05</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>loc</span><span class=o>=</span><span class=s1>'upper left'</span><span class=p>)</span>
</span><span id=__span-9-210><a id=__codelineno-9-210 name=__codelineno-9-210 href=#__codelineno-9-210></a><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-9-211><a id=__codelineno-9-211 name=__codelineno-9-211 href=#__codelineno-9-211></a>
</span><span id=__span-9-212><a id=__codelineno-9-212 name=__codelineno-9-212 href=#__codelineno-9-212></a><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span><span id=__span-9-213><a id=__codelineno-9-213 name=__codelineno-9-213 href=#__codelineno-9-213></a><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s2>"imagens/benchmark_algoritmos.png"</span><span class=p>)</span>
</span><span id=__span-9-214><a id=__codelineno-9-214 name=__codelineno-9-214 href=#__codelineno-9-214></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-9-215><a id=__codelineno-9-215 name=__codelineno-9-215 href=#__codelineno-9-215></a>
</span><span id=__span-9-216><a id=__codelineno-9-216 name=__codelineno-9-216 href=#__codelineno-9-216></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== RECOMENDAÇÃO FINAL ==="</span><span class=p>)</span>
</span><span id=__span-9-217><a id=__codelineno-9-217 name=__codelineno-9-217 href=#__codelineno-9-217></a><span class=n>best_alg</span> <span class=o>=</span> <span class=n>ranking</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-9-218><a id=__codelineno-9-218 name=__codelineno-9-218 href=#__codelineno-9-218></a><span class=n>best_score</span> <span class=o>=</span> <span class=n>ranking</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-9-219><a id=__codelineno-9-219 name=__codelineno-9-219 href=#__codelineno-9-219></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"🥇 MELHOR ALGORITMO: </span><span class=si>{</span><span class=n>best_alg</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-9-220><a id=__codelineno-9-220 name=__codelineno-9-220 href=#__codelineno-9-220></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"📊 F1-Score: </span><span class=si>{</span><span class=n>best_score</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-9-221><a id=__codelineno-9-221 name=__codelineno-9-221 href=#__codelineno-9-221></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"⚡ Tempo: </span><span class=si>{</span><span class=n>results</span><span class=p>[</span><span class=n>best_alg</span><span class=p>][</span><span class=s1>'Tempo (s)'</span><span class=p>]</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>s"</span><span class=p>)</span>
</span><span id=__span-9-222><a id=__codelineno-9-222 name=__codelineno-9-222 href=#__codelineno-9-222></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"🎯 AUC-ROC: </span><span class=si>{</span><span class=n>results</span><span class=p>[</span><span class=n>best_alg</span><span class=p>][</span><span class=s1>'AUC-ROC'</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-9-223><a id=__codelineno-9-223 name=__codelineno-9-223 href=#__codelineno-9-223></a>
</span><span id=__span-9-224><a id=__codelineno-9-224 name=__codelineno-9-224 href=#__codelineno-9-224></a><span class=k>if</span> <span class=n>best_alg</span> <span class=o>==</span> <span class=s1>'KNN Otimizado'</span><span class=p>:</span>
</span><span id=__span-9-225><a id=__codelineno-9-225 name=__codelineno-9-225 href=#__codelineno-9-225></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>✅ O KNN otimizado se mantém como melhor escolha!"</span><span class=p>)</span>
</span><span id=__span-9-226><a id=__codelineno-9-226 name=__codelineno-9-226 href=#__codelineno-9-226></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>"   • Técnicas aplicadas resultaram em modelo superior"</span><span class=p>)</span>
</span><span id=__span-9-227><a id=__codelineno-9-227 name=__codelineno-9-227 href=#__codelineno-9-227></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>"   • Balance entre desempenho e interpretabilidade"</span><span class=p>)</span>
</span><span id=__span-9-228><a id=__codelineno-9-228 name=__codelineno-9-228 href=#__codelineno-9-228></a><span class=k>else</span><span class=p>:</span>
</span><span id=__span-9-229><a id=__codelineno-9-229 name=__codelineno-9-229 href=#__codelineno-9-229></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>⚠️  </span><span class=si>{</span><span class=n>best_alg</span><span class=si>}</span><span class=s2> superou o KNN otimizado"</span><span class=p>)</span>
</span><span id=__span-9-230><a id=__codelineno-9-230 name=__codelineno-9-230 href=#__codelineno-9-230></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>"   • Considere trocar de algoritmo para produção"</span><span class=p>)</span>
</span><span id=__span-9-231><a id=__codelineno-9-231 name=__codelineno-9-231 href=#__codelineno-9-231></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>"   • Analise complexidade vs ganho de performance"</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>=== BENCHMARK DE ALGORITMOS DE CLASSIFICAÇÃO ===
Treinando e avaliando algoritmos...

RESULTADOS DO BENCHMARK:
================================================================================
                     Acurácia  Precisão  Recall  F1-Score  Balanced Acc  \
KNN Otimizado          0.5267    0.6477  0.5876    0.6162        0.5014   
Random Forest          0.5600    0.6914  0.5773    0.6292        0.5528   
SVM                    0.5067    0.6264  0.5876    0.6064        0.4731   
Logistic Regression    0.5067    0.6575  0.4948    0.5647        0.5116   
Gradient Boosting      0.5533    0.6974  0.5464    0.6127        0.5562   
Naive Bayes            0.5067    0.6620  0.4845    0.5595        0.5159

                     AUC-ROC  Tempo (s)  
KNN Otimizado         0.5066     0.0021  
Random Forest         0.5568     0.1943  
SVM                   0.5046     0.0565  
Logistic Regression   0.4768     0.0033  
Gradient Boosting     0.6001     0.1496  
Naive Bayes           0.5153     0.0012

🏆 RANKING POR F1-SCORE:
1. Random Forest: 0.6292
2. KNN Otimizado: 0.6162
3. Gradient Boosting: 0.6127
4. SVM: 0.6064
5. Logistic Regression: 0.5647
6. Naive Bayes: 0.5595

=== BENCHMARK DE ALGORITMOS DE CLUSTERING ===
RESULTADOS DO CLUSTERING:
==================================================
         N° Clusters  Silhouette  Calinski-Harabasz  Davies-Bouldin
K-Means          2.0      0.4924          1108.2896          0.7799
DBSCAN           6.0     -0.0847            88.1870          1.8110
</code></pre></div> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../metrica_avaliacao_files/metrica_avaliacao_22_1.png data-desc-position=bottom><img alt=png src=../metrica_avaliacao_files/metrica_avaliacao_22_1.png></a></p> <div class="language-text highlight"><pre><span></span><code>=== RECOMENDAÇÃO FINAL ===
🥇 MELHOR ALGORITMO: Random Forest
📊 F1-Score: 0.6292
⚡ Tempo: 0.19s
🎯 AUC-ROC: 0.5568

⚠️  Random Forest superou o KNN otimizado
   • Considere trocar de algoritmo para produção
   • Analise complexidade vs ganho de performance
</code></pre></div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 6, 2025 02:07:30 UTC">October 6, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 6, 2025 02:07:30 UTC">October 6, 2025</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "content.tooltips", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.path", "navigation.tracking"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.92b07e13.min.js></script> <script src=../../assets/_markdown_exec_pyodide.js></script> <script src=https://unpkg.com/mathjax/es5/tex-mml-chtml.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://fastly.jsdelivr.net/npm/jquery/dist/jquery.min.js></script> <script src=https://fastly.jsdelivr.net/npm/echarts/dist/echarts.min.js></script> <script src=../../assets/javascripts/badge.js async></script> <script src=../../termynal.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>